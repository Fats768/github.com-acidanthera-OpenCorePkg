<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>OpenCore  Reference Manual</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">OpenCore Reference Manual</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#generic-terms" id="toc-generic-terms">Generic
Terms</a></li>
</ul></li>
<li><a href="#configuration-overview"
id="toc-configuration-overview">Configuration</a>
<ul>
<li><a href="#configuration-terms"
id="toc-configuration-terms">Configuration Terms</a></li>
<li><a href="#configuration-processing"
id="toc-configuration-processing">Configuration Processing</a></li>
<li><a href="#configuration-structure"
id="toc-configuration-structure">Configuration Structure</a></li>
</ul></li>
<li><a href="#setup-overview" id="toc-setup-overview">Setup</a>
<ul>
<li><a href="#directory-structure"
id="toc-directory-structure">Directory Structure</a></li>
<li><a href="#configuration-install"
id="toc-configuration-install">Installation and Upgrade</a></li>
<li><a href="#configuration-comp"
id="toc-configuration-comp">Contribution</a></li>
<li><a href="#configuration-conv" id="toc-configuration-conv">Coding
conventions</a></li>
<li><a href="#configuration-debug"
id="toc-configuration-debug">Debugging</a></li>
</ul></li>
<li><a href="#acpi" id="toc-acpi">ACPI</a>
<ul>
<li><a href="#acpiintro" id="toc-acpiintro">Introduction</a></li>
<li><a href="#acpiprops" id="toc-acpiprops">Properties</a></li>
<li><a href="#acpipropsadd" id="toc-acpipropsadd">Add
Properties</a></li>
<li><a href="#acpipropsdelete" id="toc-acpipropsdelete">Delete
Properties</a></li>
<li><a href="#acpipropspatch" id="toc-acpipropspatch">Patch
Properties</a></li>
<li><a href="#acpipropsquirks" id="toc-acpipropsquirks">Quirks
Properties</a></li>
</ul></li>
<li><a href="#booter" id="toc-booter">Booter</a>
<ul>
<li><a href="#booterintro" id="toc-booterintro">Introduction</a></li>
<li><a href="#booterprops" id="toc-booterprops">Properties</a></li>
<li><a href="#booterpropsmmio" id="toc-booterpropsmmio">MmioWhitelist
Properties</a></li>
<li><a href="#booterpropspatch" id="toc-booterpropspatch">Patch
Properties</a></li>
<li><a href="#booterpropsquirks" id="toc-booterpropsquirks">Quirks
Properties</a></li>
</ul></li>
<li><a href="#devprops" id="toc-devprops">DeviceProperties</a>
<ul>
<li><a href="#devpropsintro"
id="toc-devpropsintro">Introduction</a></li>
<li><a href="#devpropsprops" id="toc-devpropsprops">Properties</a></li>
<li><a href="#devpropscommon" id="toc-devpropscommon">Common
Properties</a></li>
</ul></li>
<li><a href="#kernel" id="toc-kernel">Kernel</a>
<ul>
<li><a href="#kernelintro" id="toc-kernelintro">Introduction</a></li>
<li><a href="#kernelprops" id="toc-kernelprops">Properties</a></li>
<li><a href="#kernelpropsadd" id="toc-kernelpropsadd">Add
Properties</a></li>
<li><a href="#kernelpropsblock" id="toc-kernelpropsblock">Block
Properties</a></li>
<li><a href="#kernelpropsemu" id="toc-kernelpropsemu">Emulate
Properties</a></li>
<li><a href="#kernelpropsforce" id="toc-kernelpropsforce">Force
Properties</a></li>
<li><a href="#kernelpropspatch" id="toc-kernelpropspatch">Patch
Properties</a></li>
<li><a href="#kernelpropsquirks" id="toc-kernelpropsquirks">Quirks
Properties</a></li>
<li><a href="#kernelpropsscheme" id="toc-kernelpropsscheme">Scheme
Properties</a></li>
</ul></li>
<li><a href="#misc" id="toc-misc">Misc</a>
<ul>
<li><a href="#miscintro" id="toc-miscintro">Introduction</a>
<ul>
<li><a href="#bootalgorithm" id="toc-bootalgorithm">Boot
Algorithm</a></li>
</ul></li>
<li><a href="#miscprops" id="toc-miscprops">Properties</a></li>
<li><a href="#miscbootprops" id="toc-miscbootprops">Boot
Properties</a></li>
<li><a href="#miscdebugprops" id="toc-miscdebugprops">Debug
Properties</a></li>
<li><a href="#miscentryprops" id="toc-miscentryprops">Entry
Properties</a></li>
<li><a href="#miscsecurityprops" id="toc-miscsecurityprops">Security
Properties</a></li>
<li><a href="#miscserialprops" id="toc-miscserialprops">Serial
Properties</a>
<ul>
<li><a href="#miscserialcustprops" id="toc-miscserialcustprops">Serial
Custom Properties</a></li>
</ul></li>
</ul></li>
<li><a href="#nvram" id="toc-nvram">NVRAM</a>
<ul>
<li><a href="#nvramintro" id="toc-nvramintro">Introduction</a></li>
<li><a href="#nvramprops" id="toc-nvramprops">Properties</a></li>
<li><a href="#nvramvars" id="toc-nvramvars">Mandatory Variables</a></li>
<li><a href="#nvramvarsrec" id="toc-nvramvarsrec">Recommended
Variables</a></li>
<li><a href="#nvramvarsother" id="toc-nvramvarsother">Other
Variables</a></li>
</ul></li>
<li><a href="#platforminfo" id="toc-platforminfo">PlatformInfo</a>
<ul>
<li><a href="#platforminfoprops"
id="toc-platforminfoprops">Properties</a></li>
<li><a href="#platforminfodatahub" id="toc-platforminfodatahub">DataHub
Properties</a></li>
<li><a href="#platforminfogeneric" id="toc-platforminfogeneric">Generic
Properties</a></li>
<li><a href="#platforminfomemory" id="toc-platforminfomemory">Memory
Properties</a>
<ul>
<li><a href="#platforminfomemorydevice"
id="toc-platforminfomemorydevice">Memory Device Properties</a></li>
</ul></li>
<li><a href="#platforminfonvram"
id="toc-platforminfonvram">PlatformNVRAM Properties</a></li>
<li><a href="#platforminfosmbios" id="toc-platforminfosmbios">SMBIOS
Properties</a></li>
</ul></li>
<li><a href="#uefi" id="toc-uefi">UEFI</a>
<ul>
<li><a href="#uefiintro" id="toc-uefiintro">Introduction</a></li>
<li><a href="#uefidrivers" id="toc-uefidrivers">Drivers</a></li>
<li><a href="#uefitools" id="toc-uefitools">Tools and
Applications</a></li>
<li><a href="#ueficanopy" id="toc-ueficanopy">OpenCanopy</a></li>
<li><a href="#uefiruntime" id="toc-uefiruntime">OpenRuntime</a></li>
<li><a href="#legacyboot" id="toc-legacyboot">OpenLegacyBoot</a>
<ul>
<li><a href="#configuration"
id="toc-configuration">Configuration</a></li>
</ul></li>
<li><a href="#uefilinux" id="toc-uefilinux">OpenLinuxBoot</a>
<ul>
<li><a href="#configuration-1"
id="toc-configuration-1">Configuration</a></li>
<li><a href="#additional-information"
id="toc-additional-information">Additional information</a></li>
</ul></li>
<li><a href="#other-boot-entry-protocol-drivers"
id="toc-other-boot-entry-protocol-drivers">Other Boot Entry Protocol
drivers</a>
<ul>
<li><a href="#uefiresetnvram"
id="toc-uefiresetnvram">ResetNvramEntry</a></li>
<li><a href="#uefitogglesip"
id="toc-uefitogglesip">ToggleSipEntry</a></li>
<li><a href="#firmwaresettings"
id="toc-firmwaresettings">FirmwareSettings</a></li>
</ul></li>
<li><a href="#uefiaudio" id="toc-uefiaudio">AudioDxe</a>
<ul>
<li><a href="#configuration-2"
id="toc-configuration-2">Configuration</a></li>
</ul></li>
<li><a href="#emunvram" id="toc-emunvram">OpenVariableRuntimeDxe</a>
<ul>
<li><a href="#managing-macos-updates-when-using-emulated-nvram"
id="toc-managing-macos-updates-when-using-emulated-nvram">Managing macOS
updates when using emulated NVRAM</a></li>
</ul></li>
<li><a href="#uefiprops" id="toc-uefiprops">Properties</a></li>
<li><a href="#uefiapfsprops" id="toc-uefiapfsprops">APFS
Properties</a></li>
<li><a href="#uefiappleinputprops"
id="toc-uefiappleinputprops">AppleInput Properties</a></li>
<li><a href="#uefiaudioprops" id="toc-uefiaudioprops">Audio
Properties</a></li>
<li><a href="#uefidriversprops" id="toc-uefidriversprops">Drivers
Properties</a></li>
<li><a href="#uefiinputprops" id="toc-uefiinputprops">Input
Properties</a></li>
<li><a href="#uefioutputprops" id="toc-uefioutputprops">Output
Properties</a></li>
<li><a href="#uefiprotoprops" id="toc-uefiprotoprops">ProtocolOverrides
Properties</a></li>
<li><a href="#uefiquirkprops" id="toc-uefiquirkprops">Quirks
Properties</a></li>
<li><a href="#uefirsvdprops" id="toc-uefirsvdprops">ReservedMemory
Properties</a></li>
</ul></li>
<li><a href="#troubleshooting"
id="toc-troubleshooting">Troubleshooting</a>
<ul>
<li><a href="#legacyapple" id="toc-legacyapple">Legacy Apple OS</a>
<ul>
<li><a href="#legacy108" id="toc-legacy108">OS X 10.8 and 10.9</a></li>
<li><a href="#legacy107" id="toc-legacy107">Mac OS X 10.7</a></li>
<li><a href="#legacy106" id="toc-legacy106">Mac OS X 10.6</a></li>
<li><a href="#legacy105" id="toc-legacy105">Mac OS X 10.5</a></li>
<li><a href="#legacy104" id="toc-legacy104">Mac OS X 10.4</a></li>
</ul></li>
<li><a href="#uefisecureboot" id="toc-uefisecureboot">UEFI Secure
Boot</a></li>
<li><a href="#troubleshootingwin" id="toc-troubleshootingwin">Windows
support</a></li>
<li><a href="#troubleshootingdebug"
id="toc-troubleshootingdebug">Debugging</a></li>
<li><a href="#troubleshootingtricks" id="toc-troubleshootingtricks">Tips
and Tricks</a></li>
</ul></li>
</ul>
</nav>
<div class="titlepage">
<div class="center">
<p><span><embed src="Logos/Logo.pdf"
style="width:2.22222in;height:2.22222in" /></span> <span><embed
src="../Logos/Logo.pdf"
style="width:2.22222in;height:2.22222in" /></span></p>
<p><strong>OpenCore</strong></p>
<p>Reference Manual (1.0.3)</p>
<p><span>[</span>2024-10-31<span>]</span></p>
<p>Copyright -2024 vit9696</p>
</div>
</div>
<h1 id="introduction">Introduction</h1>
<p>This document provides information on the format of the <a
href="https://github.com/acidanthera/OpenCorePkg">OpenCore</a> user
configuration file used to set up the correct functioning of the macOS
operating system. It is to be read as the official clarification of
expected OpenCore behaviour. All deviations, if found in published
OpenCore releases, shall be considered to be documentation or
implementation issues which should be reported via the <a
href="https://github.com/acidanthera/bugtracker">Acidanthera
Bugtracker</a>. An errata sheet is available in <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Errata/Errata.pdf">OpenCorePkg
repository</a>.</p>
<p>This document is structured as a specification and is not meant to
provide a step-by-step guide to configuring an end-user Board Support
Package (BSP). The intended audience of the document is anticipated to
be programmers and engineers with a basic understanding of macOS
internals and UEFI functionality. For these reasons, this document is
available exclusively in English, and all other sources or translations
of this document are unofficial and may contain errors.</p>
<p>Third-party articles, utilities, books, and similar, may be more
useful for a wider audience as they could provide guide-like material.
However, they are subject to their authors’ preferences,
misinterpretations of this document, and unavoidable obsolescence. In
cases of using such sources, such as <a
href="https://dortania.github.io">Dortania</a>’s <a
href="https://dortania.github.io/OpenCore-Install-Guide">OpenCore
Install Guide</a> and <a
href="https://dortania.github.io/getting-started">related material</a>,
please refer back to this document on every decision made and
re-evaluate potential implications.</p>
<p>Please note that regardless of the sources used, users are required
to fully understand every OpenCore configuration option, and the
principles behind them, before posting issues to the <a
href="https://github.com/acidanthera/bugtracker">Acidanthera
Bugtracker</a>.</p>
<p><em>Note</em>: Creating this document would not have been possible
without the invaluable contributions from other people: Andrey1970,
Goldfish64, dakanji, PMheart, and several others, with the full list
available in <a
href="https://github.com/acidanthera/OpenCorePkg/commits/master/Docs">OpenCorePkg
history</a>.</p>
<h2 id="generic-terms">Generic Terms</h2>
<ul>
<li><p><code>plist</code> — Subset of ASCII Property List format written
in XML, also know as XML plist format version 1. Uniform Type Identifier
(UTI): <code>com.apple.property-list</code>. Plists consist of
<code>plist objects</code>, which are combined to form a hierarchical
structure. Due to plist format not being well-defined, all the
definitions of this document may only be applied after plist is
considered valid by running <code>plutil -lint</code>. External
references: https://www.apple.com/DTDs/PropertyList-1.0.dtd,
<code>man plutil</code>.</p></li>
<li><p><code>plist type</code> — plist collections
(<code>plist array</code>, <code>plist dictionary</code>,
<code>plist key</code>) and primitives (<code>plist string</code>,
<code>plist data</code>, <code>plist date</code>,
<code>plist boolean</code>, <code>plist integer</code>,
<code>plist real</code>).</p></li>
<li><p><code>plist object</code> — definite realisation of
<code>plist type</code>, which may be interpreted as value.</p></li>
<li><p><code>plist array</code> — array-like collection, conforms to
<code>array</code>. Consists of zero or more
<code>plist objects</code>.</p></li>
<li><p><code>plist dictionary</code> — map-like (associative array)
collection, conforms to <code>dict</code>. Consists of zero or more
<code>plist keys</code>.</p></li>
<li><p><code>plist key</code> — contains one <code>plist object</code>
going by the name of <code>plist key</code>, conforms to
<code>key</code>. Consists of printable 7-bit ASCII characters.</p></li>
<li><p><code>plist string</code> — printable 7-bit ASCII string,
conforms to <code>string</code>.</p></li>
<li><p><code>plist data</code> — base64-encoded blob, conforms to
<code>data</code>.</p></li>
<li><p><code>plist date</code> — ISO-8601 date, conforms to
<code>date</code>, unsupported.</p></li>
<li><p><code>plist boolean</code> — logical state object, which is
either true (1) or false (0), conforms to <code>true</code> and
<code>false</code>.</p></li>
<li><p><code>plist integer</code> — possibly signed integer number in
base 10, conforms to <code>integer</code>. Fits in 64-bit unsigned
integer in two’s complement representation, unless a smaller signed or
unsigned integral type is explicitly mentioned in specific
<code>plist object</code> description.</p></li>
<li><p><code>plist real</code> — floating point number, conforms to
<code>real</code>, unsupported.</p></li>
<li><p><code>plist multidata</code> — value cast to data by the
implementation. Permits passing <code>plist string</code>, in which case
the result is represented by a null-terminated sequence of bytes (C
string), <code>plist integer</code>, in which case the result is
represented by <em>32-bit</em> little endian sequence of bytes in two’s
complement representation, <code>plist boolean</code>, in which case the
value is one byte: <code>01</code> for <code>true</code> and
<code>00</code> for <code>false</code>, and <code>plist data</code>
itself. All other types or larger integers invoke undefined
behaviour.</p></li>
</ul>
<h1 id="configuration-overview">Configuration</h1>
<h2 id="configuration-terms">Configuration Terms</h2>
<ul>
<li><p><code>OC config</code> — OpenCore Configuration file in
<code>plist</code> format named <code>config.plist</code>. It provides
an extensible way to configure OpenCore and is structured to be
separated into multiple named sections situated under the root
<code>plist dictionary</code>. These sections may have
<code>plist array</code> or <code>plist dictionary</code> types and are
described in corresponding sections of this document.</p></li>
<li><p><code>valid key</code> — <code>plist key</code> object of
<code>OC config</code> described in this document or its future
revisions. Besides explicitly described <code>valid keys</code>, keys
starting with the <code>#</code> symbol (e.g. <code>#Hello</code>) are
also considered <code>valid keys</code> and while they behave as
comments, effectively discarding their values, they are still required
to be valid <code>plist objects</code>. All other
<code>plist keys</code> are not valid, and their presence results in
<code>undefined behaviour</code>.</p></li>
<li><p><code>valid value</code> — valid <code>plist object</code> of
<code>OC config</code> described in this document that matches all the
additional requirements in specific <code>plist object</code>
descriptions if any.</p></li>
<li><p><code>invalid value</code> — valid <code>plist object</code> of
<code>OC config</code> described in this document that is of other
<code>plist type</code>, does not conform to additional requirements
found in specific <code>plist object</code> descriptions (e.g. value
range), or missing from the corresponding collection.
<code>Invalid values</code> are read with or without an error message as
any possible value of this <code>plist object</code> in an undetermined
manner (i.e. the values may not be same across the reboots). Whilst
reading an <code>invalid value</code> is equivalent to reading certain
defined <code>valid values</code>, applying incompatible values to the
host system may result in <code>undefined behaviour</code>.</p></li>
<li><p><code>optional value</code> — <code>valid value</code> of
<code>OC config</code> described in this document that reads in a
certain defined manner provided in specific <code>plist object</code>
description (instead of <code>invalid value</code>) when not present in
<code>OC config</code>. All other cases of <code>invalid value</code> do
still apply. Unless explicitly marked as <code>optional value</code>,
any other value is required to be present and reads to
<code>invalid value</code> if missing.</p></li>
<li><p><code>fatal behaviour</code> — behaviour leading to boot
termination. Implementations shall prevent the boot process from
continuing until the host system is restarted. It is permitted, but not
required, to execute cold reboots or to show warning messages in such
cases.</p></li>
<li><p><code>undefined behaviour</code> — behaviour not prescribed by
this document. Implementations may take any measures including, but not
limited to, measures associated with <code>fatal behaviour</code>,
assumptions of any state or value, or disregarding any associated states
or values. This is however subject to such measures not negatively
impacting upon system integrity.</p></li>
</ul>
<h2 id="configuration-processing">Configuration Processing</h2>
<p>The <code>OC config</code> file is guaranteed to be processed at
least once if found. Subject to the OpenCore bootstrapping mechanism,
the presence of multiple <code>OC config</code> files may lead to the
reading of any of them. It is permissible for no <code>OC Config</code>
file to be present on disk. In such cases, if the implementation does
not abort the boot process, all values shall follow the rules of
<code>invalid values</code> and <code>optional values</code>.</p>
<p>The <code>OC config</code> file has restrictions on size, nesting
levels, and number of keys:</p>
<ul>
<li><p>The <code>OC config</code> file size shall not exceed
<code>32 MBs</code>.</p></li>
<li><p>The <code>OC config</code> file shall not have more than
<code>32</code> nesting levels.</p></li>
<li><p>The <code>OC config</code> file may have up to
<code>32,768</code> XML nodes within each <code>plist object</code>.</p>
<ul>
<li><p>One <code>plist dictionary</code> item is counted as a pair of
nodes</p></li>
</ul></li>
</ul>
<p>Reading malformed <code>OC config</code> files results in
<code>undefined behaviour</code>. Examples of malformed
<code>OC config</code> files include the following:</p>
<ul>
<li><p><code>OC config</code> files that do not conform to
<code>DTD PLIST 1.0</code>.</p></li>
<li><p><code>OC config</code> files with unsupported or non-conformant
<code>plist objects</code> found in this document.</p></li>
<li><p><code>OC config</code> files violating restrictions on size,
nesting levels, and number of keys.</p></li>
</ul>
<p>It is recommended, but not required, to abort loading malformed
<code>OC config</code> files and to continue as if an
<code>OC config</code> file is not present. For forward compatibility,
it is recommended, but not required, for the implementation to warn
about the use of <code>invalid values</code>.</p>
<p>The recommended approach to interpreting <code>invalid values</code>
is to conform to the following convention where applicable:</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Type</strong></th>
<th style="text-align: left;"><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>plist string</code></td>
<td style="text-align: left;">Empty string
(<code>&lt;string&gt;&lt;/string&gt;</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><code>plist data</code></td>
<td style="text-align: left;">Empty data
(<code>&lt;data&gt;&lt;/data&gt;</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><code>plist integer</code></td>
<td style="text-align: left;">0
(<code>&lt;integer&gt;0&lt;/integer&gt;</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><code>plist boolean</code></td>
<td style="text-align: left;">False (<code>&lt;false/&gt;</code>)</td>
</tr>
<tr>
<td style="text-align: left;"><code>plist tristate</code></td>
<td style="text-align: left;">False (<code>&lt;false/&gt;</code>)</td>
</tr>
</tbody>
</table>
</div>
<h2 id="configuration-structure">Configuration Structure</h2>
<p>The <code>OC config</code> file is separated into subsections, as
described in separate sections of this document, and is designed so as
to attempt not to enable anything by default as well as to provide kill
switches via an <code>Enable</code> property for <code>plist dict</code>
entries that represent optional plugins and similar.</p>
<p>The file is structured to group related elements in subsections as
follows:</p>
<ul>
<li><p><code>Add</code> provides support for data addition. Existing
data will not be overridden, and needs to be handled separately with
<code>Delete</code> if necessary.</p></li>
<li><p><code>Delete</code> provides support for data removal.</p></li>
<li><p><code>Patch</code> provides support for data
modification.</p></li>
<li><p><code>Quirks</code> provides support for specific
workarounds.</p></li>
</ul>
<p>Root configuration entries consist of the following:</p>
<ul>
<li><p><a href="#acpi"><code>ACPI</code></a></p></li>
<li><p><a href="#booter"><code>Booter</code></a></p></li>
<li><p><a href="#devprops"><code>DeviceProperties</code></a></p></li>
<li><p><a href="#kernel"><code>Kernel</code></a></p></li>
<li><p><a href="#misc"><code>Misc</code></a></p></li>
<li><p><a href="#nvram"><code>NVRAM</code></a></p></li>
<li><p><a href="#platforminfo"><code>PlatformInfo</code></a></p></li>
<li><p><a href="#uefi"><code>UEFI</code></a></p></li>
</ul>
<p>Basic validation of an <code>OC config</code> file is possible using
the <code>ocvalidate</code> utility. Please note that the version of
<code>ocvalidate</code> used must match the OpenCore release and that
notwithstanding this, it may not detect all configuration issues present
in an <code>OC config</code> file.</p>
<p><em>Note</em>: To maintain system integrity, properties typically
have predefined values even when such predefined values are not
specified in the <code>OC config</code> file. However, all properties
must be explicitly specified in the <code>OC config</code> file and this
behaviour should not be relied on.</p>
<h1 id="setup-overview">Setup</h1>
<h2 id="directory-structure">Directory Structure</h2>
<div class="center">
<p><span id="fig:DS" data-label="fig:DS"></span> Figure 1. Directory
Structure</p>
</div>
<p>When directory boot is used, the directory structure used should
follow the descriptions in the <a href="#fig:DS">Directory Structure</a>
figure. Available entries include:</p>
<ul>
<li><p><code>BOOTx64.efi</code> or <code>BOOTIa32.efi</code><br />
Initial bootstrap loaders, which load <code>OpenCore.efi</code>.
<code>BOOTx64.efi</code> is loaded by the firmware by default consistent
with the UEFI specification. However, it may also be renamed and put in
a custom location to allow OpenCore coexist alongside operating systems,
such as Windows, that use <code>BOOTx64.efi</code> files as their
loaders. Refer to the <code>LauncherOption</code> property for
details.</p></li>
<li><p><code>boot</code><br />
Duet bootstrap loader, which initialises the UEFI environment on legacy
BIOS firmware and loads <code>OpenCore.efi</code> similarly to other
bootstrap loaders. A modern Duet bootstrap loader will default to
<code>OpenCore.efi</code> on the same partition when present.</p></li>
<li><p><code>ACPI</code><br />
Directory used for storing supplemental ACPI information for the <a
href="#acpi"><code>ACPI</code></a> section.</p></li>
<li><p><code>Drivers</code><br />
Directory used for storing supplemental <code>UEFI</code> drivers for <a
href="#uefi"><code>UEFI</code></a> section.</p></li>
<li><p><code>Kexts</code><br />
Directory used for storing supplemental kernel information for the <a
href="#kernel"><code>Kernel</code></a> section.</p></li>
<li><p><code>Resources</code><br />
Directory used for storing media resources such as audio files for
screen reader support. Refer to the <a
href="#uefiaudioprops"><code>UEFI Audio Properties</code></a> section
for details. This directory also contains image files for graphical user
interface. Refer to the <a href="#ueficanopy">OpenCanopy</a> section for
details.</p></li>
<li><p><code>Tools</code><br />
Directory used for storing supplemental tools.</p></li>
<li><p><code>OpenCore.efi</code><br />
Main booter application responsible for operating system loading. The
directory <code>OpenCore.efi</code> resides in is called the
<code>root directory</code>, which is set to <code>EFI\OC</code> by
default. When launching <code>OpenCore.efi</code> directly or through a
custom launcher however, other directories containing
<code>OpenCore.efi</code> files are also supported.</p></li>
<li><p><code>config.plist</code><br />
<code>OC Config</code>.</p></li>
<li><p><code>vault.plist</code><br />
Hashes for all files potentially loadable by
<code>OC Config</code>.</p></li>
<li><p><code>vault.sig</code><br />
Signature for <code>vault.plist</code>.</p></li>
<li><p><code>SysReport</code><br />
Directory containing system reports generated by <code>SysReport</code>
option.</p></li>
<li><p><code>nvram.plist</code><br />
OpenCore variable import file.</p></li>
<li><p><code>nvram.fallback</code><br />
OpenCore variable import fallback file.</p></li>
<li><p><code>nvram.used</code><br />
Renamed previous OpenCore variable import file after switch to fallback
file.</p></li>
<li><p><code>opencore-YYYY-MM-DD-HHMMSS.txt</code><br />
OpenCore log file.</p></li>
<li><p><code>panic-YYYY-MM-DD-HHMMSS.txt</code><br />
Kernel panic log file.</p></li>
</ul>
<p><em>Note</em>: It is not guaranteed that paths longer than
<code>OC_STORAGE_SAFE_PATH_MAX</code> (128 characters including
the<br />
<code>0</code>-terminator) will be accessible within OpenCore.</p>
<h2 id="configuration-install">Installation and Upgrade</h2>
<p>To install OpenCore, replicate the <a
href="#configuration-structure">Configuration Structure</a> described in
the previous section in the EFI volume of a GPT partition. While
corresponding sections of this document provide some information
regarding external resources such as ACPI tables, UEFI drivers, or
kernel extensions (kexts), completeness of the matter is out of the
scope of this document. Information about kernel extensions may be found
in a separate <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Kexts.md">Kext
List</a> document available in the OpenCore repository. Vaulting
information is provided in the <a href="#miscsecurityprops">Security
Properties</a> section of this document.</p>
<p>The <code>OC config</code> file, as with any property list file, can
be edited with any text editor, such as nano or vim. However,
specialised software may provide a better experience. On macOS, the
preferred GUI application is <a
href="https://developer.apple.com/xcode">Xcode</a>. The <a
href="https://github.com/corpnewt/ProperTree">ProperTree</a> editor is a
lightweight, cross-platform and open-source alternative.</p>
<p>It is strongly recommended to avoid configuration creation tools that
are aware of the internal configuration structure as this may result in
invalid configurations (since the structure gets constantly updated). If
such tools are to be used despite this warning, ensure that only stable
versions of OpenCore explicitly supported by such tools are used. In
such cases, the use of open-source implementations with transparent
binary generation (such as <a
href="https://github.com/ic005k/QtOpenCoreConfig">OCAT</a>) is
encouraged, given that other tools may contain malware. In addition,
configurations created for a specific hardware setup should never be
used on different hardware setups.</p>
<p>For BIOS booting, a third-party UEFI environment provider is required
and <code>OpenDuetPkg</code> is one such UEFI environment provider for
legacy systems. To run OpenCore on such a legacy system,
<code>OpenDuetPkg</code> can be installed with a dedicated tool —
BootInstall (bundled with OpenCore). <a
href="https://github.com/corpnewt/gibMacOS">Third-party utilities</a>
can be used to perform this on systems other than macOS.</p>
<p>For upgrade purposes, refer to the <code>Differences.pdf</code>
document which provides information about changes to the configuration
(as compared to the previous release) as well as to the
<code>Changelog.md</code> document (which contains a list of
modifications across all published updates).</p>
<h2 id="configuration-comp">Contribution</h2>
<p>OpenCore can be compiled as a standard <a
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II">EDK
II</a> package and requires the <a
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II#stable-tags">EDK
II Stable</a> package. The currently supported EDK II release is hosted
in <a href="https://github.com/acidanthera/audk">acidanthera/audk</a>.
Required patches for this package can be found in the
<code>Patches</code> directory.</p>
<p>When updating the LaTeX documentation (e.g.
<code>Configuration.tex</code>) please do <em>not</em> rebuild the PDF
files till merging to master happens. This avoids unnecessary merge
conflicts:</p>
<ul>
<li><p>External contributors using the pull-request approach should
request the maintainers to handle the PDF rebuild in the pull-request
message.</p></li>
<li><p>Internal contributors should rebuild the documentation at merge
time in the same or in a separate commit. One can ask another maintainer
to rebuild the documentation when lacking the necessary tools in the
pull-request message.</p></li>
</ul>
<p>The only officially supported toolchain is <code>XCODE5</code>. Other
toolchains might work but are neither supported nor recommended.
Contributions of clean patches are welcome. Please do follow <a
href="https://github.com/tianocore/tianocore.github.io/wiki/Code-Style-C">EDK
II C Codestyle</a>.</p>
<p>To compile with <code>XCODE5</code>, besides <a
href="https://developer.apple.com/xcode">Xcode</a>, users should also
install <a href="https://www.nasm.us">NASM</a> and <a
href="https://github.com/acidanthera/ocbuild/tree/master/external">MTOC</a>.
The latest Xcode version is recommended for use despite the toolchain
name. An example command sequence is as follows:</p>
<pre id="compile" data-caption="Compilation Commands"
data-label="compile" style="ocbash"><code>git clone --depth=1 https://github.com/acidanthera/audk UDK
cd UDK
git submodule update --init --recommend-shallow
rm -rf OpenCorePkg
git clone --depth=1 https://github.com/acidanthera/OpenCorePkg
. ./edksetup.sh
make -C BaseTools
build -a X64 -b RELEASE -t XCODE5 -p OpenCorePkg/OpenCorePkg.dsc</code></pre>
<p>For IDE usage Xcode projects are available in the root of the
repositories. Another approach could be using <a
href="https://microsoft.github.io/language-server-protocol">Language
Server Protocols</a>. For example, <a
href="https://www.sublimetext.com">Sublime Text</a> with <a
href="https://lsp.sublimetext.io">LSP for Sublime Text</a> plugin. Add
<code>compile_flags.txt</code> file with similar content to the UDK
root:</p>
<pre id="eccfile" data-caption="ECC Configuration" data-label="eccfile"
style="ocbash"><code>-I/UefiPackages/MdePkg
-I/UefiPackages/MdePkg/Include
-I/UefiPackages/MdePkg/Include/X64
-I/UefiPackages/MdeModulePkg
-I/UefiPackages/MdeModulePkg/Include
-I/UefiPackages/MdeModulePkg/Include/X64
-I/UefiPackages/OpenCorePkg/Include/AMI
-I/UefiPackages/OpenCorePkg/Include/Acidanthera
-I/UefiPackages/OpenCorePkg/Include/Apple
-I/UefiPackages/OpenCorePkg/Include/Apple/X64
-I/UefiPackages/OpenCorePkg/Include/Duet
-I/UefiPackages/OpenCorePkg/Include/Generic
-I/UefiPackages/OpenCorePkg/Include/Intel
-I/UefiPackages/OpenCorePkg/Include/Microsoft
-I/UefiPackages/OpenCorePkg/Include/Nvidia
-I/UefiPackages/OpenCorePkg/Include/VMware
-I/UefiPackages/OvmfPkg/Include
-I/UefiPackages/ShellPkg/Include
-I/UefiPackages/UefiCpuPkg/Include
-IInclude
-include
/UefiPackages/MdePkg/Include/Uefi.h
-fshort-wchar
-Wall
-Wextra
-Wno-unused-parameter
-Wno-missing-braces
-Wno-missing-field-initializers
-Wno-tautological-compare
-Wno-sign-compare
-Wno-varargs
-Wno-unused-const-variable
-DOC_TARGET_NOOPT=1
-DNO_MSABI_VA_FUNCS=1</code></pre>
<p><em>Note</em>: <code>/UefiPackages</code> in the sample file denotes
an absolute path.</p>
<p><strong>Warning</strong>: Tool developers modifying
<code>config.plist</code> or any other OpenCore files must ensure that
their tools check the <code>opencore-version</code> NVRAM variable (see
the <a href="#miscdebugprops">Debug Properties</a> section below) and
warn users if the version listed is unsupported or prerelease. The
OpenCore configuration may change across releases and such tools shall
ensure that they carefully follow this document. Failure to do so may
result in such tools being considered to be malware and blocked by any
means.</p>
<h2 id="configuration-conv">Coding conventions</h2>
<p>As with any other project, we have conventions that we follow during
development. All third-party contributors are advised to adhere to the
conventions listed below before submitting patches. To minimise abortive
work and the potential rejection of submissions, third-party
contributors should initially raise issues to the <a
href="https://github.com/acidanthera/bugtracker">Acidanthera
Bugtracker</a> for feedback before submitting patches.</p>
<p><strong>Organisation</strong>. The codebase is contained in the
<code>OpenCorePkg</code> repository, which is the primary EDK II
package.</p>
<ul>
<li><p>Whenever changes are required in multiple repositories, separate
pull requests should be sent to each.</p></li>
<li><p>Committing the changes should happen firstly to dependent
repositories, secondly to primary repositories to avoid automatic build
errors.</p></li>
<li><p>Each unique commit should compile with <code>XCODE5</code> and
preferably with other toolchains. In the majority of the cases it can be
checked by accessing the <a href="https://travis-ci.com/acidanthera">CI
interface</a>. Ensuring that static analysis finds no warnings is
preferred.</p></li>
<li><p>External pull requests and tagged commits must be validated. That
said, commits in master may build but may not necessarily work.</p></li>
<li><p>Internal branches should be named as follows:
<code>author-name-date</code>, e.g.
<code>vit9696-ballooning-20191026</code>.</p></li>
<li><p>Commit messages should be prefixed with the primary module (e.g.
library or code module) the changes were made in. For example,
<code>OcGuardLib: Add OC_ALIGNED macro</code>. For non-library changes
<code>Docs</code> or <code>Build</code> prefixes are used.</p></li>
</ul>
<p><strong>Design</strong>. The codebase is written in a subset of
freestanding C11 (C17) supported by most modern toolchains used by EDK
II. Applying common software development practices or requesting
clarification is recommended if any particular case is not discussed
below.</p>
<ul>
<li><p>Never rely on undefined behaviour and try to avoid implementation
defined behaviour unless explicitly covered below (feel free to create
an issue when a relevant case is not present).</p></li>
<li><p>Use <code>OcGuardLib</code> to ensure safe integral arithmetics
avoiding overflows. Unsigned wraparound should be relied on with care
and reduced to the necessary amount.</p></li>
<li><p>Check pointers for correct alignment with <code>OcGuardLib</code>
and do not rely on the architecture being able to dereference unaligned
pointers.</p></li>
<li><p>Use flexible array members instead of zero-length or one-length
arrays where necessary.</p></li>
<li><p>Use static assertions (<code>STATIC_ASSERT</code>) for type and
value assumptions, and runtime assertions (<code>ASSERT</code>) for
precondition and invariant sanity checking. Do not use runtime
assertions to check for errors as they should never alter control flow
and potentially be excluded.</p></li>
<li><p>Assume <code>UINT32</code>/<code>INT32</code> to be
<code>int</code>-sized and use <code>%u</code>, <code>%d</code>, and
<code>%x</code> to print them.</p></li>
<li><p>Assume <code>UINTN</code>/<code>INTN</code> to be of unspecified
size, and cast them to <code>UINT64</code>/<code>INT64</code> for
printing with <code>%Lu</code>, <code>%Ld</code> and so on as
normal.</p></li>
<li><p>Do not rely on integer promotions for numeric literals. Use
explicit casts when the type is implementation-dependent or suffixes
when type size is known. Assume <code>U</code> for <code>UINT32</code>
and <code>ULL</code> for <code>UINT64</code>.</p></li>
<li><p>Do ensure unsigned arithmetics especially in bitwise maths,
shifts in particular.</p></li>
<li><p><code>sizeof</code> operator should take variables instead of
types where possible to be error prone. Use <code>ARRAY_SIZE</code> to
obtain array size in elements. Use <code>L_STR_LEN</code> and
<code>L_STR_SIZE</code> macros from <code>OcStringLib</code> to obtain
string literal sizes to ensure compiler optimisation.</p></li>
<li><p>Do not use <code>goto</code> keyword. Prefer early
<code>return</code>, <code>break</code>, or <code>continue</code> after
failing to pass error checking instead of nesting conditionals.</p></li>
<li><p>Use <code>EFIAPI</code>, force UEFI calling convention, only in
protocols, external callbacks between modules, and functions with
variadic arguments.</p></li>
<li><p>Provide inline documentation to every added function, at least
describing its inputs, outputs, precondition, postcondition, and giving
a brief description.</p></li>
<li><p>Do not use <code>RETURN_STATUS</code>. Assume
<code>EFI_STATUS</code> to be a matching superset that is to be always
used when <code>BOOLEAN</code> is not enough.</p></li>
<li><p>Security violations should halt the system or cause a forced
reboot.</p></li>
</ul>
<p><strong>Codestyle</strong>. The codebase follows the <a
href="https://github.com/tianocore/tianocore.github.io/wiki/Code-Style-C">EDK
II codestyle</a> with a few changes and clarifications.</p>
<ul>
<li><p>Write inline documentation for the functions and variables only
once: in headers, where a header prototype is available, and inline for
<code>static</code> variables and functions.</p></li>
<li><p>Use line length of 120 characters or less, preferably 100
characters.</p></li>
<li><p>Use spaces after casts, e.g.
<code>(VOID *)(UINTN) Variable</code>.</p></li>
<li><p>Use two spaces to indent function arguments when splitting
lines.</p></li>
<li><p>Prefix public functions with either <code>Oc</code> or another
distinct name.</p></li>
<li><p>Do not prefix private <code>static</code> functions, but prefix
private <code>non-static</code> functions with
<code>Internal</code>.</p></li>
<li><p>Use SPDX license headers as shown in <a
href="https://github.com/acidanthera/bugtracker/issues/483">acidanthera/bugtracker#483</a>.</p></li>
</ul>
<h2 id="configuration-debug">Debugging</h2>
<p>The codebase incorporates EDK II debugging and few custom features to
improve the experience.</p>
<ul>
<li><p>Use module prefixes, 2-5 letters followed by a colon
(<code>:</code>), for debug messages. For <code>OpenCorePkg</code> use
<code>OC:</code>, for libraries and drivers use their own unique
prefixes.</p></li>
<li><p>Do not use dots (<code>.</code>) in the end of debug messages and
separate <code>EFI_STATUS</code>, printed by <code>%r</code>, with a
hyphen (e.g.
<code>OCRAM: Allocation of %u bytes failed - %r\n</code>).</p></li>
<li><p>Use <code>DEBUG_CODE_BEGIN ()</code> and
<code>DEBUG_CODE_END ()</code> constructions to guard debug checks that
may potentially reduce the performance of release builds and are
otherwise unnecessary.</p></li>
<li><p>Use <code>DEBUG</code> macro to print debug messages during
normal functioning, and <code>RUNTIME_DEBUG</code> for debugging after
<code>EXIT_BOOT_SERVICES</code>.</p></li>
<li><p>Use <code>DEBUG_VERBOSE</code> debug level to leave debug
messages for future debugging of the code, which are currently not
necessary. By default <code>DEBUG_VERBOSE</code> messages are ignored
even in <code>DEBUG</code> builds.</p></li>
<li><p>Use <code>DEBUG_INFO</code> debug level for all non critical
messages (including errors) and <code>DEBUG_BULK_INFO</code> for
extensive messages that should not appear in NVRAM log that is heavily
limited in size. These messages are ignored in <code>RELEASE</code>
builds.</p></li>
<li><p>Use <code>DEBUG_ERROR</code> to print critical human visible
messages that may potentially halt the boot process, and
<code>DEBUG_WARN</code> for all other human visible errors,
<code>RELEASE</code> builds included.</p></li>
</ul>
<p>The <a
href="https://git-scm.com/docs/git-bisect"><code>git-bisect</code></a>
functionality may be useful when trying to find problematic changes.
Unofficial sources of <code>per-commit</code> OpenCore binary builds,
such as <a href="https://dortania.github.io/builds">Dortania</a>, may
also be useful.</p>
<h1 id="acpi">ACPI</h1>
<h2 id="acpiintro">Introduction</h2>
<p>ACPI (Advanced Configuration and Power Interface) is an open standard
to discover and configure computer hardware. The <a
href="https://uefi.org/specifications">ACPI specification</a> defines
standard tables (e.g. <code>DSDT</code>, <code>SSDT</code>,
<code>FACS</code>, <code>DMAR</code>) and various methods (e.g.
<code>_DSM</code>, <code>_PRW</code>) for implementation. Modern
hardware needs few changes to maintain ACPI compatibility and some
options for such changes are provided as part of OpenCore.</p>
<p>To compile and disassemble ACPI tables, the <a
href="https://github.com/acpica/acpica">iASL compiler</a> developed by
<a href="https://www.acpica.org">ACPICA</a> can be used. A GUI front-end
to iASL compiler can be downloaded from <a
href="https://github.com/acidanthera/MaciASL/releases">Acidanthera/MaciASL</a>.</p>
<p>ACPI changes apply globally (to every operating system) with the
following effective order:</p>
<ul>
<li><p><code>Delete</code> is processed.</p></li>
<li><p><code>Quirks</code> are processed.</p></li>
<li><p><code>Patch</code> is processed.</p></li>
<li><p><code>Add</code> is processed.</p></li>
</ul>
<p><em>Note</em>: <code>RebaseRegions</code> and
<code>SyncTableIds</code> quirks are special and are processed after all
other ACPI changes since they can only be applied on the final ACPI
configuration including all the patches and added tables.</p>
<p>Applying the changes globally resolves the problems of incorrect
operating system detection (consistent with the ACPI specification, not
possible before the operating system boots), operating system
chainloading, and difficult ACPI debugging. Hence, more attention may be
required when writing changes to <code>_OSI</code>.</p>
<p>Applying the patches early makes it possible to write so called
“proxy” patches, where the original method is patched in the original
table and is implemented in the patched table.</p>
<p>There are several sources of ACPI tables and workarounds. Commonly
used ACPI tables are provided with OpenCore, VirtualSMC, VoodooPS2, and
WhateverGreen releases. Besides those, several third-party instructions
may be found on the AppleLife <a
href="https://applelife.ru/forums/xakintosh.67">Laboratory</a> and <a
href="https://applelife.ru/forums/dsdt.129">DSDT</a> subforums (e.g. <a
href="https://applelife.ru/posts/498967">Battery register splitting</a>
guide). A slightly more user-friendly explanation of some tables
included with OpenCore can also be found in <a
href="https://dortania.github.io">Dortania</a>’s <a
href="https://dortania.github.io/Getting-Started-With-ACPI">Getting
started with ACPI</a> guide. For more exotic cases, there are several
alternatives such as <a
href="https://github.com/daliansky">daliansky</a>’s <a
href="https://github.com/daliansky/OC-little">ACPI sample collection</a>
(<a href="https://github.com/5T33Z0/OC-Little-Translated">English
Translation by 5T33Z0 et al</a>). Please note however, that suggested
solutions from third parties may be outdated or may contain errors.</p>
<h2 id="acpiprops">Properties</h2>
<ol>
<li><p><code>Add</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Load selected tables from the
<code>OC/ACPI</code> directory.</p>
<p>To be filled with <code>plist dict</code> values, describing each add
entry. Refer to the <a href="#acpipropsadd">Add Properties</a> section
below for details.</p></li>
<li><p><code>Delete</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Remove selected tables from the ACPI
stack.</p>
<p>To be filled with <code>plist dict</code> values, describing each
delete entry. Refer to the <a href="#acpipropsdelete">Delete
Properties</a> section below for details.</p></li>
<li><p><code>Patch</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Perform binary patches in ACPI tables
before table addition or removal.</p>
<p>To be filled with <code>plist dictionary</code> values describing
each patch entry. Refer to the <a href="#acpipropspatch">Patch
Properties</a> section below for details.</p></li>
<li><p><code>Quirks</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual ACPI quirks described in
the <a href="#acpipropsquirks">Quirks Properties</a> section
below.</p></li>
</ol>
<h2 id="acpipropsadd">Add Properties</h2>
<ol>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to add this ACPI
table.</p></li>
<li><p><code>Path</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: File paths meant to be loaded as ACPI
tables. Example values include <code>DSDT.aml</code>,
<code>SubDir/SSDT-8.aml</code>, <code>SSDT-USBX.aml</code>, etc.</p>
<p>The ACPI table load order follows the item order in the array. ACPI
tables are loaded from the <code>OC/ACPI</code> directory.</p>
<p><strong>Note</strong>: All tables apart from tables with a
<code>DSDT</code> table identifier (determined by parsing data, not by
filename) insert new tables into the ACPI stack. <code>DSDT</code>
tables perform a replacement of DSDT tables instead.</p></li>
</ol>
<h2 id="acpipropsdelete">Delete Properties</h2>
<ol>
<li><p><code>All</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code> (Only delete the first
matched table)<br />
<strong>Description</strong>: Set to <code>true</code> to delete all
ACPI tables matching the condition.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to remove this
ACPI table.</p></li>
<li><p><code>OemTableId</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: All zero (Match any table OEM ID)<br />
<strong>Description</strong>: Match table OEM ID equal to this
value.</p></li>
<li><p><code>TableLength</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Match any table size)<br />
<strong>Description</strong>: Match table size equal to this
value.</p></li>
<li><p><code>TableSignature</code><br />
<strong>Type</strong>: <code>plist data</code>, 4 bytes<br />
<strong>Failsafe</strong>: All zero (Match any table signature)<br />
<strong>Description</strong>: Match table signature equal to this
value.</p>
<p><em>Note</em>: Do not use table signatures when the sequence must be
replaced in multiple places. This is particularly relevant when
performing different types of renames.</p></li>
</ol>
<h2 id="acpipropspatch">Patch Properties</h2>
<ol>
<li><p><code>Base</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Selects ACPI path base for patch lookup
(or immediate replacement) by obtaining the offset to the provided
path.</p>
<p>Only fully-qualified absolute paths are supported (e.g.
<code>\_SB.PCI0.LPCB.HPET</code>). Currently supported object types are:
<code>Device</code>, <code>Field</code>, <code>Method</code>.</p>
<p><em>Note</em>: Use with care, not all OEM tables can be parsed. Use
<code>ACPIe</code> utility to debug. <code>ACPIe</code> compiled with
<code>DEBUG=1 make</code> command produces helpful ACPI lookup
tracing.</p></li>
<li><p><code>BaseSkip</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Do not skip any
occurrences)<br />
<strong>Description</strong>: Number of found <code>Base</code>
occurrences to skip before finds and replacements are applied.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Count</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Apply patch to all
occurrences found)<br />
<strong>Description</strong>: Number of occurrences to patch.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to apply this
ACPI patch.</p></li>
<li><p><code>Find</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Data to find. Must be equal to
<code>Replace</code> in size if set.</p>
<p><em>Note</em>: Can be empty, when <code>Base</code> is specified,
immediate replacement after <code>Base</code> lookup happens in this
case.</p></li>
<li><p><code>Limit</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Search entire ACPI
table)<br />
<strong>Description</strong>: Maximum number of bytes to search
for.</p></li>
<li><p><code>Mask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during find
comparison. Allows fuzzy search by ignoring not masked (set to zero)
bits. Must be equal to <code>Replace</code> in size if set.</p></li>
<li><p><code>OemTableId</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: All zero (Match any table OEM ID)<br />
<strong>Description</strong>: Match table OEM ID equal to this
value.</p></li>
<li><p><code>Replace</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Replacement data of one or more
bytes.</p></li>
<li><p><code>ReplaceMask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during replacement.
Allows fuzzy replacement by updating masked (set to non-zero) bits. Must
be equal to <code>Replace</code> in size if set.</p></li>
<li><p><code>Skip</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Do not skip any
occurrences)<br />
<strong>Description</strong>: Number of found occurrences to skip before
replacements are applied.</p></li>
<li><p><code>TableLength</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Match any table size)<br />
<strong>Description</strong>: Match table size equal to this
value.</p></li>
<li><p><code>TableSignature</code><br />
<strong>Type</strong>: <code>plist data</code>, 4 bytes<br />
<strong>Failsafe</strong>: All zero (Match any table signature)<br />
<strong>Description</strong>: Match table signature equal to this
value.</p></li>
</ol>
<p>In most cases, ACPI patches are not useful and are harmful:</p>
<ul>
<li><p>Avoid renaming devices with ACPI patches. This may fail or
perform improper renaming of unrelated devices (e.g. <code>EC</code> and
<code>EC0</code>), be unnecessary, or even fail to rename devices in
certain tables. For ACPI consistency it is much safer to rename devices
at the I/O Registry level, as done by <a
href="https://github.com/acidanthera/WhateverGreen">WhateverGreen</a>.</p></li>
<li><p>Avoid patching <code>_OSI</code> to support a higher feature set
level whenever possible. While this enables a number of workarounds on
APTIO firmware, it typically results in a need for additional patches.
These are not usually needed on modern firmware and smaller patches work
well on firmware that does. However, laptop vendors often rely on this
method to determine the availability of functions such as modern I2C
input support, thermal adjustment and custom feature additions.</p></li>
<li><p>Avoid patching embedded controller event <code>_Qxx</code> just
to enable brightness keys. The conventional process to find these keys
typically involves significant modifications to DSDT and SSDT files and
in addition, the debug kext is not stable on newer systems. Please use
the built-in brightness key discovery in <a
href="https://github.com/acidanthera/BrightnessKeys">BrightnessKeys</a>
instead.</p></li>
<li><p>Avoid making ad hoc changes such as renaming <code>_PRW</code> or
<code>_DSM</code> whenever possible.</p></li>
</ul>
<p>Some cases where patching is actually useful include:</p>
<ul>
<li><p>Refreshing <code>HPET</code> (or another device) method header to
avoid compatibility checks by <code>_OSI</code> on legacy hardware.
<code>_STA</code> method with
<code>if ((OSFL () == Zero)) { If (HPTE) ... Return (Zero)</code>
content may be forced to always return 0xF by replacing
<code>A0 10 93 4F 53 46 4C 00</code> with
<code>A4 0A 0F A3 A3 A3 A3 A3</code>.</p></li>
<li><p>To provide a custom method implementation within an SSDT, to
inject shutdown fixes on certain computers for instance, the original
method can be replaced with a dummy name by patching <code>_PTS</code>
with <code>ZPTS</code> and adding a callback to the original
method.</p></li>
</ul>
<p>The Tianocore <a
href="https://github.com/acidanthera/audk/blob/master/MdePkg/Include/IndustryStandard/AcpiAml.h">AcpiAml.h</a>
source file may help with better understanding ACPI opcodes.</p>
<p><em>Note</em>: Patches of different <code>Find</code> and
<code>Replace</code> lengths are unsupported as they may corrupt ACPI
tables and make the system unstable due to area relocation. If such
changes are needed, the utilisation of “proxy” patching or the padding
of <code>NOP</code> to the remaining area could be considered.</p>
<h2 id="acpipropsquirks">Quirks Properties</h2>
<ol>
<li><p><code>FadtEnableReset</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Provide reset register and flag in FADT
table to enable reboot and shutdown.</p>
<p>Mainly required on legacy hardware and a few newer laptops. Can also
fix power-button shortcuts. Not recommended unless required.</p></li>
<li><p><code>NormalizeHeaders</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Cleanup ACPI header fields to workaround
macOS ACPI implementation flaws that result in boot crashes. Reference:
<a href="https://alextjam.es/debugging-appleacpiplatform/">Debugging
AppleACPIPlatform on 10.13</a> by Alex James (also known as
theracermaster). The issue was fixed in macOS Mojave (10.14).</p></li>
<li><p><code>RebaseRegions</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Attempt to heuristically relocate ACPI
memory regions. Not recommended.</p>
<p>ACPI tables are often generated dynamically by the underlying
firmware implementation. Among the position-independent code, ACPI
tables may contain the physical addresses of MMIO areas used for device
configuration, typically grouped by region (e.g.
<code>OperationRegion</code>). Changing firmware settings or hardware
configuration, upgrading or patching the firmware inevitably leads to
changes in dynamically generated ACPI code, which sometimes results in
the shift of the addresses in the aforementioned
<code>OperationRegion</code> constructions.</p>
<p>For this reason, the application of modifications to ACPI tables is
extremely risky. The best approach is to make as few changes as possible
to ACPI tables and to avoid replacing any tables, particularly DSDT
tables. When this cannot be avoided, ensure that any custom DSDT tables
are based on the most recent DSDT tables or attempt to remove reads and
writes for the affected areas.</p>
<p>When nothing else helps, this option could be tried to avoid stalls
at <code>PCI Configuration Begin</code> phase of macOS booting by
attempting to fix the ACPI addresses. It is not a magic bullet however,
and only works with the most typical cases. Do not use unless absolutely
required as it can have the opposite effect on certain platforms and
result in boot failures.</p></li>
<li><p><code>ResetHwSig</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Reset <code>FACS</code> table
<code>HardwareSignature</code> value to <code>0</code>.</p>
<p>This works around firmware that fail to maintain hardware signature
across the reboots and cause issues with waking from
hibernation.</p></li>
<li><p><code>ResetLogoStatus</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Reset <code>BGRT</code> table
<code>Displayed</code> status field to <code>false</code>.</p>
<p>This works around firmware that provide a <code>BGRT</code> table but
fail to handle screen updates afterwards.</p></li>
<li><p><code>SyncTableIds</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Sync table identifiers with the
<code>SLIC</code> table.</p>
<p>This works around patched tables becoming incompatible with the
<code>SLIC</code> table causing licensing issues in older Windows
operating systems.</p></li>
</ol>
<h1 id="booter">Booter</h1>
<h2 id="booterintro">Introduction</h2>
<p>This section allows the application of different types of UEFI
modifications to operating system bootloaders, primarily the Apple
bootloader (<code>boot.efi</code>). The modifications currently provide
various patches and environment alterations for different firmware
types. Some of these features were originally implemented as part of <a
href="https://github.com/acidanthera/AptioFixPkg"></a>, which is no
longer maintained. Refer to the <a href="#troubleshootingtricks">Tips
and Tricks</a> section for instructions on migration.</p>
<p>Booter changes apply with the following effective order:</p>
<ul>
<li><p><code>Quirks</code> are processed.</p></li>
<li><p><code>Patch</code> is processed.</p></li>
</ul>
<p>If this is used for the first time on customised firmware, the
following requirements should be met before starting:</p>
<ul>
<li><p>Most up-to-date UEFI firmware (check the motherboard vendor
website).</p></li>
<li><p><code>Fast Boot</code> and <code>Hardware Fast Boot</code>
disabled in firmware settings if present.</p></li>
<li><p><code>Above 4G Decoding</code> or similar enabled in firmware
settings if present. Note that on some motherboards, notably the ASUS
WS-X299-PRO, this option results in adverse effects and must be
disabled. While no other motherboards with the same issue are known,
this option should be checked first whenever erratic boot failures are
encountered.</p></li>
<li><p><code>DisableIoMapper</code> quirk enabled, or <code>VT-d</code>
disabled in firmware settings if present, or ACPI DMAR table
deleted.</p></li>
<li><p><strong>No</strong> ‘slide‘ boot argument present in NVRAM or
anywhere else. It is not necessary unless the system cannot be booted at
all or <code>No slide values are usable! Use custom slide!</code>
message can be seen in the log.</p></li>
<li><p><code>CFG Lock</code> (MSR <code>0xE2</code> write protection)
disabled in firmware settings if present. Refer to the <a
href="#kernelpropsquirks">ControlMsrE2</a> notes for details.</p></li>
<li><p><code>CSM</code> (Compatibility Support Module) disabled in
firmware settings if present. On NVIDIA 6xx/AMD 2xx or older, GOP ROM
may have to be flashed first. Use <a
href="https://www.win-raid.com/t892f16-AMD-and-Nvidia-GOP-update-No-requests-DIY.html">GopUpdate</a>
(see the second post) or <a
href="http://www.insanelymac.com/forum/topic/299614-asus-eah6450-video-bios-uefi-gop-upgrade-and-gop-uefi-binary-in-efi-for-many-ati-cards/page-1#entry2042163">AMD
UEFI GOP MAKER</a> in case of any potential confusion.</p></li>
<li><p><code>EHCI/XHCI Hand-off</code> enabled in firmware settings
<code>only</code> if boot stalls unless USB devices are
disconnected.</p></li>
<li><p><code>VT-x</code>, <code>Hyper Threading</code>,
<code>Execute Disable Bit</code> enabled in firmware settings if
present.</p></li>
<li><p>While it may not be required, sometimes
<code>Thunderbolt support</code>, <code>Intel SGX</code>, and
<code>Intel Platform Trust</code> may have to be disabled in firmware
settings present.</p></li>
</ul>
<p>When debugging sleep issues, Power Nap and automatic power off (which
appear to sometimes cause wake to black screen or boot loop issues on
older platforms) may be temporarily disabled. The specific issues may
vary, but ACPI tables should typically be looked at first.</p>
<p>Here is an example of a defect found on some <a
href="http://www.insanelymac.com/forum/topic/329624-need-cmos-reset-after-sleep-only-after-login/#entry2534645">Z68
motherboards</a>. To turn Power Nap and the others off, run the
following commands in Terminal:</p>
<pre id="powernap" data-label="powernap" style="ocbash"><code>sudo pmset autopoweroff 0
sudo pmset powernap 0
sudo pmset standby 0</code></pre>
<p><em>Note</em>: These settings may be reset by hardware changes and in
certain other circumstances. To view their current state, use the
<code>pmset -g</code> command in Terminal.</p>
<h2 id="booterprops">Properties</h2>
<ol>
<li><p><code>MmioWhitelist</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: To be filled with <code>plist dict</code>
values, describing addresses critical for particular firmware
functioning when <code>DevirtualiseMmio</code> quirk is in use. Refer to
the <a href="#booterpropsmmio">MmioWhitelist Properties</a> section
below for details.</p></li>
<li><p><code>Patch</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Perform binary patches in booter.</p>
<p>To be filled with <code>plist dictionary</code> values, describing
each patch. Refer to the <a href="#booterpropspatch">Patch
Properties</a> section below for details.</p></li>
<li><p><code>Quirks</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual booter quirks described
in the <a href="#booterpropsquirks">Quirks Properties</a> section
below.</p></li>
</ol>
<h2 id="booterpropsmmio">MmioWhitelist Properties</h2>
<ol>
<li><p><code>Address</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Exceptional MMIO address, which memory
descriptor should be left virtualised (unchanged) by
<code>DevirtualiseMmio</code>. This means that the firmware will be able
to directly communicate with this memory region during operating system
functioning, because the region this value is in will be assigned a
virtual address.</p>
<p>The addresses written here must be part of the memory map, have
<code>EfiMemoryMappedIO</code> type and <code>EFI_MEMORY_RUNTIME</code>
attribute (highest bit) set. The debug log can be used to find the list
of the candidates.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Exclude MMIO address from the
devirtualisation procedure.</p></li>
</ol>
<h2 id="booterpropspatch">Patch Properties</h2>
<ol>
<li><p><code>Arch</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Any</code> (Apply to any supported
architecture)<br />
<strong>Description</strong>: Booter patch architecture
(<code>i386</code>, <code>x86_64</code>).</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Count</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Apply to all occurrences
found)<br />
<strong>Description</strong>: Number of patch occurrences to
apply.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to activate this
booter patch.</p></li>
<li><p><code>Find</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Data to find. Must be equal to
<code>Replace</code> in size if set.</p></li>
<li><p><code>Identifier</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Any</code> (Match any booter)<br />
<strong>Description</strong>: <code>Apple</code> for macOS booter
(typically <code>boot.efi</code>); or a name with a suffix, such as
<code>bootmgfw.efi</code>, for a specific booter.</p></li>
<li><p><code>Limit</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Search the entire
booter)<br />
<strong>Description</strong>: Maximum number of bytes to search
for.</p></li>
<li><p><code>Mask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during find
comparison. Allows fuzzy search by ignoring not masked (set to zero)
bits. Must be equal to <code>Find</code> in size if set.</p></li>
<li><p><code>Replace</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Replacement data of one or more
bytes.</p></li>
<li><p><code>ReplaceMask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during replacement.
Allows fuzzy replacement by updating masked (set to non-zero) bits. Must
be equal to <code>Replace</code> in size if set.</p></li>
<li><p><code>Skip</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Do not skip any
occurrences)<br />
<strong>Description</strong>: Number of found occurrences to skip before
replacements are applied.</p></li>
</ol>
<h2 id="booterpropsquirks">Quirks Properties</h2>
<ol>
<li><p><code>AllowRelocationBlock</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Allows booting macOS through a relocation
block.</p>
<p>The relocation block is a scratch buffer allocated in the lower 4 GB
used for loading the kernel and related structures by EfiBoot on
firmware where the lower memory region is otherwise occupied by
(assumed) non-runtime data. Right before kernel startup, the relocation
block is copied back to lower addresses. Similarly, all the other
addresses pointing to the relocation block are also carefully adjusted.
The relocation block can be used when:</p>
<ul>
<li><p>No better slide exists (all the memory is used)</p></li>
<li><p><code>slide=0</code> is forced (by an argument or safe
mode)</p></li>
<li><p>KASLR (slide) is unsupported (this is Mac OS X 10.7 or
older)</p></li>
</ul>
<p>This quirk typically requires <code>ProvideCustomSlide</code> and
<code>AvoidRuntimeDefrag</code> to be enabled to function correctly.
Hibernation is not supported when booting with a relocation block, which
will only be used if required when the quirk is enabled.</p>
<p><em>Note</em>: While this quirk is required to run older macOS
versions on platforms with used lower memory, it is not compatible with
some hardware and macOS 11. In such cases, consider using
<code>EnableSafeModeSlide</code> instead.</p></li>
<li><p><code>AvoidRuntimeDefrag</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Protect from boot.efi runtime memory
defragmentation.</p>
<p>This option fixes UEFI runtime services (date, time, NVRAM, power
control, etc.) support on firmware that uses SMM backing for certain
services such as variable storage. SMM may try to access memory by
physical addresses in non-SMM areas but this may sometimes have been
moved by boot.efi. This option prevents boot.efi from moving such
data.</p>
<p><em>Note</em>: Most types of firmware, apart from Apple and VMware,
need this quirk.</p></li>
<li><p><code>DevirtualiseMmio</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Remove runtime attribute from certain MMIO
regions.</p>
<p>This quirk reduces the stolen memory footprint in the memory map by
removing the runtime bit for known memory regions. This quirk may result
in an increase of KASLR slides available but without additional
measures, it is not necessarily compatible with the target board. This
quirk typically frees between 64 and 256 megabytes of memory, present in
the debug log, and on some platforms, is the only way to boot macOS,
which otherwise fails with allocation errors at the bootloader
stage.</p>
<p>This option is useful on all types of firmware, except for some very
old ones such as Sandy Bridge. On certain firmware, a list of addresses
that need virtual addresses for proper NVRAM and hibernation
functionality may be required. Use the <code>MmioWhitelist</code>
section for this.</p></li>
<li><p><code>DisableSingleUser</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Disable single user mode.</p>
<p>This is a security option that restricts the activation of single
user mode by ignoring the <code>CMD+S</code> hotkey and the
<code>-s</code> boot argument. The behaviour with this quirk enabled is
supposed to match T2-based model behaviour. Refer to this <a
href="https://web.archive.org/web/20200517125051/https://support.apple.com/en-us/HT201573">archived
article</a> to understand how to use single user mode with this quirk
enabled.</p>
<p><em>Note</em>: When Apple Secure Boot is enabled single user mode is
always disabled.</p></li>
<li><p><code>DisableVariableWrite</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Protect from macOS NVRAM write access.</p>
<p>This is a security option that restricts NVRAM access in macOS. This
quirk requires <code>OC_FIRMWARE_RUNTIME</code> protocol implemented in
<code>OpenRuntime.efi</code>.</p>
<p><em>Note</em>: This quirk can also be used as an ad hoc workaround
for defective UEFI runtime services implementations that are unable to
write variables to NVRAM and results in operating system
failures.</p></li>
<li><p><code>DiscardHibernateMap</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Reuse original hibernate memory map.</p>
<p>This option forces the XNU kernel to ignore a newly supplied memory
map and assume that it did not change after waking from hibernation.
This behaviour is required by Windows to work. Windows mandates <a
href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-uefi#hibernation-state-s4-transition-requirements">preserving</a>
runtime memory size and location after S4 wake.</p>
<p><em>Note</em>: This may be used to workaround defective memory map
implementations on older, rare legacy hardware. Examples of such
hardware are Ivy Bridge laptops with Insyde firmware such as the Acer
V3-571G. Do not use this option without a full understanding of the
implications.</p></li>
<li><p><code>EnableSafeModeSlide</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Patch bootloader to have KASLR enabled in
safe mode.</p>
<p>This option is relevant to users with issues booting to safe mode
(e.g. by holding <code>shift</code> or with using the <code>-x</code>
boot argument). By default, safe mode forces <code>0</code> slide as if
the system was launched with the <code>slide=0</code> boot argument.</p>
<ul>
<li><p>This quirk attempts to patch the <code>boot.efi</code> file to
remove this limitation and to allow using other values (from
<code>1</code> to <code>255</code> inclusive).</p></li>
<li><p>This quirk requires enabling
<code>ProvideCustomSlide</code>.</p></li>
</ul>
<p><em>Note</em>: The need for this option is dependent on the
availability of safe mode. It can be enabled when booting to safe mode
fails.</p></li>
<li><p><code>EnableWriteUnprotector</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Permit write access to UEFI runtime
services code.</p>
<p>This option bypasses <code>W^X</code> permissions in code pages of
UEFI runtime services by removing write protection (<code>WP</code>) bit
from <code>CR0</code> register during their execution. This quirk
requires <code>OC_FIRMWARE_RUNTIME</code> protocol implemented in
<code>OpenRuntime.efi</code>.</p>
<p><em>Note</em>: This quirk may potentially weaken firmware security.
Please use <code>RebuildAppleMemoryMap</code> if the firmware supports
memory attributes table (MAT). Refer to the
<code>OCABC: MAT support is 1/0</code> log entry to determine whether
MAT is supported.</p></li>
<li><p><code>FixupAppleEfiImages</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Fix permissions and section errors in
macOS <code>boot.efi</code> images.</p>
<p>Mac OS X <code>boot.efi</code> images contain <code>W^X</code>
permissions errors in all versions, and 10.4 and 10.5 32-bit versions
also contain illegal overlapping sections. Modern, strict PE loaders
will refuse to load such images unless additional mitigations are
applied. The image loader which matters here is the one provided by the
system firmware, or by OpenDuet if OpenDuet is providing the UEFI
compatibility layer. Image loaders which enforce these stricter rules
include the loader provided with current versions of OpenDuet, the
loader in OVMF if compiled from <a
href="https://github.com/acidanthera/audk">audk</a>, and possibly the
image loaders of some very recent 3rd party firmware (e.g.
Microsoft).</p>
<p>This quirk detects these issues and pre-processes such images in
memory so that a stricter loader will accept them.</p>
<p>On a system with such a modern, stricter loader this quirk is
required to load Mac OS X 10.4 to macOS 10.12, and is required for all
newer macOS when <code>SecureBootModel</code> is set to
<code>Disabled</code>.</p>
<p><em>Note 1</em>: The quirk is never applied during the Apple secure
boot path for newer macOS. The Apple secure boot path in OpenCore
includes its own separate mitigations for <code>boot.efi</code>
<code>W^X</code> issues.</p>
<p><em>Note 2</em>: When enabled, and when not processing for Apple
secure boot, this quirk is applied to:</p>
<ul>
<li><p>All images from Apple Fat binaries (32-bit and 64-bit versions in
one image).</p></li>
<li><p>All Apple-signed images.</p></li>
<li><p>All images at <code>\System\Library\CoreServices\boot.efi</code>
within their filesystem.</p></li>
</ul>
<p><em>Note 3</em>: Pre-processing in memory is incompatible with UEFI
secure boot, as the image loaded is not the image on disk, so you cannot
sign files which are loaded in this way based on their original disk
image contents. Certain firmware will offer to register the hash of new,
unknown images for future secure boot - this would still work. On the
other hand, it is not particularly realistic to want to start these
early, insecure images with secure boot anyway.</p></li>
<li><p><code>ForceBooterSignature</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set macOS <code>boot-signature</code> to
OpenCore launcher.</p>
<p>Booter signature, essentially a SHA-1 hash of the loaded image, is
used by Mac EFI to verify the authenticity of the bootloader when waking
from hibernation. This option forces macOS to use OpenCore launcher
SHA-1 hash as a booter signature to let OpenCore shim hibernation wake
on Mac EFI firmware.</p>
<p><em>Note</em>: OpenCore launcher path is determined from
<code>LauncherPath</code> property.</p></li>
<li><p><code>ForceExitBootServices</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Retry <code>ExitBootServices</code> with
new memory map on failure.</p>
<p>Try to ensure that the <code>ExitBootServices</code> call succeeds.
If required, an outdated <code>MemoryMap</code> key argument can be used
by obtaining the current memory map and retrying the
<code>ExitBootServices</code> call.</p>
<p><em>Note</em>: The need for this quirk is determined by early boot
crashes of the firmware. Do not use this option without a full
understanding of the implications.</p></li>
<li><p><code>ProtectMemoryRegions</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Protect memory regions from incorrect
access.</p>
<p>Some types of firmware incorrectly map certain memory regions:</p>
<ul>
<li><p>The CSM region can be marked as boot services code, or data,
which leaves it as free memory for the XNU kernel.</p></li>
<li><p>MMIO regions can be marked as reserved memory and stay unmapped.
They may however be required to be accessible at runtime for NVRAM
support.</p></li>
</ul>
<p>This quirk attempts to fix the types of these regions, e.g. ACPI NVS
for CSM or MMIO for MMIO.</p>
<p><em>Note</em>: The need for this quirk is determined by artifacts,
sleep wake issues, and boot failures. This quirk is typically only
required by very old firmware.</p></li>
<li><p><code>ProtectSecureBoot</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Protect UEFI Secure Boot variables from
being written.</p>
<p>Reports security violation during attempts to write to
<code>db</code>, <code>dbx</code>, <code>PK</code>, and <code>KEK</code>
variables from the operating system.</p>
<p><em>Note</em>: This quirk attempts to avoid issues with NVRAM
implementations with fragmentation issues, such as on the
<code>MacPro5,1</code> as well as on certain Insyde firmware without
garbage collection or with defective garbage collection.</p></li>
<li><p><code>ProtectUefiServices</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Protect UEFI services from being
overridden by the firmware.</p>
<p>Some modern firmware, including on virtual machines such as VMware,
may update pointers to UEFI services during driver loading and related
actions. Consequently, this directly obstructs other quirks that affect
memory management, such as <code>DevirtualiseMmio</code>,
<code>ProtectMemoryRegions</code>, or
<code>RebuildAppleMemoryMap</code>, and may also obstruct other quirks
depending on the scope of such.</p>
<p>GRUB Shim makes similar on-the-fly changes to various UEFI image
services, which are also protected against by this quirk.</p>
<p><em>Note 1</em>: On VMware, the need for this quirk may be determined
by the appearance of the “Your Mac OS guest might run unreliably with
more than one virtual core.” message.</p>
<p><em>Note 2</em>: This quirk is needed for correct operation if
OpenCore is chainloaded from GRUB with BIOS Secure Boot
enabled.</p></li>
<li><p><code>ProvideCustomSlide</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Provide custom KASLR slide on low
memory.</p>
<p>This option performs memory map analysis of the firmware and checks
whether all slides (from <code>1</code> to <code>255</code>) can be
used. As <code>boot.efi</code> generates this value randomly with
<code>rdrand</code> or pseudo randomly <code>rdtsc</code>, there is a
chance of boot failure when it chooses a conflicting slide. In cases
where potential conflicts exist, this option forces macOS to select a
pseudo random value from the available values. This also ensures that
the <code>slide=</code> argument is never passed to the operating system
(for security reasons).</p>
<p><em>Note</em>: The need for this quirk is determined by the
<code>OCABC: Only N/256 slide values are usable!</code> message in the
debug log.</p></li>
<li><p><code>ProvideMaxSlide</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Provide maximum KASLR slide when higher
ones are unavailable.</p>
<p>This option overrides the maximum slide of 255 by a user specified
value between 1 and 254 (inclusive) when <code>ProvideCustomSlide</code>
is enabled. It is assumed that modern firmware allocates pool memory
from top to bottom, effectively resulting in free memory when slide
scanning is used later as temporary memory during kernel loading. When
such memory is not available, this option stops the evaluation of higher
slides.</p>
<p><em>Note</em>: The need for this quirk is determined by random boot
failures when <code>ProvideCustomSlide</code> is enabled and the
randomized slide falls into the unavailable range. When
<code>AppleDebug</code> is enabled, the debug log typically contains
messages such as <code>AAPL: [EB|‘LD:LKC] } Err(0x9)</code>. To find the
optimal value, append <code>slide=X</code>, where <code>X</code> is the
slide value, to the <code>boot-args</code> and select the largest one
that does not result in boot failures.</p></li>
<li><p><code>RebuildAppleMemoryMap</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Generate macOS compatible Memory Map.</p>
<p>The Apple kernel has several limitations on parsing the UEFI memory
map:</p>
<ul>
<li><p>The Memory map size must not exceed 4096 bytes as the Apple
kernel maps it as a single 4K page. As some types of firmware can have
very large memory maps, potentially over 100 entries, the Apple kernel
will crash on boot.</p></li>
<li><p>The Memory attributes table is ignored.
<code>EfiRuntimeServicesCode</code> memory statically gets
<code>RX</code> permissions while all other memory types get
<code>RW</code> permissions. As some firmware drivers may write to
global variables at runtime, the Apple kernel will crash at calling UEFI
runtime services unless the driver <code>.data</code> section has a
<code>EfiRuntimeServicesData</code> type.</p></li>
</ul>
<p>To workaround these limitations, this quirk applies memory attribute
table permissions to the memory map passed to the Apple kernel and
optionally attempts to unify contiguous slots of similar types if the
resulting memory map exceeds 4 KB.</p>
<p><em>Note 1</em>: Since several types of firmware come with incorrect
memory protection tables, this quirk often comes paired with
<code>SyncRuntimePermissions</code>.</p>
<p><em>Note 2</em>: The need for this quirk is determined by early boot
failures. This quirk replaces <code>EnableWriteUnprotector</code> on
firmware supporting Memory Attribute Tables (MAT). This quirk is
typically unnecessary when using <code>OpenDuetPkg</code> but may be
required to boot Mac OS X 10.6, and earlier, for reasons that are as yet
unclear.</p></li>
<li><p><code>ResizeAppleGpuBars</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Description</strong>: Reduce GPU PCI BAR sizes for compatibility
with macOS.</p>
<p>This quirk reduces GPU PCI BAR sizes for Apple macOS up to the
specified value or lower if it is unsupported. The specified value
follows PCI Resizable BAR spec. While Apple macOS supports a theoretical
1 GB maximum, in practice all non-default values may not work correctly.
For this reason the only supported value for this quirk is the minimal
supported BAR size, i.e. <code>0</code>. Use <code>-1</code> to disable
this quirk.</p>
<p>For development purposes one may take risks and try other values.
Consider a GPU with 2 BARs:</p>
<ul>
<li><p><code>BAR0</code> supports sizes from 256 MB to 8 GB. Its value
is 4 GB.</p></li>
<li><p><code>BAR1</code> supports sizes from 2 MB to 256 MB. Its value
is 256 MB.</p></li>
</ul>
<p><em>Example 1</em>: Setting <code>ResizeAppleGpuBars</code> to 1 GB
will change <code>BAR0</code> to 1 GB and leave <code>BAR1</code>
unchanged.<br />
<em>Example 2</em>: Setting <code>ResizeAppleGpuBars</code> to 1 MB will
change <code>BAR0</code> to 256 MB and <code>BAR0</code> to 2 MB.<br />
<em>Example 3</em>: Setting <code>ResizeAppleGpuBars</code> to 16 GB
will make no changes.</p>
<p><em>Note</em>: See <code>ResizeGpuBars</code> quirk for general GPU
PCI BAR size configuration and more details about the
technology.</p></li>
<li><p><code>SetupVirtualMap</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Setup virtual memory at
<code>SetVirtualAddresses</code>.</p>
<p>Some types of firmware access memory by virtual addresses after a
<code>SetVirtualAddresses</code> call, resulting in early boot crashes.
This quirk workarounds the problem by performing early boot identity
mapping of assigned virtual addresses to physical memory.</p>
<p><em>Note</em>: The need for this quirk is determined by early boot
failures.</p></li>
<li><p><code>SignalAppleOS</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Report macOS being loaded through OS Info
for any OS.</p>
<p>This quirk is useful on Mac firmware, which loads different operating
systems with different hardware configurations. For example, it is
supposed to enable Intel GPU in Windows and Linux in some dual-GPU
MacBook models.</p></li>
<li><p><code>SyncRuntimePermissions</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Update memory permissions for the runtime
environment.</p>
<p>Some types of firmware fail to properly handle runtime
permissions:</p>
<ul>
<li><p>They incorrectly mark <code>OpenRuntime</code> as not executable
in the memory map.</p></li>
<li><p>They incorrectly mark <code>OpenRuntime</code> as not executable
in the memory attributes table.</p></li>
<li><p>They lose entries from the memory attributes table after
<code>OpenRuntime</code> is loaded.</p></li>
<li><p>They mark items in the memory attributes table as
read-write-execute.</p></li>
</ul>
<p>This quirk attempts to update the memory map and memory attributes
table to correct this.</p>
<p><em>Note</em>: The need for this quirk is indicated by early boot
failures (note: includes halt at black screen as well as more obvious
crash). Particularly likely to affect early boot of Windows or Linux
(but not always both) on affected systems. Only firmware released after
2017 is typically affected.</p></li>
</ol>
<h1 id="devprops">DeviceProperties</h1>
<h2 id="devpropsintro">Introduction</h2>
<p>Device configuration is provided to macOS with a dedicated buffer,
called <code>EfiDevicePathPropertyDatabase</code>. This buffer is a
serialised map of DevicePaths to a map of property names and their
values.</p>
<p>Property data can be debugged with <a
href="https://github.com/acidanthera/gfxutil">gfxutil</a>. To obtain
current property data, use the following command in macOS:</p>
<pre id="gfxutil" data-label="gfxutil" style="ocbash"><code>ioreg -lw0 -p IODeviceTree -n efi -r -x | grep device-properties |
  sed &#39;s/.*&lt;//;s/&gt;.*//&#39; &gt; /tmp/device-properties.hex &amp;&amp;
  gfxutil /tmp/device-properties.hex /tmp/device-properties.plist &amp;&amp;
  cat /tmp/device-properties.plist</code></pre>
<p>Device properties are part of the <code>IODeviceTree</code>
(<code>gIODT</code>) plane of the macOS I/O Registry. This plane has
several construction stages relevant for the platform initialisation.
While the early construction stage is performed by the XNU kernel in the
<code>IODeviceTreeAlloc</code> method, the majority of the construction
is performed by the platform expert, implemented in
<code>AppleACPIPlatformExpert.kext</code>.</p>
<p>AppleACPIPlatformExpert incorporates two stages of
<code>IODeviceTree</code> construction implemented by calling<br />
<code>AppleACPIPlatformExpert::mergeDeviceProperties</code>:</p>
<ol>
<li><p>During ACPI table initialisation through the recursive ACPI
namespace scanning by the calls to<br />
<code>AppleACPIPlatformExpert::createDTNubs</code>.</p></li>
<li><p>During IOService registration
(<code>IOServices::registerService</code>) callbacks implemented as a
part of<br />
<code>AppleACPIPlatformExpert::platformAdjustService</code> function and
its private worker method<br />
<code>AppleACPIPlatformExpert::platformAdjustPCIDevice</code> specific
to the PCI devices.</p></li>
</ol>
<p>The application of the stages depends on the device presence in ACPI
tables. The first stage applies very early but exclusively to the
devices present in ACPI tables. The second stage applies to all devices
much later after the PCI configuration and may repeat the first stage if
the device was not present in ACPI.</p>
<p>For all kernel extensions that may inspect the
<code>IODeviceTree</code> plane without probing, such as
<code>Lilu</code> and its plugins (e.g. <code>WhateverGreen</code>), it
is especially important to ensure device presence in the ACPI tables. A
failure to do so may result <strong>in erratic behaviour</strong> caused
by ignoring the injected device properties as they were not constructed
at the first stage. See <code>SSDT-IMEI.dsl</code> and
<code>SSDT-BRG0.dsl</code> for an example.</p>
<h2 id="devpropsprops">Properties</h2>
<ol>
<li><p><code>Add</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Sets device properties from a map
(<code>plist dict</code>) of device paths to a map
(<code>plist dict</code>) of variable names and their values in
<code>plist multidata</code> format.</p>
<p><em>Note 1</em>: Device paths must be provided in canonic string
format (e.g. <code>PciRoot(0x0)/Pci(0x1,0x0)/Pci(0x0,0x0)</code>).</p>
<p><em>Note 2</em>: Existing properties will not be changed unless
deleted in the <code>DeviceProperties Delete</code> section.</p></li>
<li><p><code>Delete</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Removes device properties from a map
(<code>plist dict</code>) of device paths to an array
(<code>plist array</code>) of variable names in
<code>plist string</code> format.</p>
<p><em>Note</em>: Currently, existing properties may only exist on
firmware with DeviceProperties drivers (e.g. Apple). Hence, there is
typically no reason to delete variables unless a new driver has been
installed.</p></li>
</ol>
<h2 id="devpropscommon">Common Properties</h2>
<p>Some known properties include:</p>
<ul>
<li><p><code>device-id</code> User-specified device identifier used for
I/O Kit matching. Has 4 byte data type.</p></li>
<li><p><code>vendor-id</code> User-specified vendor identifier used for
I/O Kit matching. Has 4 byte data type.</p></li>
<li><p><code>AAPL,ig-platform-id</code> Intel GPU framebuffer identifier
used for framebuffer selection on Ivy Bridge and newer. Has 4 byte data
type.</p></li>
<li><p><code>AAPL,snb-platform-id</code> Intel GPU framebuffer
identifier used for framebuffer selection on Sandy Bridge. Has 4 byte
data type.</p></li>
<li><p><code>layout-id</code> Audio layout used for AppleHDA layout
selection. Has 4 byte data type.</p></li>
</ul>
<h1 id="kernel">Kernel</h1>
<h2 id="kernelintro">Introduction</h2>
<p>This section allows the application of different kinds of kernelspace
modifications on Apple Kernel (<a
href="https://opensource.apple.com/source/xnu">XNU</a>). The
modifications currently provide driver (kext) injection, kernel and
driver patching, and driver blocking.</p>
<p>Kernel and kext changes apply with the following effective order:</p>
<ul>
<li><p><code>Block</code> is processed.</p></li>
<li><p><code>Add</code> and <code>Force</code> are processed.</p></li>
<li><p><code>Emulate</code> and <code>Quirks</code> are
processed.</p></li>
<li><p><code>Patch</code> is processed.</p></li>
</ul>
<h2 id="kernelprops">Properties</h2>
<ol>
<li><p><code>Add</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Load selected kernel extensions (kexts)
from the <code>OC/Kexts</code> directory.</p>
<p>To be filled with <code>plist dict</code> values, describing each
kext. Refer to the <a href="#kernelpropsadd">Add Properties</a> section
below for details.</p>
<p><em>Note 1</em>: The load order is based on the order in which the
kexts appear in the array. Hence, dependencies must appear before kexts
that depend on them.</p>
<p><em>Note 2</em>: To track the dependency order, inspect the
<code>OSBundleLibraries</code> key in the <code>Info.plist</code> file
of the kext being added. Any kext included under the key is a dependency
that must appear before the kext being added.</p>
<p><em>Note 3</em>: Kexts may have inner kexts (<code>Plugins</code>)
included in the bundle. Such <code>Plugins</code> must be added
separately and follow the same global ordering rules as other
kexts.</p></li>
<li><p><code>Block</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Remove selected kernel extensions (kexts)
from the prelinked kernel.</p>
<p>To be filled with <code>plist dictionary</code> values, describing
each blocked kext. Refer to the <a href="#kernelpropsblock">Block
Properties</a> section below for details.</p></li>
<li><p><code>Emulate</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Emulate certain hardware in kernelspace
via parameters described in the <a href="#kernelpropsemu">Emulate
Properties</a> section below.</p></li>
<li><p><code>Force</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Load kernel extensions (kexts) from the
system volume if they are not cached.</p>
<p>To be filled with <code>plist dict</code> values, describing each
kext. Refer to the <a href="#kernelpropsforce">Force Properties</a>
section below for details. This section resolves the problem of
injecting kexts that depend on other kexts, which are not otherwise
cached. The issue typically affects older operating systems, where
various dependency kexts, such as <code>IOAudioFamily</code> or
<code>IONetworkingFamily</code> may not be present in the kernel cache
by default.</p>
<p><em>Note 1</em>: The load order is based on the order in which the
kexts appear in the array. Hence, dependencies must appear before kexts
that depend on them.</p>
<p><em>Note 2</em>: <code>Force</code> happens before
<code>Add</code>.</p>
<p><em>Note 3</em>: The signature of the “forced” kext is not checked in
any way. This makes using this feature extremely dangerous and
undesirable for secure boot.</p>
<p><em>Note 4</em>: This feature may not work on encrypted partitions in
newer operating systems.</p></li>
<li><p><code>Patch</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Perform binary patches in kernel and
drivers prior to driver addition and removal.</p>
<p>To be filled with <code>plist dictionary</code> values, describing
each patch. Refer to the <a href="#kernelpropspatch">Patch
Properties</a> section below for details.</p></li>
<li><p><code>Quirks</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual kernel and driver quirks
described in the <a href="#kernelpropsquirks">Quirks Properties</a>
section below.</p></li>
<li><p><code>Scheme</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Define kernelspace operation mode via
parameters described in the <a href="#kernelpropsscheme">Scheme
Properties</a> section below.</p></li>
</ol>
<h2 id="kernelpropsadd">Add Properties</h2>
<h2 id="kernelpropsblock">Block Properties</h2>
<ol>
<li><p><code>Arch</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Any</code> (Apply to any supported
architecture)<br />
<strong>Description</strong>: Kext block architecture
(<code>i386</code>, <code>x86_64</code>).</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to block this
kernel extension.</p></li>
<li><p><code>Identifier</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext bundle identifier (e.g.
<code>com.apple.driver.AppleTyMCEDriver</code>).</p></li>
<li><p><code>MaxKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Blocks kernel extension on specified macOS
version or older.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>MinKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Blocks kernel extension on specified macOS
version or newer.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>Strategy</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Disable</code> (Forcibly make the
kernel driver kmod startup code return failure)<br />
<strong>Description</strong>: Determines the behaviour of kernel driver
blocking.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Disable</code> — Forcibly make the kernel driver kmod
startup code return failure.</p></li>
<li><p><code>Exclude</code> — Remove the kernel driver from the kernel
cache by dropping plist entry and filling in zeroes.</p></li>
</ul>
<p><em>Note</em>: It is risky to <code>Exclude</code> a kext that is a
dependency of others.</p>
<p><em>Note 2</em>: At this moment <code>Exclude</code> is only applied
to <code>prelinkedkernel</code> and newer mechanisms.</p>
<p><em>Note 3</em>: In most cases strategy <code>Exclude</code> requires
the new kext to be injected as a replacement.</p></li>
</ol>
<h2 id="kernelpropsemu">Emulate Properties</h2>
<ol>
<li><p><code>Cpuid1Data</code><br />
<strong>Type</strong>: <code>plist data</code>, 16 bytes<br />
<strong>Failsafe</strong>: All zero<br />
<strong>Description</strong>: Sequence of <code>EAX</code>,
<code>EBX</code>, <code>ECX</code>, <code>EDX</code> values to replace
<code>CPUID (1)</code> call in XNU kernel.</p>
<p>This property primarily meets three requirements:</p>
<ul>
<li><p>Enabling support for an unsupported CPU model (e.g. Intel
Pentium).</p></li>
<li><p>Enabling support for a CPU model not yet supported by a specific
version of macOS (typically old versions).</p></li>
<li><p>Enabling XCPM support for an unsupported CPU variant.</p></li>
</ul>
<p><em>Note 1</em>: It may also be the case that the CPU model is
supported but there is no power management supported (e.g. virtual
machines). In this case, <code>MinKernel</code> and
<code>MaxKernel</code> can be set to restrict CPU virtualisation and
dummy power management patches to the particular macOS kernel
version.</p>
<p><em>Note 2</em>: Only the value of <code>EAX</code>, which represents
the full CPUID, typically needs to be accounted for and remaining bytes
should be left as zeroes. The byte order is Little Endian. For example,
<code>C3 06 03 00</code> stands for CPUID <code>0x0306C3</code>
(Haswell).</p>
<p><em>Note 3</em>: For XCPM support it is recommended to use the
following combinations. Be warned that one is required to set the
correct <a
href="https://github.com/dortania/bugtracker/issues/190">frequency
vectors</a> matching the installed CPU.</p>
<ul>
<li><p>Haswell-E (<code>0x0306F2</code>) to Haswell
(<code>0x0306C3</code>):<br />
<code>Cpuid1Data</code>:
<code>C3 06 03 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br />
<code>Cpuid1Mask</code>:
<code>FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00</code></p></li>
<li><p>Broadwell-E (<code>0x0406F1</code>) to Broadwell
(<code>0x0306D4</code>):<br />
<code>Cpuid1Data</code>:
<code>D4 06 03 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br />
<code>Cpuid1Mask</code>:
<code>FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00</code></p></li>
<li><p>Comet Lake U62 (<code>0x0A0660</code>) to Comet Lake U42
(<code>0x0806EC</code>):<br />
<code>Cpuid1Data</code>:
<code>EC 06 08 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br />
<code>Cpuid1Mask</code>:
<code>FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00</code></p></li>
<li><p>Rocket Lake (<code>0x0A0670</code>) to Comet Lake
(<code>0x0A0655</code>):<br />
<code>Cpuid1Data</code>:
<code>55 06 0A 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br />
<code>Cpuid1Mask</code>:
<code>FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00</code></p></li>
<li><p>Alder Lake (<code>0x090672</code>) to Comet Lake
(<code>0x0A0655</code>):<br />
<code>Cpuid1Data</code>:
<code>55 06 0A 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br />
<code>Cpuid1Mask</code>:
<code>FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00</code></p></li>
</ul>
<p><em>Note 4</em>: Be aware that the following configurations are
unsupported by XCPM (at least out of the box):</p>
<ul>
<li><p>Consumer Ivy Bridge (<code>0x0306A9</code>) as Apple disabled
XCPM for Ivy Bridge and recommends legacy power management for these
CPUs. <code>_xcpm_bootstrap</code> should manually be patched to enforce
XCPM on these CPUs instead of this option.</p></li>
<li><p>Low-end CPUs (e.g. Haswell+ Pentium) as they are not supported
properly by macOS. Legacy workarounds for older models can be found in
the <code>Special NOTES</code> section of <a
href="https://github.com/acidanthera/bugtracker/issues/365">acidanthera/bugtracker#365</a>.</p></li>
</ul></li>
<li><p><code>Cpuid1Mask</code><br />
<strong>Type</strong>: <code>plist data</code>, 16 bytes<br />
<strong>Failsafe</strong>: All zero<br />
<strong>Description</strong>: Bit mask of active bits in
<code>Cpuid1Data</code>.</p>
<p>When each <code>Cpuid1Mask</code> bit is set to 0, the original CPU
bit is used, otherwise set bits take the value of
<code>Cpuid1Data</code>.</p></li>
<li><p><code>DummyPowerManagement</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4-12<br />
<strong>Description</strong>: Disables
<code>AppleIntelCpuPowerManagement</code>.</p>
<p><em>Note 1</em>: This option is a preferred alternative to
<code>NullCpuPowerManagement.kext</code> for CPUs without native power
management driver in macOS.</p>
<p><em>Note 2</em>: While this option is typically needed to disable
<code>AppleIntelCpuPowerManagement</code> on unsupported platforms, it
can also be used to disable this kext in other situations (e.g. with
<code>Cpuid1Data</code> left blank).</p></li>
<li><p><code>MaxKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Emulates CPUID and applies
<code>DummyPowerManagement</code> on specified macOS version or
older.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>MinKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Emulates CPUID and applies
<code>DummyPowerManagement</code> on specified macOS version or
newer.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
</ol>
<h2 id="kernelpropsforce">Force Properties</h2>
<ol>
<li><p><code>Arch</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Any</code> (Apply to any supported
architecture)<br />
<strong>Description</strong>: Kext architecture (<code>i386</code>,
<code>x86_64</code>).</p></li>
<li><p><code>BundlePath</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext bundle path (e.g.
<code>System\Library \Extensions \IONetworkingFamily.kext</code>).</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to load this
kernel extension from the system volume when not present in the kernel
cache.</p></li>
<li><p><code>ExecutablePath</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext executable path relative to bundle
(e.g. <code>Contents/MacOS/IONetworkingFamily</code>).</p></li>
<li><p><code>Identifier</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext identifier to perform presence
checking before adding (e.g.
<code>com.apple.iokit.IONetworkingFamily</code>). Only drivers which
identifiers are not be found in the cache will be added.</p></li>
<li><p><code>MaxKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Adds kernel extension on specified macOS
version or older.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>MinKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Adds kernel extension on specified macOS
version or newer.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>PlistPath</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext <code>Info.plist</code> path relative
to bundle (e.g. <code>Contents/Info.plist</code>).</p></li>
</ol>
<h2 id="kernelpropspatch">Patch Properties</h2>
<ol>
<li><p><code>Arch</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Any</code> (Apply to any supported
architecture)<br />
<strong>Description</strong>: Kext patch architecture
(<code>i386</code>, <code>x86_64</code>).</p></li>
<li><p><code>Base</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Selects symbol-matched base for patch
lookup (or immediate replacement) by obtaining the address of the
provided symbol name.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Count</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Number of patch occurrences to apply.
<code>0</code> applies the patch to all occurrences found.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: This kernel patch will not be used unless
set to <code>true</code>.</p></li>
<li><p><code>Find</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Immediate replacement at
<code>Base</code>)<br />
<strong>Description</strong>: Data to find. Must be equal to
<code>Replace</code> in size if set.</p></li>
<li><p><code>Identifier</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Kext bundle identifier (e.g.
<code>com.apple.driver.AppleHDA</code>) or <code>kernel</code> for
kernel patch.</p></li>
<li><p><code>Limit</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Search entire kext or
kernel)<br />
<strong>Description</strong>: Maximum number of bytes to search
for.</p></li>
<li><p><code>Mask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during find
comparison. Allows fuzzy search by ignoring not masked (set to zero)
bits. Must be equal to <code>Replace</code> in size if set.</p></li>
<li><p><code>MaxKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Patches data on specified macOS version or
older.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>MinKernel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Patches data on specified macOS version or
newer.</p>
<p><em>Note</em>: Refer to the <a
href="#kernmatch"><code>Add MaxKernel</code> description</a> for
matching logic.</p></li>
<li><p><code>Replace</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Replacement data of one or more
bytes.</p></li>
<li><p><code>ReplaceMask</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: Empty (Ignored)<br />
<strong>Description</strong>: Data bitwise mask used during replacement.
Allows fuzzy replacement by updating masked (set to non-zero) bits. Must
be equal to <code>Replace</code> in size if set.</p></li>
<li><p><code>Skip</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Do not skip any
occurrences)<br />
<strong>Description</strong>: Number of found occurrences to skip before
replacements are applied.</p></li>
</ol>
<h2 id="kernelpropsquirks">Quirks Properties</h2>
<ol>
<li><p><code>AppleCpuPmCfgLock</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4<br />
<strong>Description</strong>: Disables
<code>PKG_CST_CONFIG_CONTROL</code> (<code>0xE2</code>) MSR modification
in AppleIntelCPUPowerManagement.kext, commonly causing early kernel
panic, when it is locked from writing.</p>
<p><em>Note</em>: AppleIntelCPUPowerManagement.kext is removed as of
macOS 13. However, a legacy version can be injected and thus get patched
using this quirk.</p>
<p>Some types of firmware lock the <code>PKG_CST_CONFIG_CONTROL</code>
MSR register and the bundled <code>ControlMsrE2</code> tool can be used
to check its state. Note that some types of firmware only have this
register locked on some cores. As modern firmware provide a
<code>CFG Lock</code> setting that allows configuring the
<code>PKG_CST_CONFIG_CONTROL</code> MSR register lock, this option
should be avoided whenever possible.</p>
<p>On APTIO firmware that do not provide a <code>CFG Lock</code> setting
in the GUI, it is possible to access the option directly:</p>
<ol>
<li><p>Download <a
href="https://github.com/LongSoft/UEFITool/releases">UEFITool</a> and <a
href="https://github.com/LongSoft/Universal-IFR-Extractor/releases">IFR-Extractor</a>.</p></li>
<li><p>Open the firmware image in UEFITool and find
<code>CFG Lock</code> unicode string. If it is not present, the firmware
may not have this option and the process should therefore be
discontinued.</p></li>
<li><p>Extract the <code>Setup.bin</code> PE32 Image Section (the
UEFITool found) through the <code>Extract Body</code> menu
option.</p></li>
<li><p>Run IFR-Extractor on the extracted file (e.g.
<code>./ifrextract Setup.bin Setup.txt</code>).</p></li>
<li><p>Find <code>CFG Lock, VarStoreInfo (VarOffset/VarName):</code> in
<code>Setup.txt</code> and remember the offset right after it (e.g.
<code>0x123</code>).</p></li>
<li><p>Download and run <a
href="http://brains.by/posts/bootx64.7z">Modified GRUB Shell</a>
compiled by <a
href="https://habr.com/geektimes/post/258090">brainsucker</a> or use <a
href="https://github.com/datasone/grub-mod-setup_var">a newer
version</a> by <a
href="https://github.com/datasone">datasone</a>.</p></li>
<li><p>Enter <code>setup_var 0x123 0x00</code> command, where
<code>0x123</code> should be replaced by the actual offset, and
reboot.</p></li>
</ol>
<p><strong>Warning</strong>: Variable offsets are unique not only to
each motherboard but even to its firmware version. Never ever try to use
an offset without checking.</p>
<p>On selected platforms, the <code>ControlMsrE2</code> tool can also
change such hidden options. Pass desired argument: <code>lock</code>,
<code>unlock</code> for <code>CFG Lock</code>. Or pass
<code>interactive</code> to find and modify other hidden options.</p>
<p>As a last resort, consider <a
href="https://github.com/LongSoft/UEFITool/blob/master/UEFIPatch/patches.txt">patching
the BIOS</a> (for advanced users only).</p></li>
<li><p><code>AppleXcpmCfgLock</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.8 (not required for older)<br />
<strong>Description</strong>: Disables
<code>PKG_CST_CONFIG_CONTROL</code> (<code>0xE2</code>) MSR modification
in XNU kernel, commonly causing early kernel panic, when it is locked
from writing (XCPM power management).</p>
<p><em>Note</em>: This option should be avoided whenever possible. Refer
to the <code>AppleCpuPmCfgLock</code> description for details.</p></li>
<li><p><code>AppleXcpmExtraMsrs</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.8 (not required for older)<br />
<strong>Description</strong>: Disables multiple MSR access critical for
certain CPUs, which have no native XCPM support.</p>
<p>This is typically used in conjunction with the <code>Emulate</code>
section on Haswell-E, Broadwell-E, Skylake-SP, and similar CPUs. More
details on the XCPM patches are outlined in <a
href="https://github.com/acidanthera/bugtracker/issues/365">acidanthera/bugtracker#365</a>.</p>
<p><em>Note</em>: Additional not provided patches will be required for
Ivy Bridge or Pentium CPUs. It is recommended to use
<code>AppleIntelCpuPowerManagement.kext</code> for the former.</p></li>
<li><p><code>AppleXcpmForceBoost</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.8 (not required for older)<br />
<strong>Description</strong>: Forces maximum performance in XCPM
mode.</p>
<p>This patch writes <code>0xFF00</code> to
<code>MSR_IA32_PERF_CONTROL</code> (<code>0x199</code>), effectively
setting maximum multiplier for all the time.</p>
<p><em>Note</em>: While this may increase the performance, this patch is
strongly discouraged on all systems but those explicitly dedicated to
scientific or media calculations. Only certain Xeon models typically
benefit from the patch.</p></li>
<li><p><code>CustomPciSerialDevice</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.7<br />
<strong>Description</strong>: Performs change of PMIO register base
address on a customised PCI serial device.</p>
<p>The patch changes the PMIO register base address that the XNU kernel
uses for serial input and output, from that of the default built-in COM1
serial port <code>0x3F8</code>, to the base address stored in the first
IO BAR of a specified PCI device or to a specific base address (e.g.
<code>0x2F8</code> for COM2).</p>
<p><em>Note</em>: By default, serial logging is disabled.
<code>serial=3</code> boot argument, which enables serial input and
output, should be used for XNU to print logs to the serial port.</p>
<p><em>Note 2</em>: In addition to this patch, kext
<code>Apple16X50PCI0</code> should be prevented from attaching to have
<code>kprintf</code> method working properly. This can be achieved by
using <a
href="https://github.com/joevt/PCIeSerialDisable">PCIeSerialDisable</a>.
In addition, for certain Thunderbolt cards the IOKit personality
<code>IOPCITunnelCompatible</code> also needs to be set to
<code>true</code>, which can be done by the
<code>PCIeSerialThunderboltEnable.kext</code> attached at <a
href="https://github.com/acidanthera/bugtracker/issues/2003#issuecomment-1116761087">acidanthera/bugtracker#2003</a>.</p>
<p><em>Note 3</em>: For this patch to be correctly applied,
<code>Override</code> must be enabled with all keys properly set in
<code>Custom</code>, under section <code>Misc-&gt;Serial</code>.</p>
<p><em>Note 4</em>: This patch is for PMIO support and is therefore not
applied if <code>UseMmio</code> under section
<code>Misc-&gt;Serial-&gt;Custom</code> is false. For MMIO, there are
boot arguments <code>pcie_mmio_uart=ADDRESS</code> and
<code>mmio_uart=ADDRESS</code> that allow the kernel to use MMIO for
serial port access.</p>
<p><em>Note 5</em>: The serial baud rate must be correctly set in both
<code>BaudRate</code> under section
<code>Misc-&gt;Serial-&gt;Custom</code> and via
<code>serialbaud=VALUE</code> boot argument, both of which should match
against each other. The default baud rate is
<code>115200</code>.</p></li>
<li><p><code>CustomSMBIOSGuid</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4<br />
<strong>Description</strong>: Performs GUID patching for
<code>UpdateSMBIOSMode</code> <code>Custom</code> mode. Usually relevant
for Dell laptops.</p></li>
<li><p><code>DisableIoMapper</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.8 (not required for older)<br />
<strong>Description</strong>: Disables <code>IOMapper</code> support in
XNU (VT-d), which may conflict with the firmware implementation.</p>
<p><em>Note 1</em>: This option is a preferred alternative to deleting
<code>DMAR</code> ACPI table and disabling VT-d in firmware preferences,
which does not obstruct VT-d support in other systems in case they need
this.</p>
<p><em>Note 2</em>: Misconfigured IOMMU in the firmware may result in
broken devices such as ethernet or Wi-Fi adapters. For instance, an
ethernet adapter may cycle in link-up link-down state infinitely and a
Wi-Fi adapter may fail to discover networks. Gigabyte is one of the most
common OEMs with these issues.</p></li>
<li><p><code>DisableIoMapperMapping</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 13.3 (not required for older)<br />
<strong>Description</strong>: Disables mapping PCI bridge device memory
in IOMMU (VT-d).</p>
<p>This option resolves compatibility issues with Wi-Fi, Ethernet and
Thunderbolt devices when AppleVTD is enabled on systems where the native
DMAR table contains one or more Reserved Memory Regions and more than 16
GB memory is installed. On some systems, this quirk is only needed when
iGPU is enabled.</p>
<p><em>Note 1</em>: This quirk requires a native DMAR table that does
not contain Reserved Memory Regions or a substitute SSDT-DMAR.aml in
which Reserved Memory Regions have been removed.</p>
<p><em>Note 2</em>: This option is not needed on AMD systems.</p></li>
<li><p><code>DisableLinkeditJettison</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 11<br />
<strong>Description</strong>: Disables <code>__LINKEDIT</code> jettison
code.</p>
<p>This option lets <code>Lilu.kext</code>, and possibly other kexts,
function in macOS Big Sur at their best performance levels without
requiring the <code>keepsyms=1</code> boot argument.</p></li>
<li><p><code>DisableRtcChecksum</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4<br />
<strong>Description</strong>: Disables primary checksum
(<code>0x58</code>-<code>0x59</code>) writing in AppleRTC.</p>
<p><em>Note 1</em>: This option will not protect other areas from being
overwritten, see <a
href="https://github.com/acidanthera/RTCMemoryFixup">RTCMemoryFixup</a>
kernel extension if this is desired.</p>
<p><em>Note 2</em>: This option will not protect areas from being
overwritten at firmware stage (e.g. macOS bootloader), see
<code>AppleRtcRam</code> protocol description if this is
desired.</p></li>
<li><p><code>ExtendBTFeatureFlags</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.8-11<br />
<strong>Description</strong>: Set <code>FeatureFlags</code> to
<code>0x0F</code> for full functionality of Bluetooth, including
Continuity.</p>
<p><em>Note</em>: This option is a substitution for
BT4LEContinuityFixup.kext, which does not function properly due to late
patching progress.</p></li>
<li><p><code>ExternalDiskIcons</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4<br />
<strong>Description</strong>: Apply icon type patches to
AppleAHCIPort.kext to force internal disk icons for all AHCI disks.</p>
<p><em>Note</em>: This option should be avoided whenever possible.
Modern firmware typically have compatible AHCI controllers.</p></li>
<li><p><code>ForceAquantiaEthernet</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.15.4<br />
<strong>Description</strong>: Enable Aquantia AQtion based 10GbE network
cards support.</p>
<p>This option enables Aquantia AQtion based 10GbE network cards
support, which used to work natively before macOS 10.15.4.</p>
<p><em>Note</em>: In order for Aquantia cards to properly function,
<code>DisableIoMapper</code> must be disabled, <code>DMAR</code> ACPI
table must not be dropped, and <code>VT-d</code> must be enabled in
BIOS.</p>
<p><em>Note 2</em>: While this patch should enable ethernet support for
all Aquantia AQtion series, it has only been tested on AQC-107s based
10GbE network cards.</p>
<p><em>Note 3</em>: To address <code>AppleVTD</code> incompatibilities
after applying this quirk, the <code>Reserved Memory Region</code>
section of the corresponding device in the <code>DMAR</code> ACPI table
might be removed. This table should be disassembled and edited, then
recompiled to <code>AML</code> with tool <code>iASL</code>. For the
patched <code>DMAR</code> table to be <a href="#acpipropsadd">added</a>,
the original one should be <a href="#acpipropsdelete">deleted</a>. More
details can be found at <a
href="https://github.com/acidanthera/OpenCorePkg/commit/24414555f2c07e06a3674ec7a2aa1ce4860bbcc7#commitcomment-70530145">comment
on commit 2441455</a>.</p></li>
<li><p><code>ForceSecureBootScheme</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 11<br />
<strong>Description</strong>: Force <code>x86</code> scheme for IMG4
verification.</p>
<p><em>Note</em>: This option is required on virtual machines when using
<code>SecureBootModel</code> different from
<code>x86legacy</code>.</p></li>
<li><p><code>IncreasePciBarSize</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.10<br />
<strong>Description</strong>: Allows IOPCIFamily to boot with 2 GB PCI
BARs.</p>
<p>Normally macOS restricts PCI BARs to 1 GB. Enabling this option
(still) does not let macOS actually use PCI devices with larger
BARs.</p>
<p><em>Note</em>: This option should be avoided whenever possible. A
need for this option indicates misconfigured or defective
firmware.</p></li>
<li><p><code>LapicKernelPanic</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.6 (64-bit)<br />
<strong>Description</strong>: Disables kernel panic on LAPIC
interrupts.</p></li>
<li><p><code>LegacyCommpage</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4 - 10.6<br />
<strong>Description</strong>: Replaces the default 64-bit commpage bcopy
implementation with one that does not require SSSE3, useful for legacy
platforms. This prevents a <code>commpage no match for last</code> panic
due to no available 64-bit bcopy functions that do not require
SSSE3.</p></li>
<li><p><code>PanicNoKextDump</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.13 (not required for older)<br />
<strong>Description</strong>: Prevent kernel from printing kext dump in
the panic log preventing from observing panic details. Affects 10.13 and
above.</p></li>
<li><p><code>PowerTimeoutKernelPanic</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.15 (not required for older)<br />
<strong>Description</strong>: Disables kernel panic on setPowerState
timeout.</p>
<p>An additional security measure was added to macOS Catalina (10.15)
causing kernel panic on power change timeout for Apple drivers.
Sometimes it may cause issues on misconfigured hardware, notably digital
audio, which sometimes fails to wake up. For debug kernels
<code>setpowerstate_panic=0</code> boot argument should be used, which
is otherwise equivalent to this quirk.</p></li>
<li><p><code>ProvideCurrentCpuInfo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.4 (10.14)<br />
<strong>Description</strong>: Provides current CPU info to the
kernel.</p>
<p>This quirk works differently depending on the CPU:</p>
<ul>
<li><p>For Microsoft Hyper-V it provides the correct TSC and FSB values
to the kernel, as well as disables CPU topology validation
(10.8+).</p></li>
<li><p>For KVM and other hypervisors it provides precomputed MSR 35h
values solving kernel panic with <code>-cpu host</code>.</p></li>
<li><p>For Intel CPUs it adds support for asymmetrical SMP systems (e.g.
Intel Alder Lake) by patching core count to thread count along with the
supplemental required changes (10.14+). Cache size and cache line size
are also provided when using 10.4 as Intel Penryn and newer may only
have cache information in CPUID leaf 0x4 which is unsupported by
10.4.</p></li>
</ul></li>
<li><p><code>SetApfsTrimTimeout</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Requirement</strong>: 10.14 (not required for older)<br />
<strong>Description</strong>: Set trim timeout in microseconds for APFS
filesystems on SSDs.</p>
<p>The APFS filesystem is designed in a way that the space controlled
via the spaceman structure is either used or free. This may be different
in other filesystems where the areas can be marked as used, free, and
<em>unmapped</em>. All free space is trimmed (unmapped/deallocated) at
macOS startup. The trimming procedure for NVMe drives happens in LBA
ranges due to the nature of the <code>DSM</code> command with up to 256
ranges per command. The more fragmented the memory on the drive is, the
more commands are necessary to trim all the free space.</p>
<p>Depending on the SSD controller and the level of drive fragmenation,
the trim procedure may take a considerable amount of time, causing
noticeable boot slowdown. The APFS driver explicitly ignores previously
unmapped areas and repeatedly trims them on boot. To mitigate against
such boot slowdowns, the macOS driver introduced a timeout
(<code>9.999999</code> seconds) that stops the trim operation when not
finished in time.</p>
<p>On several controllers, such as Samsung, where the deallocation
process is relatively slow, this timeout can be reached very quickly.
Essentially, it means that the level of fragmentation is high, thus
macOS will attempt to trim the same lower blocks that have previously
been deallocated, but never have enough time to deallocate higher
blocks. The outcome is that trimming on such SSDs will be non-functional
soon after installation, resulting in additional wear on the flash.</p>
<p>One way to workaround the problem is to increase the timeout to an
extremely high value, which at the cost of slow boot times (extra
minutes) will ensure that all the blocks are trimmed. Setting this
option to a high value, such as <code>4294967295</code> ensures that all
blocks are trimmed. Alternatively, use over-provisioning, if supported,
or create a dedicated unmapped partition where the reserve blocks can be
found by the controller. Conversely, the trim operation can be mostly
disabled by setting a very low timeout value, while <code>0</code>
entirely disables it. Refer to this <a
href="https://interface31.ru/tech_it/2015/04/mozhno-li-effektivno-ispolzovat-ssd-bez-podderzhki-trim.html">article</a>
for details.</p>
<p><em>Note</em>: The failsafe value <code>-1</code> indicates that this
patch will not be applied, such that <code>apfs.kext</code> will remain
untouched.</p>
<p><em>Note 2</em>: On macOS 12.0 and above, it is no longer possible to
specify trim timeout. However, trim can be disabled by setting
<code>0</code>.</p>
<p><em>Note 3</em>: Trim operations are <em>only</em> affected at
booting phase when the startup volume is mounted. Either specifying
timeout, or completely disabling trim with <code>0</code>, will not
affect normal macOS running.</p></li>
<li><p><code>ThirdPartyDrives</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.6 (not required for older)<br />
<strong>Description</strong>: Apply vendor patches to
IOAHCIBlockStorage.kext to enable native features for third-party
drives, such as TRIM on SSDs or hibernation support on 10.15 and
newer.</p>
<p><em>Note</em>: This option may be avoided on user preference. NVMe
SSDs are compatible without the change. For AHCI SSDs on modern macOS
version there is a dedicated built-in utility called
<code>trimforce</code>. Starting from 10.15 this utility creates
<code>EnableTRIM</code> variable in
<code>APPLE_BOOT_VARIABLE_GUID</code> namespace with
<code>01 00 00 00</code> value.</p></li>
<li><p><code>XhciPortLimit</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Requirement</strong>: 10.11+ (not required for older)<br />
<strong>Description</strong>: Patch various kexts (AppleUSBXHCI.kext,
AppleUSBXHCIPCI.kext, IOUSBHostFamily.kext) to remove USB port count
limit of 15 ports.</p>
<p><em>Note</em>: This option should be avoided whenever possible. USB
port limit is imposed by the amount of used bits in locationID format
and there is no possible way to workaround this without heavy OS
modification. The only valid solution is to limit the amount of used
ports to 15 (discarding some). More details can be found on <a
href="https://applelife.ru/posts/550233">AppleLife.ru</a>.</p></li>
</ol>
<h2 id="kernelpropsscheme">Scheme Properties</h2>
<p>These properties are particularly relevant for older macOS operating
systems. Refer to the <a href="#legacyapple">Legacy Apple OS</a> section
for details on how to install and troubleshoot such macOS
installations.</p>
<ol>
<li><p><code>CustomKernel</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use customised kernel cache from the
<code>Kernels</code> directory located at the root of the ESP
partition.</p>
<p>Unsupported platforms including <code>Atom</code> and
<code>AMD</code> require modified versions of XNU kernel in order to
boot. This option provides the possibility to using a customised kernel
cache which contains such modifications from ESP partition.</p></li>
<li><p><code>FuzzyMatch</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use <code>kernelcache</code> with
different checksums when available.</p>
<p>On Mac OS X 10.6 and earlier, <code>kernelcache</code> filename has a
checksum, which essentially is <code>adler32</code> from SMBIOS product
name and EfiBoot device path. On certain firmware, the EfiBoot device
path differs between UEFI and macOS due to ACPI or hardware specifics,
rendering <code>kernelcache</code> checksum as always different.</p>
<p>This setting allows matching the latest <code>kernelcache</code> with
a suitable architecture when the <code>kernelcache</code> without suffix
is unavailable, improving Mac OS X 10.6 boot performance on several
platforms.</p></li>
<li><p><code>KernelArch</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code> (Choose the preferred
architecture automatically)<br />
<strong>Description</strong>: Prefer specified kernel architecture
(<code>i386</code>, <code>i386-user32</code>, <code>x86_64</code>) when
available.</p>
<p>On Mac OS X 10.7 and earlier, the XNU kernel can boot with
architectures different from the usual <code>x86_64</code>. This setting
will use the specified architecture to boot macOS when it is supported
by the macOS and the configuration:</p>
<ul>
<li><p><code>i386</code> — Use <code>i386</code> (32-bit) kernel when
available.</p></li>
<li><p><code>i386-user32</code> — Use <code>i386</code> (32-bit) kernel
when available and force the use of 32-bit userspace on 64-bit capable
processors if supported by the operating system.</p>
<ul>
<li><p>On macOS, 64-bit capable processors are assumed to support
<code>SSSE3</code>. This is not the case for older 64-bit capable
Pentium processors, which cause some applications to crash on Mac OS
X 10.6. This behaviour corresponds to the <code>-legacy</code> kernel
boot argument.</p></li>
<li><p>This option is unavailable on Mac OS X 10.4 and 10.5 when running
on 64-bit firmware due to an uninitialised 64-bit segment in the XNU
kernel, which causes AppleEFIRuntime to incorrectly execute 64-bit code
as 16-bit code.</p></li>
</ul></li>
<li><p><code>x86_64</code> — Use <code>x86_64</code> (64-bit) kernel
when available.</p></li>
</ul>
<p>The algorithm used to determine the preferred kernel architecture is
set out below.</p>
<ol>
<li><p><code>arch</code> argument in image arguments (e.g. when launched
via UEFI Shell) or in <code>boot-args</code> variable overrides any
compatibility checks and forces the specified architecture, completing
this algorithm.</p></li>
<li><p>OpenCore build architecture restricts capabilities to
<code>i386</code> and <code>i386-user32</code> mode for the 32-bit
firmware variant.</p></li>
<li><p>Determined EfiBoot version restricts architecture choice:</p>
<ul>
<li><p>10.4-10.5 — <code>i386</code> or <code>i386-user32</code> (only
on 32-bit firmware)</p></li>
<li><p>10.6 — <code>i386</code>, <code>i386-user32</code>, or
<code>x86_64</code></p></li>
<li><p>10.7 — <code>i386</code> or <code>x86_64</code></p></li>
<li><p>10.8 or newer — <code>x86_64</code></p></li>
</ul></li>
<li><p>If <code>KernelArch</code> is set to <code>Auto</code> and
<code>SSSE3</code> is not supported by the CPU, capabilities are
restricted to <code>i386-user32</code> if supported by EfiBoot.</p></li>
<li><p>Board identifier (from SMBIOS) based on EfiBoot version disables
<code>x86_64</code> support on an unsupported model if any
<code>i386</code> variant is supported. <code>Auto</code> is not
consulted here as the list is not overridable in EfiBoot.</p></li>
<li><p><code>KernelArch</code> restricts the support to the explicitly
specified architecture (when not set to <code>Auto</code>) if the
architecture remains present in the capabilities.</p></li>
<li><p>The best supported architecture is chosen in this order:
<code>x86_64</code>, <code>i386</code>,
<code>i386-user32</code>.</p></li>
</ol>
<p>Unlike Mac OS X 10.7 (where certain board identifiers are treated as
<code>i386</code> only machines), and Mac OS X 10.5 or earlier (where
<code>x86_64</code> is not supported by the macOS kernel), Mac OS X 10.6
is very special. The architecture choice on Mac OS X 10.6 depends on
many factors including not only the board identifier, but also the macOS
product type (client vs server), macOS point release, and amount of RAM.
The detection of all these is complicated and impractical, as several
point releases had implementation flaws resulting in a failure to
properly execute the server detection in the first place. For this
reason when <code>Auto</code> is set, OpenCore on Mac OS X 10.6 falls
back to the <code>x86_64</code> architecture when it is supported by the
board, as on Mac OS X 10.7. The 32-bit <code>KernelArch</code> options
can still be configured explicitly however.</p>
<p>A 64-bit Mac model compatibility matrix corresponding to actual
EfiBoot behaviour on Mac OS X 10.6.8 and 10.7.5 is outlined below.</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Model</strong></th>
<th style="text-align: center;"><strong>10.6 (minimal)</strong></th>
<th style="text-align: center;"><strong>10.6 (client)</strong></th>
<th style="text-align: center;"><strong>10.6 (server)</strong></th>
<th style="text-align: center;"><strong>10.7 (any)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Macmini</td>
<td style="text-align: center;">4,x (Mid 2010)</td>
<td style="text-align: center;">5,x (Mid 2011)</td>
<td style="text-align: center;">4,x (Mid 2010)</td>
<td style="text-align: center;">3,x (Early 2009)</td>
</tr>
<tr>
<td style="text-align: left;">MacBook</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">5,x (2009/09)</td>
</tr>
<tr>
<td style="text-align: left;">MacBookAir</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">Unsupported</td>
<td style="text-align: center;">2,x (Late 2008)</td>
</tr>
<tr>
<td style="text-align: left;">MacBookPro</td>
<td style="text-align: center;">4,x (Early 2008)</td>
<td style="text-align: center;">8,x (Early 2011)</td>
<td style="text-align: center;">8,x (Early 2011)</td>
<td style="text-align: center;">3,x (Mid 2007)</td>
</tr>
<tr>
<td style="text-align: left;">iMac</td>
<td style="text-align: center;">8,x (Early 2008)</td>
<td style="text-align: center;">12,x (Mid 2011)</td>
<td style="text-align: center;">12,x (Mid 2011)</td>
<td style="text-align: center;">7,x (Mid 2007)</td>
</tr>
<tr>
<td style="text-align: left;">MacPro</td>
<td style="text-align: center;">3,x (Early 2008)</td>
<td style="text-align: center;">5,x (Mid 2010)</td>
<td style="text-align: center;">3,x (Early 2008)</td>
<td style="text-align: center;">3,x (Early 2008)</td>
</tr>
<tr>
<td style="text-align: left;">Xserve</td>
<td style="text-align: center;">2,x (Early 2008)</td>
<td style="text-align: center;">2,x (Early 2008)</td>
<td style="text-align: center;">2,x (Early 2008)</td>
<td style="text-align: center;">2,x (Early 2008)</td>
</tr>
</tbody>
</table>
</div>
<p><em>Note</em>: <code>3+2</code> and <code>6+4</code> hotkeys to
choose the preferred architecture are unsupported as they are handled by
EfiBoot and hence, difficult to detect.</p></li>
<li><p><code>KernelCache</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Prefer specified kernel cache type
(<code>Auto</code>, <code>Cacheless</code>, <code>Mkext</code>,
<code>Prelinked</code>) when available.</p>
<p>Different variants of macOS support different kernel caching variants
designed to improve boot performance. This setting prevents the use of
faster kernel caching variants if slower variants are available for
debugging and stability reasons. That is, by specifying
<code>Mkext</code>, <code>Prelinked</code> will be disabled for e.g.
10.6 but not for 10.7.</p>
<p>The list of available kernel caching types and its current support in
OpenCore is listed below.</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>macOS</strong></th>
<th style="text-align: center;"><strong>i386 NC</strong></th>
<th style="text-align: center;"><strong>i386 MK</strong></th>
<th style="text-align: center;"><strong>i386 PK</strong></th>
<th style="text-align: center;"><strong>x86_64 NC</strong></th>
<th style="text-align: center;"><strong>x86_64 MK</strong></th>
<th style="text-align: center;"><strong>x86_64 PK</strong></th>
<th style="text-align: center;"><strong>x86_64 KC</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">10.4</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES (V1)</td>
<td style="text-align: center;">NO (V1)</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">10.5</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES (V1)</td>
<td style="text-align: center;">NO (V1)</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">10.6</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES (V2)</td>
<td style="text-align: center;">YES (V2)</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES (V2)</td>
<td style="text-align: center;">YES (V2)</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">10.7</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES (V3)</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES (V3)</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">10.8-10.9</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES (V3)</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">10.10-10.15</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES (V3)</td>
<td style="text-align: center;">—</td>
</tr>
<tr>
<td style="text-align: left;">11+</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">YES (V3)</td>
<td style="text-align: center;">YES</td>
</tr>
</tbody>
</table>
</div>
<p><em>Note</em>: The first version (V1) of the 32-bit
<code>prelinkedkernel</code> is unsupported due to the corruption of
kext symbol tables by the tools. On this version, the <code>Auto</code>
setting will block <code>prelinkedkernel</code> booting. This also
results in the <code>keepsyms=1</code> boot argument being
non-functional for kext frames on these systems.</p></li>
</ol>
<h1 id="misc">Misc</h1>
<h2 id="miscintro">Introduction</h2>
<p>This section contains miscellaneous configuration options affecting
OpenCore operating system loading behaviour in addition to other options
that do not readily fit into other sections.</p>
<p>OpenCore broadly follows the “bless” model, also known as the “Apple
Boot Policy”. The primary purpose of the “bless” model is to allow
embedding boot options within the file system (and be accessible through
a specialised driver) as well as supporting a broader range of
predefined boot paths as compared to the removable media list set out in
the UEFI specification.</p>
<p>Partitions can only booted by OpenCore when they meet the
requirements of a predefined <code>Scan policy</code>. This policy sets
out which specific file systems a partition must have, and which
specific device types a partition must be located on, to be made
available by OpenCore as a boot option. Refer to the
<code>ScanPolicy</code> property for details.</p>
<p>The scan process starts with enumerating all available partitions,
filtered based on the <code>Scan policy</code>. Each partition may
generate multiple primary and alternate options. Primary options
represent operating systems installed on the media, while alternate
options represent recovery options for the operating systems on the
media.</p>
<ul>
<li><p>Alternate options may exist without primary options and vice
versa.</p></li>
<li><p>Options may not necessarily represent operating systems on the
same partition.</p></li>
<li><p>Each primary and alternate option can be an auxiliary option or
not.</p>
<ul>
<li><p>Refer to the <code>HideAuxiliary</code> section for
details.</p></li>
</ul></li>
</ul>
<h3 id="bootalgorithm">Boot Algorithm</h3>
<p>The algorithm to determine boot options behaves as follows:</p>
<ol>
<li><p>Obtain all available partition handles filtered based on the
<code>Scan policy</code> (and driver availability).</p></li>
<li><p>Obtain all available boot options from the <code>BootOrder</code>
UEFI variable.</p></li>
<li><p>For each boot option found:</p>
<ul>
<li><p>Retrieve the device path of the boot option.</p></li>
<li><p>Perform fixups (e.g. NVMe subtype correction) and expansion (e.g.
for Boot Camp) of the device path.</p></li>
<li><p>On failure, if it is an OpenCore custom entry device path,
pre-construct the corresponding custom entry and succeed.</p></li>
<li><p>Obtain the device handle by locating the device path of the
resulting device path (ignore it on failure).</p></li>
<li><p>Locate the device handle in the list of partition handles (ignore
it if missing).</p></li>
<li><p>For disk device paths (not specifying a bootloader), execute
“bless” (may return &gt; 1 entry).</p></li>
<li><p>For file device paths, check for presence on the file system
directly.</p></li>
<li><p>Exclude entries if there is a <code>.contentVisibility</code>
file at a relevant location (see below) with <code>Disabled</code>
contents (ASCII) (and if the current <code>InstanceIentifier</code>
matches an <code>Instance-List</code> if present, see below).</p></li>
<li><p>Mark device handle as <em>used</em> in the list of partition
handles if any.</p></li>
<li><p>Register the resulting entries as primary options and determine
their types.<br />
The option will become auxiliary for some types (e.g. Apple HFS
recovery) or if its <code>.contentVisibility</code> file contains
<code>Auxiliary</code> (and if the current
<code>InstanceIentifier</code> matches an <code>Instance-List</code> if
present, see below).</p></li>
</ul></li>
<li><p>For each partition handle:</p>
<ul>
<li><p>If the partition handle is marked as <em>unused</em>, execute
“bless” primary option list retrieval.<br />
In case a <code>BlessOverride</code> list is set, both standard and
custom “bless” paths will be found.</p></li>
<li><p>On the OpenCore boot partition, exclude OpenCore bootstrap files
using header checks.</p></li>
<li><p>Register the resulting entries as primary options and determine
their types if found.<br />
The option will become auxiliary for some types (e.g. Apple HFS
recovery).</p></li>
<li><p>If a partition already has any primary options of the “Apple
Recovery” type, proceed to the next handle.</p></li>
<li><p>Lookup alternate entries by “bless” recovery option list
retrieval and predefined paths.</p></li>
<li><p>Register the resulting entries as alternate auxiliary options and
determine their types if found.</p></li>
</ul></li>
<li><p>Custom entries and tools, except such pre-constructed previously,
are added as primary options without any checks with respect to
<code>Auxiliary</code>.</p></li>
<li><p>System entries, such as <code>Reset NVRAM</code>, are added as
primary auxiliary options.</p></li>
</ol>
<p>A <code>.contentVisibility</code> file may be placed next to the
bootloader (such as <code>boot.efi</code>), or in the boot folder (for
DMG folder based boot items). Example locations, as seen from within
macOS, are:</p>
<ul>
<li><p><code>/System/Volumes/Preboot/{GUID}/System/Library/CoreServices/.contentVisibility</code></p></li>
<li><p><code>/Volumes/{ESP}/EFI/BOOT/.contentVisibility</code></p></li>
</ul>
<p>In addition a <code>.contentVisibility</code> file may be placed in
the instance-specific (for macOS) or absolute root folders related to a
boot entry, for example:</p>
<ul>
<li><p><code>/System/Volumes/Preboot/{GUID}/.contentVisibility</code></p></li>
<li><p><code>/System/Volumes/Preboot/.contentVisibility</code></p></li>
<li><p><code>/Volumes/{ESP}/.contentVisibility</code> (<em>not
recommended</em>)</p></li>
</ul>
<p>These root folder locations are supported specifically for macOS,
because non-Apple files next to the Apple bootloader are removed by
macOS updates. It is supported but not recommended to place a
<code>.contentVisibility</code> file in a non-macOS root location (such
as the last location shown above), because it will hide all entries on
the drive.</p>
<p>The <code>.contentVisibility</code> file, when present, may
optionally target only specific instances of OpenCore. Its contents are
<code>[{Instance-List}:](Disabled|Auxiliary)</code>. If a colon
(<code>:</code>) is present, the preceding <code>Instance-List</code> it
is a comma separated list of <code>InstanceIdentifier</code> values
(example: <code>OCA,OCB:Disabled</code>). When this list is present, the
specified visibility is only applied if the
<code>InstanceIdentifier</code> of the current instance of OpenCore is
present in the list. When the list is not present, the specified
visibility is applied for all instances of OpenCore.</p>
<p><em>Note 1</em>: For any instance of OpenCore with no
<code>InstanceIdentifier</code> value, the specified visibility from a
<code>.contentVisibility</code> file with an <code>Instance-List</code>
will never be applied.</p>
<p><em>Note 2</em>: Visibilities with a visibility list will be treated
as invalid, and so ignored, in earlier versions of OpenCore - which may
be useful when comparing behaviour of older and newer versions.</p>
<p><em>Note 3</em>: Avoid extraneous spaces in the
<code>.contentVisibility</code> file: these will not be treated as
whitespace, but as part of the adjacent token.</p>
<p>The display order of the boot options in the OpenCore picker and the
boot process are determined separately from the scanning algorithm.</p>
<p>The display order is as follows:</p>
<ul>
<li><p>Alternate options follow corresponding primary options. That is,
Apple recovery options will follow the relevant macOS option whenever
possible.</p></li>
<li><p>Options will be listed in file system handle firmware order to
maintain an established order across reboots regardless of the operating
system chosen for loading.</p></li>
<li><p>Custom entries, tools, and system entries will be added after all
other options.</p></li>
<li><p>Auxiliary options will only be displayed upon entering “Extended
Mode” in the OpenCore picker (typically by pressing the
<code>Space</code> key).</p></li>
</ul>
<p>The boot process is as follows:</p>
<ul>
<li><p>Look up the first valid primary option in the
<code>BootNext</code> UEFI variable.</p></li>
<li><p>On failure, look up the first valid primary option in the
<code>BootOrder</code> UEFI variable.</p></li>
<li><p>Mark the option as the default option to boot.</p></li>
<li><p>Boot option through the picker or without it depending on the
<code>ShowPicker</code> option.</p></li>
<li><p>Show picker on failure otherwise.</p></li>
</ul>
<p><em>Note 1</em>: This process will only work reliably when the
<code>RequestBootVarRouting</code> option is enabled or the firmware
does not control UEFI boot options (<code>OpenDuetPkg</code> or custom
BDS). When <code>LauncherOption</code> is not enabled, other operating
systems may overwrite OpenCore settings and this property should
therefore be enabled when planning to use other operating systems.</p>
<p><em>Note 2</em>: UEFI variable boot options boot arguments will be
removed, if present, as they may contain arguments that can compromise
the operating system, which is undesirable when secure boot is
enabled.</p>
<p><em>Note 3</em>: Some operating systems, such as Windows, may create
a boot option and mark it as the topmost option upon first boot or after
NVRAM resets from within OpenCore. When this happens, the default boot
entry choice will remain changed until the next manual
reconfiguration.</p>
<h2 id="miscprops">Properties</h2>
<ol>
<li><p><code>BlessOverride</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Add custom scanning paths through the
bless model.</p>
<p>To be filled with <code>plist string</code> entries containing
absolute UEFI paths to customised bootloaders such as
<code>\EFI\debian\grubx64.efi</code> for the Debian bootloader. This
allows non-standard boot paths to be automatically discovered by the
OpenCore picker. Designwise, they are equivalent to predefined blessed
paths, such as <code>\System\Library\CoreServices\boot.efi</code> or
<code>\EFI\Microsoft\Boot\bootmgfw.efi</code>, but unlike predefined
bless paths, they have the highest priority.</p></li>
<li><p><code>Boot</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply the boot configuration described in
the <a href="#miscbootprops">Boot Properties</a> section below.</p></li>
<li><p><code>Debug</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply debug configuration described in the
<a href="#miscdebugprops">Debug Properties</a> section below.</p></li>
<li><p><code>Entries</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Add boot entries to OpenCore picker.</p>
<p>To be filled with <code>plist dict</code> values, describing each
load entry. Refer to the <a href="#miscentryprops">Entry Properties</a>
section below for details.</p></li>
<li><p><code>Security</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply the security configuration described
in the <a href="#miscsecurityprops">Security Properties</a> section
below.</p></li>
<li><p><code>Serial</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Perform serial port initialisation and
configure PCD values required by <code>BaseSerialPortLib16550</code> for
serial ports to properly function. Values are listed and described in
the <a href="#miscserialprops">Serial Properties</a> and <a
href="#miscserialcustprops">Serial Custom Properties</a> section
below.</p>
<p>By enabling <code>Init</code>, this section ensures that the serial
port is initialised when it is not done by firmware. In order for
OpenCore to print logs to the serial port, bit <code>3</code> (i.e.
serial logging) for <code>Target</code> under section
<code>Misc-&gt;Debug</code> must be set.</p>
<p>When debugging with serial ports, <code>BaseSerialPortLib16550</code>
only recognises internal ones provided by the motherboard by default. If
the option <code>Override</code> is enabled, this section will override
the PCD values listed in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/Library/BaseSerialPortLib16550/BaseSerialPortLib16550.inf">BaseSerialPortLib16550.inf</a>
such that external serial ports (e.g. from a PCI card) will also
function properly. Specifically, when troubleshooting macOS, in addition
to overriding these PCD values, it is also necessary to turn the
<code>CustomPciSerialDevice</code> kernel quirk on in order for the XNU
to use such exterior serial ports.</p>
<p>Refer to <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>
for the explanations of each key.</p></li>
<li><p><code>Tools</code><span id="misctools"
data-label="misctools"></span><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Add tool entries to the OpenCore
picker.</p>
<p>To be filled with <code>plist dict</code> values, describing each
load entry. Refer to the <a href="#miscentryprops">Entry Properties</a>
section below for details.</p>
<p><em>Note</em>: Certain UEFI tools, such as UEFI Shell, can be very
dangerous and <strong>MUST NOT</strong> appear in production
configurations, paticularly in vaulted configurations as well as those
protected by secure boot, as such tools can be used to bypass the secure
boot chain. Refer to the <a href="#uefitools">UEFI</a> section for
examples of UEFI tools.</p></li>
</ol>
<h2 id="miscbootprops">Boot Properties</h2>
<ol>
<li><p><code>ConsoleAttributes</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Sets specific attributes for the
console.</p>
<p>The text renderer supports colour arguments as a sum of foreground
and background colours based on the UEFI specification. The value for
black background and for black foreground, <code>0</code>, is
reserved.</p>
<p>List of colour values and names:</p>
<ul>
<li><p><code>0x00</code> — <code>EFI_BLACK</code></p></li>
<li><p><code>0x01</code> — <code>EFI_BLUE</code></p></li>
<li><p><code>0x02</code> — <code>EFI_GREEN</code></p></li>
<li><p><code>0x03</code> — <code>EFI_CYAN</code></p></li>
<li><p><code>0x04</code> — <code>EFI_RED</code></p></li>
<li><p><code>0x05</code> — <code>EFI_MAGENTA</code></p></li>
<li><p><code>0x06</code> — <code>EFI_BROWN</code></p></li>
<li><p><code>0x07</code> — <code>EFI_LIGHTGRAY</code></p></li>
<li><p><code>0x08</code> — <code>EFI_DARKGRAY</code></p></li>
<li><p><code>0x09</code> — <code>EFI_LIGHTBLUE</code></p></li>
<li><p><code>0x0A</code> — <code>EFI_LIGHTGREEN</code></p></li>
<li><p><code>0x0B</code> — <code>EFI_LIGHTCYAN</code></p></li>
<li><p><code>0x0C</code> — <code>EFI_LIGHTRED</code></p></li>
<li><p><code>0x0D</code> — <code>EFI_LIGHTMAGENTA</code></p></li>
<li><p><code>0x0E</code> — <code>EFI_YELLOW</code></p></li>
<li><p><code>0x0F</code> — <code>EFI_WHITE</code></p></li>
<li><p><code>0x00</code> — <code>EFI_BACKGROUND_BLACK</code></p></li>
<li><p><code>0x10</code> — <code>EFI_BACKGROUND_BLUE</code></p></li>
<li><p><code>0x20</code> — <code>EFI_BACKGROUND_GREEN</code></p></li>
<li><p><code>0x30</code> — <code>EFI_BACKGROUND_CYAN</code></p></li>
<li><p><code>0x40</code> — <code>EFI_BACKGROUND_RED</code></p></li>
<li><p><code>0x50</code> — <code>EFI_BACKGROUND_MAGENTA</code></p></li>
<li><p><code>0x60</code> — <code>EFI_BACKGROUND_BROWN</code></p></li>
<li><p><code>0x70</code> —
<code>EFI_BACKGROUND_LIGHTGRAY</code></p></li>
</ul>
<p><em>Note</em>: This option may not work well with the
<code>System</code> text renderer. Setting a background different from
black could help with testing GOP functionality.</p></li>
<li><p><code>HibernateMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>None</code><br />
<strong>Description</strong>: Hibernation detection mode. The following
modes are supported:</p>
<ul>
<li><p><code>None</code> — Ignore hibernation state.</p></li>
<li><p><code>Auto</code> — Use RTC and NVRAM detection.</p></li>
<li><p><code>RTC</code> — Use RTC detection.</p></li>
<li><p><code>NVRAM</code> — Use NVRAM detection.</p></li>
</ul>
<p><em>Note</em>: If the firmware can handle hibernation itself (valid
for Mac EFI firmware), then <code>None</code> should be specified to
hand-off hibernation state as is to OpenCore.</p></li>
<li><p><code>HibernateSkipsPicker</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Do not show picker if waking from macOS
hibernation.</p>
<p>Limitations:</p>
<ul>
<li><p>Only supports macOS hibernation wake, Windows and Linux are
currently out of scope.</p></li>
<li><p>Should only be used on systems with reliable hibernation wake in
macOS, otherwise users may not be able to visually see boot loops that
may occur.</p></li>
<li><p>Highly recommended to pair this option with
<code>PollAppleHotKeys</code>, allows to enter picker in case of issues
with hibernation wake.</p></li>
<li><p>Visual indication for hibernation wake is currently out of
scope.</p></li>
</ul></li>
<li><p><code>HideAuxiliary</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to hide auxiliary
entries from the picker menu.</p>
<p>An entry is considered auxiliary when at least one of the following
applies:</p>
<ul>
<li><p>Entry is macOS recovery.</p></li>
<li><p>Entry is macOS Time Machine.</p></li>
<li><p>Entry is explicitly marked as <code>Auxiliary</code>.</p></li>
<li><p>Entry is system (e.g. <code>Reset NVRAM</code>).</p></li>
</ul>
<p>To display all entries, the picker menu can be reloaded into
“Extended Mode” by pressing the <code>Spacebar</code> key. Hiding
auxiliary entries may increase boot performance on multi-disk
systems.</p></li>
<li><p><code>InstanceIdentifier</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: An optional identifier for the current
instance of OpenCore.</p>
<p>This should typically be a short alphanumeric string. The current use
of this value is to optionally target <code>.contentVisibility</code>
files to specific instances of OpenCore, as explained in the <a
href="#bootalgorithm">Boot Algorithm</a> section.</p></li>
<li><p><code>LauncherOption</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Disabled</code><br />
<strong>Description</strong>: Register the launcher option in the
firmware preferences for persistence.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Disabled</code> — do nothing.</p></li>
<li><p><code>Full</code> — create or update the top priority boot option
in UEFI variable storage at bootloader startup.</p>
<ul>
<li><p>For this option to work, <code>RequestBootVarRouting</code> is
required to be enabled.</p></li>
</ul></li>
<li><p><code>Short</code> — create a short boot option instead of a
complete one.</p>
<ul>
<li><p>This variant is useful for some older types of firmware,
typically from Insyde, that are unable to manage full device
paths.</p></li>
</ul></li>
<li><p><code>System</code> — create no boot option but assume specified
custom option is blessed.</p>
<ul>
<li><p>This variant is useful when relying on
<code>ForceBooterSignature</code> quirk and OpenCore launcher path
management happens through <code>bless</code> utilities without
involving OpenCore.</p></li>
</ul></li>
</ul>
<p>This option allows integration with third-party operating system
installation and upgrades (which may overwrite the
<code>\EFI\BOOT\BOOTx64.efi</code> file). The BOOTx64.efi file is no
longer used for bootstrapping OpenCore if a custom option is created.
The custom path used for bootstrapping can be specified by using the
<code>LauncherPath</code> option.</p>
<p><em>Note 1</em>: Some types of firmware may have NVRAM implementation
flaws, no boot option support, or other incompatibilities. While
unlikely, the use of this option may result in boot failures and should
only be used exclusively on boards known to be compatible. Refer to <a
href="https://github.com/acidanthera/bugtracker/issues/1222">acidanthera/bugtracker#1222</a>
for some known issues affecting Haswell and other boards.</p>
<p><em>Note 2</em>: While NVRAM resets executed from OpenCore would not
typically erase the boot option created in <code>Bootstrap</code>,
executing NVRAM resets prior to loading OpenCore will erase the boot
option. Therefore, for significant implementation updates, such as was
the case with OpenCore 0.6.4, an NVRAM reset should be executed with
<code>Bootstrap</code> disabled, after which it can be re-enabled.</p>
<p><em>Note 3</em>: Some versions of Intel Visual BIOS (e.g. on Intel
NUC) have an unfortunate bug whereby if any boot option is added
referring to a path on a USB drive, from then on that is the only boot
option which will be shown when any USB drive is inserted. If OpenCore
is started from a USB drive on this firmware with
<code>LauncherOption</code> set to <code>Full</code> or
<code>Short</code>, this applies and only the OpenCore boot entry will
be seen afterwards, when any other USB is inserted (this highly
non-standard BIOS behaviour affects other software as well). The best
way to avoid this is to leave <code>LauncherOption</code> set to
<code>Disabled</code> or <code>System</code> on any version of OpenCore
which will be started from a USB drive on this firmware. If the problem
has already occurred the quickest reliable fix is:</p>
<ul>
<li><p>Enable the system UEFI Shell in Intel Visual BIOS</p></li>
<li><p>With power off, insert an OpenCore USB</p></li>
<li><p>Power up and select the system UEFI Shell</p></li>
<li><p>Since the system shell does not include <code>bcfg</code>, use
the system shell to start OpenCore’s OpenShell (e.g. by entering the
command <code>FS2:\EFI\OC\Tools\OpenShell.efi</code> , but you will need
to work out which drive is correct for OpenCore and modify the drive
number <code>FS#:</code> accordingly)</p></li>
<li><p>Within OpenShell, use <code>bcfg boot dump</code> to display the
NVRAM boot options and then use <code>bcfg boot rm #</code> (where
<code>#</code> is the number of the OpenCore boot entry) to remove the
OpenCore entry</p></li>
</ul>
<p>It is alternatively possible to start OpenShell directly from the
OpenCore boot menu, if you have a working configured OpenCore for the
system. In that case, and if OpenCore has
<code>RequestBootVarRouting</code> enabled, it will be necessary to run
the command <code>\EFI\OC\Tools\OpenControl.efi disable</code> before
using <code>bcfg</code>. (After <code>OpenControl disable</code>, it is
necessary to either reboot or run <code>OpenControl restore</code>,
before booting an operating system.) It is also possible to use
<code>efibootmgr</code> within Linux to remove the offending entry, if
you have a working version of Linux on the machine. Linux must be
started either not via OpenCore, or via OpenCore with
<code>RequestBootVarRouting</code> disabled for this to work.</p></li>
<li><p><code>LauncherPath</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Default</code><br />
<strong>Description</strong>: Launch path for the
<code>LauncherOption</code> property.</p>
<p><code>Default</code> points to <code>OpenCore.efi</code>. User
specified paths, e.g. <code>\EFI\SomeLauncher.efi</code>, can be used to
provide custom loaders, which are supposed to load
<code>OpenCore.efi</code> themselves.</p></li>
<li><p><code>PickerAttributes</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Sets specific attributes for the OpenCore
picker.</p>
<p>Different OpenCore pickers may be configured through the attribute
mask containing OpenCore-reserved (<code>BIT0</code>~<code>BIT15</code>)
and OEM-specific (<code>BIT16</code>~<code>BIT31</code>) values.</p>
<p>Current OpenCore values include:</p>
<ul>
<li><p><code>0x0001</code> — <code>OC_ATTR_USE_VOLUME_ICON</code>,
provides custom icons for boot entries:</p>
<p>OpenCore will attempt loading a volume icon by searching as follows,
and will fallback to the default icon on failure:</p>
<ul>
<li><p><code>.VolumeIcon.icns</code> file at <code>Preboot</code> volume
in per-volume directory (<code>/System/Volumes/Preboot/{GUID}/</code>
when mounted at the default location within macOS) for APFS (if
present).</p></li>
<li><p><code>.VolumeIcon.icns</code> file at the <code>Preboot</code>
volume root (<code>/System/Volumes/Preboot/</code>, when mounted at the
default location within macOS) for APFS (otherwise).</p></li>
<li><p><code>.VolumeIcon.icns</code> file at the volume root for other
filesystems.</p></li>
</ul>
<p><em>Note 1</em>: The Apple picker partially supports placing a volume
icon file at the operating system’s <code>Data</code> volume root,
<code>/System/Volumes/Data/</code>, when mounted at the default location
within macOS. This approach is flawed: the file is neither accessible to
OpenCanopy nor to the Apple picker when FileVault 2, which is meant to
be the default choice, is enabled. Therefore, OpenCanopy does not
attempt supporting Apple’s approach. A volume icon file may be placed at
the root of the <code>Preboot</code> volume for compatibility with both
OpenCanopy and the Apple picker, or use the <code>Preboot</code>
per-volume location as above with OpenCanopy as a preferred alternative
to Apple’s approach.</p>
<p><em>Note 2</em>: Be aware that using a volume icon on any drive
overrides the normal OpenCore picker behaviour for that drive of
selecting the appropriate icon depending on whether the drive is
internal or external.</p></li>
<li><p><code>0x0002</code> — <code>OC_ATTR_USE_DISK_LABEL_FILE</code>,
use custom prerendered titles for boot entries from
<code>.disk_label</code> (<code>.disk_label_2x</code>) file next to the
bootloader for all filesystems. These labels can be generated via the
<code>disklabel</code> utility or the
<code>bless --folder {FOLDER_PATH} --label {LABEL_TEXT}</code> command.
When prerendered labels are disabled or missing, use label text in
<code>.contentDetails</code> (or
<code>.disk_label.contentDetails</code>) file next to bootloader if
present instead, otherwise the entry name itself will be
rendered.</p></li>
<li><p><code>0x0004</code> —
<code>OC_ATTR_USE_GENERIC_LABEL_IMAGE</code>, provides predefined label
images for boot entries without custom entries. This may however give
less detail for the actual boot entry.</p></li>
<li><p><code>0x0008</code> — <code>OC_ATTR_HIDE_THEMED_ICONS</code>,
prefers builtin icons for certain icon categories to match the theme
style. For example, this could force displaying the builtin Time Machine
icon. Requires <code>OC_ATTR_USE_VOLUME_ICON</code>.</p></li>
<li><p><code>0x0010</code> — <code>OC_ATTR_USE_POINTER_CONTROL</code>,
enables pointer control in the OpenCore picker when available. For
example, this could make use of mouse or trackpad to control UI
elements.</p></li>
<li><p><code>0x0020</code> — <code>OC_ATTR_SHOW_DEBUG_DISPLAY</code>,
enable display of additional timing and debug information, in Builtin
picker in <code>DEBUG</code> and <code>NOOPT</code> builds
only.</p></li>
<li><p><code>0x0040</code> — <code>OC_ATTR_USE_MINIMAL_UI</code>, use
minimal UI display, no Shutdown or Restart buttons, affects OpenCanopy
and builtin picker.</p></li>
<li><p><code>0x0080</code> — <code>OC_ATTR_USE_FLAVOUR_ICON</code><span
id="oc-attr-use-flavour-icon"
data-label="oc-attr-use-flavour-icon"></span>, provides flexible boot
entry content description, suitable for picking the best media across
different content sets:</p>
<p>When enabled, the entry icon in OpenCanopy and the audio assist entry
sound in OpenCanopy and builtin boot picker are chosen by something
called content flavour. To determine content flavour the following
algorithm is used:</p>
<ul>
<li><p>For a Tool the value is read from <code>Flavour</code>
field.</p></li>
<li><p>For an automatically discovered entry, including for boot entry
protocol entries such as those generated by the OpenLinuxBoot driver, it
is read from the <code>.contentFlavour</code> file next to the
bootloader, if present.</p></li>
<li><p>For a custom entry specified in the <code>Entries</code> section
it is read from the <code>.contentFlavour</code> file next to the
bootloader if <code>Flavour</code> is <code>Auto</code>, otherwise it is
specified via the <code>Flavour</code> value itself.</p></li>
<li><p>If read flavour is <code>Auto</code> or there is no
<code>.contentFlavour</code>, entry flavour is chosen based on the entry
type (e.g. Windows automatically gets Windows flavour).</p></li>
</ul>
<p>The Flavour value is a sequence of <code>:</code> separated names
limited to 64 characters of printable 7-bit ASCII. This is designed to
support up to approximately five names. Each name refers to a flavour,
with the first name having the highest priority and the last name having
the lowest priority. Such a structure allows describing an entry in a
more specific way, with icons selected flexibly depending on support by
the audio-visual pack. A missing audio or icon file means the next
flavour should be tried, and if all are missing the choice happens based
on the type of the entry. Example flavour values:
<code>BigSur:Apple</code>, <code>Windows10:Windows</code>.
<code>OpenShell:UEFIShell:Shell</code>.</p>
<p>Using flavours means that you can switch between icon sets easily,
with the flavour selecting the best available icons from each set. E.g.
specifying icon flavour <code>Debian:Linux</code> will use the icon
<code>Debian.icns</code> if provided, then will try
<code>Linux.icns</code>, then will fall back to the default for an OS,
which is <code>HardDrive.icns</code>.</p>
<p>Things to keep in mind:</p>
<ul>
<li><p>For security reasons <code>Ext&lt;Flavour&gt;.icns</code> and
<code>&lt;Flavour&gt;.icns</code> are both supported, and only
<code>Ext&lt;Flavour&gt;.icns</code> will be used if the entry is on an
external drive (followed by default fallback
<code>ExtHardDrive.icns</code>).</p></li>
<li><p>Where both apply <code>.VolumeIcon.icns</code> takes precence
over <code>.contentFlavour</code>.</p></li>
<li><p>In order to allow icons and audio assist to work correctly for
tools (e.g. for UEFI Shell), system default boot entry icons (see
<code>Docs/Flavours.md</code>) specified in the <code>Flavour</code>
setting for <code>Tools</code> or <code>Entries</code> will continue to
apply even when flavour is disabled. Non-system icons will be ignored in
this case. In addition, the flavours <code>UEFIShell</code> and
<code>NVRAMReset</code> are given special processing, identifying their
respective tools to apply correct audio-assist, default builtin labels,
etc.</p></li>
<li><p>A list of recommended flavours is provided in
<code>Docs/Flavours.md</code>.</p></li>
</ul></li>
<li><p><code>0x0100</code> — <code>OC_ATTR_USE_REVERSED_UI</code>,
reverse position of Shutdown and Restart buttons, affects OpenCanopy and
builtin picker. The reversed setting matches older macOS, and since it
was the previous default in OpenCore it may better match some custom
backgrounds. Only applicable when <code>OC_ATTR_USE_MINIMAL_UI</code> is
not set.</p></li>
<li><p><code>0x0200</code> — <code>OC_ATTR_REDUCE_MOTION</code>, reduce
password and menu animation in <code>OpenCanopy</code>, leaving only
animations which communicate information not otherwise provided.</p>
<p><em>Note</em>: These same animations, plus additional animations
whose information is provided by voice-over, are automatically disabled
when <code>PickerAudioAssist</code> is enabled.</p></li>
</ul></li>
<li><p><code>PickerAudioAssist</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable screen reader by default in the
OpenCore picker.</p>
<p>For the macOS bootloader, screen reader preference is set in the
<code>preferences.efires</code> archive in the
<code>isVOEnabled.int32</code> file and is controlled by the operating
system. For OpenCore screen reader support, this option is an
independent equivalent. Toggling screen reader support in both the
OpenCore picker and the macOS bootloader FileVault 2 login window can
also be done by using the <code>Command</code> + <code>F5</code> key
combination.</p>
<p><em>Note</em>: The screen reader requires working audio support.
Refer to the <a
href="#uefiaudioprops"><code>UEFI Audio Properties</code></a> section
for details.</p></li>
<li><p><code>PickerMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Builtin</code><br />
<strong>Description</strong>: Choose picker used for boot
management.</p>
<p><code>PickerMode</code> describes the underlying boot management with
an optional user interface responsible for handling boot options.</p>
<p>The following values are supported:</p>
<ul>
<li><p><code>Builtin</code> — boot management is handled by OpenCore, a
simple text-only user interface is used.</p></li>
<li><p><code>External</code> — an external boot management protocol is
used if available. Otherwise, the <code>Builtin</code> mode is
used.</p></li>
<li><p><code>Apple</code> — Apple boot management is used if available.
Otherwise, the <code>Builtin</code> mode is used.</p></li>
</ul>
<p>Upon success, the <code>External</code> mode may entirely disable all
boot management in OpenCore except for policy enforcement. In the
<code>Apple</code> mode, it may additionally bypass policy enforcement.
Refer to the <a href="#ueficanopy">OpenCanopy</a> plugin for an example
of a custom user interface.</p>
<p>The OpenCore built-in picker contains a set of actions chosen during
the boot process. The list of supported actions is similar to Apple BDS
and typically can be accessed by holding <code>action hotkeys</code>
during the boot process.</p>
<p>The following actions are currently considered:</p>
<ul>
<li><p><code>Default</code> — this is the default option, and it lets
the built-in OpenCore picker load the default boot option as specified
in the <a href="https://support.apple.com/HT202796">Startup Disk</a>
preference pane.</p></li>
<li><p><code>ShowPicker</code> — this option forces the OpenCore picker
to be displayed. This can typically be achieved by holding the
<code>OPT</code> key during boot. Setting <code>ShowPicker</code> to
<code>true</code> will make <code>ShowPicker</code> the default
option.</p></li>
<li><p><code>BootApple</code> — this options performs booting to the
first Apple operating system found unless the chosen default operating
system is one from Apple. Hold the <code>X</code> key down to choose
this option.</p></li>
<li><p><code>BootAppleRecovery</code> — this option performs booting
into the Apple operating system recovery partition. This is either that
related to the default chosen operating system, or first one found when
the chosen default operating system is not from Apple or does not have a
recovery partition. Hold the <code>CMD+R</code> hotkey combination down
to choose this option.</p></li>
</ul>
<p><em>Note 1</em>: On non-Apple firmware <code>KeySupport</code>,
<code>OpenUsbKbDxe</code>, or similar drivers are required for key
handling. However, not all of the key handling functions can be
implemented on several types of firmware.</p>
<p><em>Note 2</em>: In addition to <code>OPT</code>, OpenCore supports
using both the <code>Escape</code> and <code>Zero</code> keys to enter
the OpenCore picker when <code>ShowPicker</code> is disabled.
<code>Escape</code> exists to support co-existence with the Apple picker
(including OpenCore <code>Apple</code> picker mode) and to support
firmware that fails to report held <code>OPT</code> key, as on some PS/2
keyboards. In addition, <code>Zero</code> is provided to support systems
on which <code>Escape</code> is already assigned to some other pre-boot
firmware feature. In systems which do not require
<code>KeySupport</code>, pressing and holding one of these keys from
after power on until the picker appears should always be successful. The
same should apply when using <code>KeySupport</code> mode if it is
correctly configured for the system, i.e. with a long enough
<code>KeyForgetThreshold</code>. If pressing and holding the key is not
successful to reliably enter the picker, multiple repeated keypresses
may be tried instead.</p>
<p><em>Note 3</em>: On Macs with problematic GOP, it may be difficult to
re-bless OpenCore if its bless status is lost. The
<code>BootKicker</code> utility can be used to work around this problem,
if set up as a Tool in OpenCore with <code>FullNvramAccess</code>
enabled. It will launch the Apple picker, which allows selection of an
item to boot next (with <code>Enter</code>), or next and from then on
until the next change (with <code>CTRL+Enter</code>). Note that after
the selection is made, the system <em>will reboot</em> before the chosen
entry is booted. While this behaviour might seem surprising, it can be
used both to switch which OpenCore installation is blessed, with
<code>CTRL+Enter</code>, e.g. from a recovery OpenCore installation on
CD (selected with the <code>C</code> key on boot) back to the main
installion of OpenCore on the hard drive, if this is lost after an NVRAM
reset. It can also be used, even when the native picker cannot be shown
normally (unsupported GPU), to do a one-shot boot without OpenCore, e.g.
to another OS or tool, or to an earlier version of macOS.</p></li>
<li><p><code>PickerVariant</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Choose specific icon set to be used for
boot management.</p>
<p>An icon set is a directory path relative to
<code>Resources\Image</code>, where the icons and an optional manifest
are located. It is recommended for the artists to use provide their sets
in the <code>Vendor\Set</code> format, e.g.
<code>Acidanthera\GoldenGate</code>.</p>
<p>Sample resources provided as a part of <a
href="https://github.com/acidanthera/OcBinaryData">OcBinaryData
repository</a> provide the following icon set:</p>
<ul>
<li><p><code>Acidanthera\GoldenGate</code> — macOS 11 styled icon
set.</p></li>
<li><p><code>Acidanthera\Syrah</code> — OS X 10.10 styled icon
set.</p></li>
<li><p><code>Acidanthera\Chardonnay</code> — Mac OS X 10.4 styled icon
set.</p></li>
</ul>
<p>For convenience purposes there also are predefined aliases:</p>
<ul>
<li><p><code>Auto</code> — Automatically select one set of icons based
on the <code>DefaultBackground</code> colour:
<code>Acidanthera\GoldenGate</code> for Syrah Black and
<code>Acidanthera\Chardonnay</code> for Light Gray.</p></li>
<li><p><code>Default</code> —
<code>Acidanthera\GoldenGate</code>.</p></li>
</ul></li>
<li><p><code>PollAppleHotKeys</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable <code>modifier hotkey</code>
handling in the OpenCore picker.</p>
<p>In addition to <code>action hotkeys</code>, which are partially
described in the <code>PickerMode</code> section and are typically
handled by Apple BDS, modifier keys handled by the operating system
bootloader (<code>boot.efi</code>) also exist. These keys allow changing
the behaviour of the operating system by providing different boot
modes.</p>
<p>On certain firmware, using modifier keys may be problematic due to
driver incompatibilities. To workaround this problem, this option allows
registering certain hotkeys in a more permissive manner from within the
OpenCore picker. Such extensions include support for tapping on key
combinations before selecting the boot item, and for reliable detection
of the <code>Shift</code> key when selecting the boot item, in order to
work around the fact that hotkeys which are continuously held during
boot cannot be reliably detected on many PS/2 keyboards.</p>
<p>This list of known <code>modifier hotkeys</code> includes:</p>
<ul>
<li><p><code>CMD+C+MINUS</code> — disable board compatibility
checking.</p></li>
<li><p><code>CMD+K</code> — boot release kernel, similar to
<code>kcsuffix=release</code>.</p></li>
<li><p><code>CMD+S</code> — single user mode.</p></li>
<li><p><code>CMD+S+MINUS</code> — disable KASLR slide, requires disabled
SIP.</p></li>
<li><p><code>CMD+V</code> — verbose mode.</p></li>
<li><p><code>Shift+Enter</code>, <code>Shift+Index</code> — safe mode,
may be used in combination with <code>CTRL+Enter</code>,
<code>CTRL+Index</code>.</p></li>
</ul></li>
<li><p><code>ShowPicker</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Show a simple picker to allow boot entry
selection.</p></li>
<li><p><code>TakeoffDelay</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32 bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Delay in microseconds executed before
handling the OpenCore picker startup and
<code>action hotkeys</code>.</p>
<p>Introducing a delay may give extra time to hold the right
<code>action hotkey</code> sequence to, for instance, boot into recovery
mode. On most systems, the appearance of the initial boot logo is a good
indication of the time from which hotkeys can be held down. Earlier than
this, the key press may not be registered. On some platforms, setting
this option to a minimum of <code>5000-10000</code> microseconds is also
required to access <code>action hotkeys</code> due to the nature of the
keyboard driver.</p>
<p>If the boot chime is configured (see audio configuration options)
then at the expense of slower startup, an even longer delay of half to
one second (<code>500000-1000000</code>) may be used to create behaviour
similar to a real Mac, where the chime itself can be used as a signal
for when hotkeys can be pressed. The boot chime is inevitably later in
the boot sequence in OpenCore than on Apple hardware, due to the fact
that non-native drivers have to be loaded and connected first.
Configuring the boot chime and adding this longer additional delay can
also be useful in systems where fast boot time and/or slow monitor
signal synchronisation may cause the boot logo not to be shown at all on
some boots or reboots.</p></li>
<li><p><code>Timeout</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32 bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Timeout in seconds in the OpenCore picker
before automatic booting of the default boot entry. Set to
<code>0</code> to disable.</p></li>
</ol>
<h2 id="miscdebugprops">Debug Properties</h2>
<ol>
<li><p><code>AppleDebug</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable writing the <code>boot.efi</code>
debug log to the OpenCore log.</p>
<p><em>Note</em>: This option only applies to 10.15.4 and
newer.</p></li>
<li><p><code>ApplePanic</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Save macOS kernel panic output to the
OpenCore root partition.</p>
<p>The file is saved as <code>panic-YYYY-MM-DD-HHMMSS.txt</code>. It is
strongly recommended to set the <code>keepsyms=1</code> boot argument to
see debug symbols in the panic log. In cases where it is not present,
the <code>kpdescribe.sh</code> utility (bundled with OpenCore) may be
used to partially recover the stacktrace.</p>
<p>Development and debug kernels produce more useful kernel panic logs.
Consider downloading and installing the <code>KernelDebugKit</code> from
<a href="https://developer.apple.com">developer.apple.com</a> when
debugging a problem. To activate a development kernel, the boot argument
<code>kcsuffix=development</code> should be added. Use the
<code>uname -a</code> command to ensure that the current loaded kernel
is a development (or a debug) kernel.</p>
<p>In cases where the OpenCore kernel panic saving mechanism is not
used, kernel panic logs may still be found in the
<code>/Library/Logs/DiagnosticReports</code> directory.</p>
<p>Starting with macOS Catalina, kernel panics are stored in JSON format
and thus need to be preprocessed before passing to
<code>kpdescribe.sh</code>:</p>
<pre id="kpanic" data-label="kpanic" style="ocbash"><code>cat Kernel.panic | grep macOSProcessedStackshotData |
  python3 -c &#39;import json,sys;print(json.load(sys.stdin)[&quot;macOSPanicString&quot;])&#39;</code></pre></li>
<li><p><code>DisableWatchDog</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware may not succeed in
booting the operating system quickly, especially in debug mode. This
results in the watchdog timer aborting the process. This option turns
off the watchdog timer.</p></li>
<li><p><code>DisplayDelay</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Delay in microseconds executed after every
printed line visible onscreen (i.e. console).</p></li>
<li><p><code>DisplayLevel</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64 bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: EDK II debug level bitmask (sum) showed
onscreen. Unless <code>Target</code> enables console (onscreen)
printing, onscreen debug output will not be visible.</p>
<p>The following levels are supported (discover more in <a
href="https://github.com/acidanthera/audk/blob/master/MdePkg/Include/Library/DebugLib.h">DebugLib.h</a>):</p>
<ul>
<li><p><code>0x00000002</code> (bit <code>1</code>) —
<code>DEBUG_WARN</code> in <code>DEBUG</code>, <code>NOOPT</code>,
<code>RELEASE</code>.</p></li>
<li><p><code>0x00000040</code> (bit <code>6</code>) —
<code>DEBUG_INFO</code> in <code>DEBUG</code>,
<code>NOOPT</code>.</p></li>
<li><p><code>0x00400000</code> (bit <code>22</code>) —
<code>DEBUG_VERBOSE</code> in custom builds.</p></li>
<li><p><code>0x80000000</code> (bit <code>31</code>) —
<code>DEBUG_ERROR</code> in <code>DEBUG</code>, <code>NOOPT</code>,
<code>RELEASE</code>.</p></li>
</ul></li>
<li><p><code>LogModules</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>*</code><br />
<strong>Description</strong>: Filter log entries by module.</p>
<p>This option filters logging generated by specific modules, both in
the log and onscreen. Two modes are supported:</p>
<ul>
<li><p><code>+</code> — Positive filtering: Only present selected
modules.</p></li>
<li><p><code>-</code> — Negative filtering: Exclude selected
modules.</p></li>
</ul>
<p>When multiple log line identifiers are selected, comma
(<code>,</code>) should be used as the splitter. For instance,
<code>+OCCPU,OCA,OCB</code> means only <code>OCCPU</code>,
<code>OCA</code>, <code>OCB</code> should be logged, while
<code>-OCCPU,OCA,OCB</code> indicates these modules should be filtered
out (i.e. not logged). Since there may be lines in the log with no valid
prefix (i.e. log lines which are not generated by parts of OpenCore, but
by other loaded drivers) then the special module name question mark
(<code>?</code>) can be included in the list to include (with positive
filtering) or exclude (with negative filtering) these non-standard
lines. When no <code>+</code> or <code>-</code> symbol is specified,
positive filtering (<code>+</code>) will be used. <code>*</code> alone
as the option value indicates all modules being logged.</p>
<p><em>Note 1</em>: Acronyms of libraries can be found in the <a
href="#oc-mod-libs"><code>Libraries</code></a> section below.</p>
<p><em>Note 2</em>: Messages printed before the configuration of the log
protocol cannot be filtered from the early on screen log, but on being
de-buffered from the early log buffer, will be filtered as requested for
other log targets.</p>
<p><em>Note 3</em>: To avoid missing key issues, warning and error log
messages are not filtered.</p></li>
<li><p><code>SysReport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Produce system report on ESP folder.</p>
<p>This option will create a <code>SysReport</code> directory in the ESP
partition unless already present. The directory will contain ACPI,
SMBIOS, and audio codec dumps. Audio codec dumps require an audio
backend driver to be loaded.</p>
<p><em>Note</em>: To maintain system integrity, the
<code>SysReport</code> option is <strong>not</strong> available in
<code>RELEASE</code> builds. Use a <code>DEBUG</code> build if this
option is required.</p></li>
<li><p><code>Target</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: A bitmask (sum) of enabled logging
targets. Logging output is hidden by default and this option must be set
when such output is required, such as when debugging.</p>
<p>The following logging targets are supported:</p>
<ul>
<li><p><code>0x01</code> (bit <code>0</code>) — Enable logging,
otherwise all log is discarded.</p></li>
<li><p><code>0x02</code> (bit <code>1</code>) — Enable basic console
(onscreen) logging.</p></li>
<li><p><code>0x04</code> (bit <code>2</code>) — Enable logging to Data
Hub.</p></li>
<li><p><code>0x08</code> (bit <code>3</code>) — Enable serial port
logging.</p></li>
<li><p><code>0x10</code> (bit <code>4</code>) — Enable UEFI variable
logging.</p></li>
<li><p><code>0x20</code> (bit <code>5</code>) — Enable
<code>non-volatile</code> UEFI variable logging.</p></li>
<li><p><code>0x40</code> (bit <code>6</code>) — Enable logging to
file.</p></li>
<li><p><code>0x80</code> (bit <code>7</code>) — In combination with
<code>0x40</code>, enable faster but unsafe (see Warning 2 below) file
logging.</p></li>
</ul>
<p>Console logging prints less than the other variants. Depending on the
build type (<code>RELEASE</code>, <code>DEBUG</code>, or
<code>NOOPT</code>) different amount of logging may be read (from least
to most).</p>
<p>To obtain Data Hub logs, use the following command in macOS (Note
that Data Hub logs do not log kernel and kext patches):</p>
<pre id="dhublog" data-label="dhublog" style="ocbash"><code>ioreg -lw0 -p IODeviceTree | grep boot-log | sort | sed &#39;s/.*&lt;\(.*\)&gt;.*/\1/&#39; | xxd -r -p</code></pre>
<p>UEFI variable log does not include some messages and has no
performance data. To maintain system integrity, the log size is limited
to 32 kilobytes. Some types of firmware may truncate it much earlier or
drop completely if they have no memory. Using the
<code>non-volatile</code> flag will cause the log to be written to NVRAM
flash after every printed line.</p>
<p>To obtain UEFI variable logs, use the following command in macOS:</p>
<pre id="nvramlog" data-label="nvramlog" style="ocbash"><code>nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:boot-log |
  awk &#39;{gsub(/%0d%0a%00/,&quot;&quot;);gsub(/%0d%0a/,&quot;\n&quot;)}1&#39;</code></pre>
<p><strong>Warning 1</strong>: Certain firmware appear to have defective
NVRAM garbage collection. As a result, they may not be able to always
free space after variable deletion. Do not enable
<code>non-volatile</code> NVRAM logging on such devices unless
specifically required.</p>
<p>While the OpenCore boot log already contains basic version
information including build type and date, this information may also be
found in the <code>opencore-version</code> NVRAM variable even when boot
logging is disabled.</p>
<p>File logging will create a file named
<code>opencore-YYYY-MM-DD-HHMMSS.txt</code> (in UTC) under the EFI
volume root with log contents (the upper case letter sequence is
replaced with date and time from the firmware). Please be warned that
some file system drivers present in firmware are not reliable and may
corrupt data when writing files through UEFI. Log writing is attempted
in the safest manner and thus, is very slow. Ensure that
<code>DisableWatchDog</code> is set to <code>true</code> when a slow
drive is used. Try to avoid frequent use of this option when dealing
with flash drives as large I/O amounts may speed up memory wear and
render the flash drive unusable quicker.</p>
<p><strong>Warning 2</strong>: It is possible to enable fast file
logging, which requires a fully compliant firmware FAT32 driver. On
drivers with incorrect FAT32 write support (e.g. APTIO IV, but maybe
others) this setting can result in corruption up to and including an
unusable ESP filesystem, therefore be prepared to recreate the ESP
partition and all of its contents if testing this option. This option
can increase logging speed significantly on some suitable firmware, but
may make little speed difference on some others.</p>
<p>When interpreting the log, note that the lines are prefixed with a
tag describing the relevant location (module) of the log line allowing
better attribution of the line to the functionality.</p>
<p>The list of currently used tags is as follows.</p>
<p><strong>Drivers and tools</strong>:</p>
<ul>
<li><p><code>BMF</code> — OpenCanopy, bitmap font</p></li>
<li><p><code>BS</code> — Bootstrap</p></li>
<li><p><code>GSTT</code> — GoptStop</p></li>
<li><p><code>HDA</code> — AudioDxe</p></li>
<li><p><code>KKT</code> — KeyTester</p></li>
<li><p><code>LNX</code> — OpenLinuxBoot</p></li>
<li><p><code>MMDD</code> — MmapDump</p></li>
<li><p><code>OCPAVP</code> — PavpProvision</p></li>
<li><p><code>OCRST</code> — ResetSystem</p></li>
<li><p><code>OCUI</code> — OpenCanopy</p></li>
<li><p><code>OC</code> — OpenCore main, also OcMainLib</p></li>
<li><p><code>OLB</code> — OpenLegacyBoot</p></li>
<li><p><code>VMOPT</code> — VerifyMemOpt</p></li>
</ul>
<p><span id="oc-mod-libs" data-label="oc-mod-libs"></span>
<strong>Libraries</strong>:</p>
<ul>
<li><p><code>AAPL</code> — OcLogAggregatorLib, Apple EfiBoot
logging</p></li>
<li><p><code>OCABC</code> — OcAfterBootCompatLib</p></li>
<li><p><code>OCAE</code> — OcAppleEventLib</p></li>
<li><p><code>OCAK</code> — OcAppleKernelLib</p></li>
<li><p><code>OCAU</code> — OcAudioLib</p></li>
<li><p><code>OCA</code> —- OcAcpiLib</p></li>
<li><p><code>OCBP</code> — OcAppleBootPolicyLib</p></li>
<li><p><code>OCB</code> — OcBootManagementLib</p></li>
<li><p><code>OCLBT</code> — OcBlitLib</p></li>
<li><p><code>OCCL</code> — OcAppleChunkListLib</p></li>
<li><p><code>OCCPU</code> — OcCpuLib</p></li>
<li><p><code>OCC</code> — OcConsoleLib</p></li>
<li><p><code>OCDC</code> — OcDriverConnectionLib</p></li>
<li><p><code>OCDH</code> — OcDataHubLib</p></li>
<li><p><code>OCDI</code> — OcAppleDiskImageLib</p></li>
<li><p><code>OCDM</code> — OcDeviceMiscLib</p></li>
<li><p><code>OCFS</code> — OcFileLib</p></li>
<li><p><code>OCFV</code> — OcFirmwareVolumeLib</p></li>
<li><p><code>OCHS</code> — OcHashServicesLib</p></li>
<li><p><code>OCI4</code> — OcAppleImg4Lib</p></li>
<li><p><code>OCIC</code> — OcImageConversionLib</p></li>
<li><p><code>OCII</code> — OcInputLib</p></li>
<li><p><code>OCJS</code> — OcApfsLib</p></li>
<li><p><code>OCKM</code> — OcAppleKeyMapLib</p></li>
<li><p><code>OCL</code> — OcLogAggregatorLib</p></li>
<li><p><code>OCM</code> — OcMiscLib</p></li>
<li><p><code>OCMCO</code> — OcMachoLib</p></li>
<li><p><code>OCME</code> — OcHeciLib</p></li>
<li><p><code>OCMM</code> — OcMemoryLib</p></li>
<li><p><code>OCPE</code> — OcPeCoffLib, OcPeCoffExtLib</p></li>
<li><p><code>OCPI</code> — OcFileLib, partition info</p></li>
<li><p><code>OCPNG</code> — OcPngLib</p></li>
<li><p><code>OCRAM</code> — OcAppleRamDiskLib</p></li>
<li><p><code>OCRTC</code> — OcRtcLib</p></li>
<li><p><code>OCSB</code> — OcAppleSecureBootLib</p></li>
<li><p><code>OCSMB</code> — OcSmbiosLib</p></li>
<li><p><code>OCSMC</code> — OcSmcLib</p></li>
<li><p><code>OCST</code> — OcStorageLib</p></li>
<li><p><code>OCS</code> — OcSerializedLib</p></li>
<li><p><code>OCTPL</code> — OcTemplateLib</p></li>
<li><p><code>OCUC</code> — OcUnicodeCollationLib</p></li>
<li><p><code>OCUT</code> — OcAppleUserInterfaceThemeLib</p></li>
<li><p><code>OCVAR</code> — OcVariableLib</p></li>
<li><p><code>OCXML</code> — OcXmlLib</p></li>
</ul></li>
</ol>
<h2 id="miscentryprops">Entry Properties</h2>
<ol>
<li><p><code>Arguments</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used as boot
arguments (load options) of the specified entry.</p></li>
<li><p><code>Auxiliary</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> to hide this
entry when <code>HideAuxiliary</code> is also set to <code>true</code>.
Press the <code>Spacebar</code> key to enter “Extended Mode” and display
the entry when hidden.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide a
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set to <code>true</code> activate this
entry.</p></li>
<li><p><code>Flavour</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Specify the content flavour for this
entry. See <a
href="#oc-attr-use-flavour-icon"><code>OC_ATTR_USE_FLAVOUR_ICON</code></a>
flag for documentation.</p></li>
<li><p><code>FullNvramAccess</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Disable <code>OpenRuntime</code> NVRAM
protection during usage of a tool.</p>
<p>This disables all of the NVRAM protections provided by
<code>OpenRuntime.efi</code>, during the time a tool is in use. It
should normally be avoided, but may be required for instance if a tool
needs to access NVRAM directly without the redirections put in place by
<code>RequestBootVarRouting</code>.</p>
<p><em>Note</em>: This option is only valid for <code>Tools</code> and
cannot be specified for <code>Entries</code> (is always
<code>false</code>).</p></li>
<li><p><code>Name</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Human readable entry name displayed in the
OpenCore picker.</p></li>
<li><p><code>Path</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Entry location depending on entry
type.</p>
<ul>
<li><p><code>Entries</code> specify external boot options, and therefore
take device paths in the <code>Path</code> key. Care should be exercised
as these values are not checked. Example:
<code>PciRoot(0x0)/Pci(0x1,0x1)/.../\EFI\COOL.EFI</code></p></li>
<li><p><code>Tools</code> specify internal boot options, which are part
of the bootloader vault, and therefore take file paths relative to the
<code>OC/Tools</code> directory. Example:
<code>OpenShell.efi</code>.</p></li>
</ul></li>
<li><p><code>RealPath</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Pass full path to the tool when
launching.</p>
<p>This should typically be disabled as passing the tool directory may
be unsafe with tools that accidentally attempt to access files without
checking their integrity. Reasons to enable this property may include
cases where tools cannot work without external files or may need them
for enhanced functionality such as <code>memtest86</code> (for logging
and configuration), or <code>Shell</code> (for automatic script
execution).</p>
<p><em>Note</em>: This option is only valid for <code>Tools</code> and
cannot be specified for <code>Entries</code> (is always
<code>true</code>).</p></li>
<li><p><code>TextMode</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Run the entry in text mode instead of
graphics mode.</p>
<p>This setting may be beneficial for some older tools that require text
output as all the tools are launched in graphics mode by default. Refer
to the <a href="#uefioutputprops">Output Properties</a> section below
for information on text modes.</p></li>
</ol>
<h2 id="miscsecurityprops">Security Properties</h2>
<ol>
<li><p><code>AllowSetDefault</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Allow <code>CTRL+Enter</code> and
<code>CTRL+Index</code> handling to set the default boot option in the
OpenCore picker.</p>
<p><em>Note 1</em>: May be used in combination with
<code>Shift+Enter</code> or <code>Shift+Index</code> when
<code>PollAppleHotKeys</code> is enabled.</p>
<p><em>Note 2</em>: In order to support systems with unresponsive
modifiers during preboot (which includes <code>V1</code> and
<code>V2</code> <code>KeySupport</code> mode on some firmware) OpenCore
also allows holding the <code>=/+</code> key in order to trigger ‘set
default’ mode.</p></li>
<li><p><code>ApECID</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64 bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Apple Enclave Identifier.</p>
<p>Setting this value to any non-zero 64-bit integer will allow using
personalised Apple Secure Boot identifiers. To use this setting,
generate a random 64-bit number with a cryptographically secure random
number generator. As an alternative, the first 8 bytes of
<code>SystemUUID</code> can be used for <code>ApECID</code>, this is
found in macOS 11 for Macs without the T2 chip.</p>
<p>With this value set and <code>SecureBootModel</code> valid (and not
<code>Disabled</code>), it is possible to achieve <a
href="https://support.apple.com/en-us/HT208330"><code>Full Security</code></a>
of Apple Secure Boot.</p>
<p>To start using personalised Apple Secure Boot, the operating system
must be reinstalled or personalised. Until the operating system is
personalised, only macOS DMG recovery can be loaded. In cases where DMG
recovery is missing, it can be downloaded by using the
<code>macrecovery</code> utility and saved in
<code>com.apple.recovery.boot</code> as explained in the <a
href="#reinstallmacos">Tips and Tricks</a> section. Note that <a
href="#securedmgloading">DMG loading</a> needs to be set to
<code>Signed</code> to use any DMG with Apple Secure Boot.</p>
<p>To personalise an existing operating system, use the
<code>bless</code> command after loading to macOS DMG recovery. Mount
the system volume partition, unless it has already been mounted, and
execute the following command:</p>
<pre id="blesspersona" data-label="blesspersona" style="ocbash"><code>bless --folder &quot;/Volumes/Macintosh HD/System/Library/CoreServices&quot; \
  --bootefi --personalize</code></pre>
<p>On macOS 11 and newer the dedicated <code>x86legacy</code> model
always uses <code>ApECID</code>. When this configuration setting is left
as <code>0</code> first 8 bytes of <code>system-id</code> variable are
used instead.</p>
<p>On macOS versions before macOS 11, which introduced a dedicated
<code>x86legacy</code> model for models without the T2 chip,
personalised Apple Secure Boot may not work as expected. When
reinstalling the operating system, the macOS Installer from macOS 10.15
and older will often run out of free memory on the <code>/var/tmp</code>
partition when trying to install macOS with the personalised Apple
Secure Boot. Soon after downloading the macOS installer image, an
<code>Unable to verify macOS</code> error message will appear.</p>
<p>To workaround this issue, allocate a dedicated RAM disk of 2 MBs for
macOS personalisation by entering the following commands in the macOS
recovery terminal before starting the installation:</p>
<pre id="secureboot" data-label="secureboot" style="ocbash"><code>disk=$(hdiutil attach -nomount ram://4096)
diskutil erasevolume HFS+ SecureBoot $disk
diskutil unmount $disk
mkdir /var/tmp/OSPersonalizationTemp
diskutil mount -mountpoint /var/tmp/OSPersonalizationTemp $disk</code></pre></li>
<li><p><code>AuthRestart</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable <code>VirtualSMC</code>-compatible
authenticated restart.</p>
<p>Authenticated restart is a way to reboot FileVault 2 enabled macOS
without entering the password. A dedicated terminal command can be used
to perform authenticated restarts:
<code>sudo fdesetup authrestart</code>. It is also used when installing
operating system updates.</p>
<p>VirtualSMC performs authenticated restarts by splitting and saving
disk encryption keys between NVRAM and RTC, which despite being removed
as soon as OpenCore starts, may be considered a security risk and thus
is optional.</p></li>
<li><p><code>BlacklistAppleUpdate</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Ignore boot options trying to update Apple
peripheral firmware (e.g. <code>MultiUpdater.efi</code>).</p>
<p><em>Note</em>: Certain operating systems, such as macOS Big Sur, are
<a
href="https://github.com/acidanthera/bugtracker/issues/1255">incapable</a>
of disabling firmware updates by using the <code>run-efi-updater</code>
NVRAM variable.</p></li>
<li><p><span id="securedmgloading" data-label="securedmgloading"></span>
<code>DmgLoading</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Signed</code><br />
<strong>Description</strong>: Define Disk Image (DMG) loading policy
used for macOS Recovery.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Disabled</code> — loading DMG images will fail. The
<code>Disabled</code> policy will still let the macOS Recovery load in
most cases as typically, there are <code>boot.efi</code> files
compatible with Apple Secure Boot. Manually downloaded DMG images stored
in <code>com.apple.recovery.boot</code> directories will not load,
however.</p></li>
<li><p><code>Signed</code> — only Apple-signed DMG images will load. Due
to the design of Apple Secure Boot, the <code>Signed</code> policy will
let any Apple-signed macOS Recovery load regardless of the Apple Secure
Boot state, which may not always be desired. While using signed DMG
images is more desirable, verifying the image signature may slightly
slow the boot time down (by up to 1 second).</p></li>
<li><p><code>Any</code> — any DMG images will mount as normal
filesystems. The <code>Any</code> policy is strongly discouraged and
will result in boot failures when Apple Secure Boot is active.</p></li>
</ul></li>
<li><p><code>EnablePassword</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable password protection to facilitate
sensitive operations.</p>
<p>Password protection ensures that sensitive operations such as booting
a non-default operating system (e.g. macOS recovery or a tool),
resetting NVRAM storage, trying to boot into a non-default mode (e.g.
verbose mode or safe mode) are not allowed without explicit user
authentication by a custom password. Currently, password and salt are
hashed with 5000000 iterations of SHA-512.</p>
<p><em>Note</em>: This functionality is still under development and is
not ready for production environments.</p></li>
<li><p><code>ExposeSensitiveData</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0x6</code><br />
<strong>Description</strong>: Sensitive data exposure bitmask (sum) to
operating system.</p>
<ul>
<li><p><code>0x01</code> — Expose the printable booter path as a UEFI
variable.</p></li>
<li><p><code>0x02</code> — Expose the OpenCore version as a UEFI
variable.</p></li>
<li><p><code>0x04</code> — Expose the OpenCore version in the OpenCore
picker menu title.</p></li>
<li><p><code>0x08</code> — Expose OEM information as a set of UEFI
variables.</p></li>
</ul>
<p>The exposed booter path points to OpenCore.efi or its booter
depending on the load order. To obtain the booter path, use the
following command in macOS:</p>
<pre id="nvrampath" data-label="nvrampath" style="ocbash"><code>nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:boot-path</code></pre>
<p>To use a booter path to mount a booter volume, use the following
command in macOS:</p>
<pre id="nvrampathmount" data-label="nvrampathmount"
style="ocbash"><code>u=$(nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:boot-path | sed &#39;s/.*GPT,\([^,]*\),.*/\1/&#39;); \
  if [ &quot;$u&quot; != &quot;&quot; ]; then sudo diskutil mount $u ; fi</code></pre>
<p>To obtain the current OpenCore version, use the following command in
macOS:</p>
<pre id="nvramver" data-label="nvramver" style="ocbash"><code>nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:opencore-version</code></pre>
<p>If the OpenCore version is not exposed the variable will contain
<code>UNK-000-0000-00-00</code> sequence.</p>
<p>To obtain OEM information, use the following commands in macOS:</p>
<pre id="nvramoem" data-label="nvramoem" style="ocbash"><code>nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:oem-product # SMBIOS Type1 ProductName
nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:oem-vendor  # SMBIOS Type2 Manufacturer
nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:oem-board   # SMBIOS Type2 ProductName</code></pre></li>
<li><p><code>HaltLevel</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64 bit<br />
<strong>Failsafe</strong>: <code>0x80000000</code>
(<code>DEBUG_ERROR</code>)<br />
<strong>Description</strong>: EDK II debug level bitmask (sum) causing
CPU to halt (stop execution) after obtaining a message of
<code>HaltLevel</code>. Possible values match <code>DisplayLevel</code>
values.</p>
<p><em>Note 1</em>: A halt will only occur if bit <code>0</code> (i.e.
enable logging) for <code>Target</code> under section
<code>Misc-&gt;Debug</code> is set.</p>
<p><em>Note 2</em>: A halt will only occur after the configuration is
loaded and logging is configured. If any log messages occur at the
specified halt level in early log (i.e. before this), they will cause a
halt when they are flushed to the log once it has been
configured.</p></li>
<li><p><code>PasswordHash</code><br />
<strong>Type</strong>: <code>plist data</code> 64 bytes<br />
<strong>Failsafe</strong>: all zero<br />
<strong>Description</strong>: Password hash used when
<code>EnablePassword</code> is set.</p></li>
<li><p><code>PasswordSalt</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: empty<br />
<strong>Description</strong>: Password salt used when
<code>EnablePassword</code> is set.</p></li>
<li><p><code>ScanPolicy</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32 bit<br />
<strong>Failsafe</strong>: <code>0x10F0103</code><br />
<strong>Description</strong>: Define operating system detection
policy.</p>
<p>This value allows preventing scanning (and booting) untrusted sources
based on a bitmask (sum) of a set of flags. As it is not possible to
reliably detect every file system or device type, this feature cannot be
fully relied upon in open environments, and additional measures are to
be applied.</p>
<p>Third party drivers may introduce additional security (and
performance) consideratons following the provided scan policy. The
active Scan policy is exposed in the <code>scan-policy</code> variable
of <code>4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102</code> GUID for UEFI Boot
Services only.</p>
<ul>
<li><p><code>0x00000001</code> (bit <code>0</code>) —
<code>OC_SCAN_FILE_SYSTEM_LOCK</code>, restricts scanning to only known
file systems defined as a part of this policy. File system drivers may
not be aware of this policy. Hence, to avoid mounting of undesired file
systems, drivers for such file systems should not be loaded. This bit
does not affect DMG mounting, which may have any file system. Known file
systems are prefixed with <code>OC_SCAN_ALLOW_FS_</code>.</p></li>
<li><p><code>0x00000002</code> (bit <code>1</code>) —
<code>OC_SCAN_DEVICE_LOCK</code>, restricts scanning to only known
device types defined as a part of this policy. It is not always possible
to detect protocol tunneling, so be aware that on some systems, it may
be possible for e.g. USB HDDs to be recognised as SATA instead. Cases
like this must be reported. Known device types are prefixed with
<code>OC_SCAN_ALLOW_DEVICE_</code>.</p></li>
<li><p><code>0x00000100</code> (bit <code>8</code>) —
<code>OC_SCAN_ALLOW_FS_APFS</code>, allows scanning of APFS file
system.</p></li>
<li><p><code>0x00000200</code> (bit <code>9</code>) —
<code>OC_SCAN_ALLOW_FS_HFS</code>, allows scanning of HFS file
system.</p></li>
<li><p><code>0x00000400</code> (bit <code>10</code>) —
<code>OC_SCAN_ALLOW_FS_ESP</code>, allows scanning of EFI System
Partition file system.</p></li>
<li><p><code>0x00000800</code> (bit <code>11</code>) —
<code>OC_SCAN_ALLOW_FS_NTFS</code>, allows scanning of NTFS (Msft Basic
Data) file system.</p></li>
<li><p><code>0x00001000</code> (bit <code>12</code>) —
<code>OC_SCAN_ALLOW_FS_LINUX_ROOT</code>, allows scanning of Linux Root
file systems.</p></li>
<li><p><code>0x00002000</code> (bit <code>13</code>) —
<code>OC_SCAN_ALLOW_FS_LINUX_DATA</code>, allows scanning of Linux Data
file systems.</p></li>
<li><p><code>0x00004000</code> (bit <code>14</code>) —
<code>OC_SCAN_ALLOW_FS_XBOOTLDR</code>, allows scanning the Extended
Boot Loader Partition as defined by the <a
href="https://systemd.io/BOOT_LOADER_SPECIFICATION/">Boot Loader
Specification</a>.</p></li>
<li><p><code>0x00010000</code> (bit <code>16</code>) —
<code>OC_SCAN_ALLOW_DEVICE_SATA</code>, allow scanning SATA
devices.</p></li>
<li><p><code>0x00020000</code> (bit <code>17</code>) —
<code>OC_SCAN_ALLOW_DEVICE_SASEX</code>, allow scanning SAS and Mac NVMe
devices.</p></li>
<li><p><code>0x00040000</code> (bit <code>18</code>) —
<code>OC_SCAN_ALLOW_DEVICE_SCSI</code>, allow scanning SCSI
devices.</p></li>
<li><p><code>0x00080000</code> (bit <code>19</code>) —
<code>OC_SCAN_ALLOW_DEVICE_NVME</code>, allow scanning NVMe
devices.</p></li>
<li><p><code>0x00100000</code> (bit <code>20</code>) —
<code>OC_SCAN_ALLOW_DEVICE_ATAPI</code>, allow scanning CD/DVD devices
and old SATA.</p></li>
<li><p><code>0x00200000</code> (bit <code>21</code>) —
<code>OC_SCAN_ALLOW_DEVICE_USB</code>, allow scanning USB
devices.</p></li>
<li><p><code>0x00400000</code> (bit <code>22</code>) —
<code>OC_SCAN_ALLOW_DEVICE_FIREWIRE</code>, allow scanning FireWire
devices.</p></li>
<li><p><code>0x00800000</code> (bit <code>23</code>) —
<code>OC_SCAN_ALLOW_DEVICE_SDCARD</code>, allow scanning card reader
devices.</p></li>
<li><p><code>0x01000000</code> (bit <code>24</code>) —
<code>OC_SCAN_ALLOW_DEVICE_PCI</code>, allow scanning devices directly
connected to PCI bus (e.g. VIRTIO).</p></li>
</ul>
<p><em>Note</em>: Given the above description, a value of
<code>0xF0103</code> is expected to do the following:</p>
<ul>
<li><p>Permit scanning SATA, SAS, SCSI, and NVMe devices with APFS file
systems.</p></li>
<li><p>Prevent scanning any devices with HFS or FAT32 file
systems.</p></li>
<li><p>Prevent scanning APFS file systems on USB, CD, and FireWire
drives.</p></li>
</ul>
<p>The combination reads as:</p>
<ul>
<li><p><code>OC_SCAN_FILE_SYSTEM_LOCK</code></p></li>
<li><p><code>OC_SCAN_DEVICE_LOCK</code></p></li>
<li><p><code>OC_SCAN_ALLOW_FS_APFS</code></p></li>
<li><p><code>OC_SCAN_ALLOW_DEVICE_SATA</code></p></li>
<li><p><code>OC_SCAN_ALLOW_DEVICE_SASEX</code></p></li>
<li><p><code>OC_SCAN_ALLOW_DEVICE_SCSI</code></p></li>
<li><p><code>OC_SCAN_ALLOW_DEVICE_NVME</code></p></li>
</ul></li>
<li><p><span id="secureapplesb" data-label="secureapplesb"></span>
<code>SecureBootModel</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Default</code><br />
<strong>Description</strong>: Apple Secure Boot hardware model.</p>
<p>Sets Apple Secure Boot hardware model and policy. Specifying this
value defines which operating systems will be bootable. Operating
systems shipped before the specified model was released will not
boot.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Default</code> — Matching model for current
SMBIOS.</p></li>
<li><p><code>Disabled</code> — No model, Secure Boot will be
disabled.</p></li>
<li><p><code>j137</code> —
<code>iMacPro1,1 (December 2017). Minimum macOS 10.13.2 (17C2111)</code></p></li>
<li><p><code>j680</code> —
<code>MacBookPro15,1 (July 2018). Minimum macOS 10.13.6 (17G2112)</code></p></li>
<li><p><code>j132</code> —
<code>MacBookPro15,2 (July 2018). Minimum macOS 10.13.6 (17G2112)</code></p></li>
<li><p><code>j174</code> —
<code>Macmini8,1 (October 2018). Minimum macOS 10.14 (18A2063)</code></p></li>
<li><p><code>j140k</code> —
<code>MacBookAir8,1 (October 2018). Minimum macOS 10.14.1 (18B2084)</code></p></li>
<li><p><code>j780</code> —
<code>MacBookPro15,3 (May 2019). Minimum macOS 10.14.5 (18F132)</code></p></li>
<li><p><code>j213</code> —
<code>MacBookPro15,4 (July 2019). Minimum macOS 10.14.5 (18F2058)</code></p></li>
<li><p><code>j140a</code> —
<code>MacBookAir8,2 (July 2019). Minimum macOS 10.14.5 (18F2058)</code></p></li>
<li><p><code>j152f</code> —
<code>MacBookPro16,1 (November 2019). Minimum macOS 10.15.1 (19B2093)</code></p></li>
<li><p><code>j160</code> —
<code>MacPro7,1 (December 2019). Minimum macOS 10.15.1 (19B88)</code></p></li>
<li><p><code>j230k</code> —
<code>MacBookAir9,1 (March 2020). Minimum macOS 10.15.3 (19D2064)</code></p></li>
<li><p><code>j214k</code> —
<code>MacBookPro16,2 (May 2020). Minimum macOS 10.15.4 (19E2269)</code></p></li>
<li><p><code>j223</code> —
<code>MacBookPro16,3 (May 2020). Minimum macOS 10.15.4 (19E2265)</code></p></li>
<li><p><code>j215</code> —
<code>MacBookPro16,4 (June 2020). Minimum macOS 10.15.5 (19F96)</code></p></li>
<li><p><code>j185</code> —
<code>iMac20,1 (August 2020). Minimum macOS 10.15.6 (19G2005)</code></p></li>
<li><p><code>j185f</code> —
<code>iMac20,2 (August 2020). Minimum macOS 10.15.6 (19G2005)</code></p></li>
<li><p><code>x86legacy</code> —
<code>Macs without T2 chip and VMs. Minimum macOS 11.0.1 (20B29)</code></p></li>
</ul>
<p><em>Warning</em>: Not all Apple Secure Boot models are supported on
all hardware configurations.</p>
<p>Apple Secure Boot appeared in macOS 10.13 on models with T2 chips.
Prior to macOS 12 <code>PlatformInfo</code> and
<code>SecureBootModel</code> were independent, allowing Apple Secure
Boot can be used with any SMBIOS with and without T2. Starting with
macOS 12 <code>SecureBootModel</code> must match the SMBIOS Mac model.
<code>Default</code> model derives the model based on SMBIOS board
identifier, either set automatically via the <code>Generic</code>
section or set manually via the <code>SMBIOS</code> section. If there is
no board identifier override the model will be derived heuristically
from OEM SMBIOS.</p>
<p>Setting <code>SecureBootModel</code> to any valid value but
<code>Disabled</code> is equivalent to <a
href="https://support.apple.com/en-us/HT208330"><code>Medium Security</code></a>
of Apple Secure Boot. The <code>ApECID</code> value must also be
specified to achieve <code>Full Security</code>. Check
<code>ForceSecureBootScheme</code> when using Apple Secure Boot on a
virtual machine.</p>
<p>Note that enabling Apple Secure Boot is demanding on invalid
configurations, faulty macOS installations, and on unsupported
setups.</p>
<p>Things to consider:</p>
<ol>
<li><p>As with T2 Macs, all unsigned kernel extensions as well as
several signed kernel extensions, including NVIDIA Web Drivers, cannot
be installed.</p></li>
<li><p>The list of cached kernel extensions may be different, resulting
in a need to change the list of <code>Added</code> or
<code>Forced</code> kernel extensions. For example,
<code>IO80211Family</code> cannot be injected in this case.</p></li>
<li><p>System volume alterations on operating systems with sealing, such
as macOS 11, may result in the operating system being unbootable. Do not
try to disable system volume encryption unless Apple Secure Boot is
disabled.</p></li>
<li><p>Boot failures might occur when the platform requires certain
settings, but they have not been enabled because the associated issues
were not discovered earlier. Be extra careful with
<code>IgnoreInvalidFlexRatio</code> or
<code>HashServices</code>.</p></li>
<li><p>Operating systems released before Apple Secure Boot was released
(e.g. macOS 10.12 or earlier), will still boot until UEFI Secure Boot is
enabled. This is so because Apple Secure Boot treats these as
incompatible and they are then handled by the firmware (as Microsoft
Windows is).</p></li>
<li><p>On older CPUs (e.g. before Sandy Bridge), enabling Apple Secure
Boot might cause slightly slower loading (by up to 1 second).</p></li>
<li><p>As the <code>Default</code> value will increase with time to
support the latest major released operating system, it is not
recommended to use the <code>ApECID</code> and the <code>Default</code>
settings together.</p></li>
<li><p>Installing macOS with Apple Secure Boot enabled is not possible
while using HFS+ target volumes. This may include HFS+ formatted drives
when no spare APFS drive is available.</p></li>
</ol>
<p>The installed operating system may have sometimes outdated Apple
Secure Boot manifests on the <code>Preboot</code> partition, resulting
in boot failures. This is likely to be the case when an “OCB: Apple
Secure Boot prohibits this boot entry, enforcing!” message is
logged.</p>
<p>When this happens, either reinstall the operating system or copy the
manifests (files with <code>.im4m</code> extension, such as
<code>boot.efi.j137.im4m</code>) from <code>/usr/standalone/i386</code>
to
<code>/Volumes/Preboot/&lt;UUID&gt;/System/Library/CoreServices</code>.
Here, <code>&lt;UUID&gt;</code> is the system volume identifier. On HFS+
installations, the manifests should be copied to
<code>/System/Library/CoreServices</code> on the system volume.</p>
<p>For more details on how to configure Apple Secure Boot with UEFI
Secure Boot, refer to the <a href="#uefisecureboot">UEFI Secure Boot</a>
section.</p></li>
<li><p><span id="securevaulting" data-label="securevaulting"></span>
<code>Vault</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Secure</code><br />
<strong>Description</strong>: Enables the OpenCore vaulting
mechanism.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Optional</code> — require nothing, no vault is enforced,
insecure.</p></li>
<li><p><code>Basic</code> — require <code>vault.plist</code> file
present in <code>OC</code> directory. This provides basic filesystem
integrity verification and may protect from unintentional filesystem
corruption.</p></li>
<li><p><code>Secure</code> — require <code>vault.sig</code> signature
file for <code>vault.plist</code> in <code>OC</code> directory. This
includes <code>Basic</code> integrity checking but also attempts to
build a trusted bootchain.</p></li>
</ul>
<p>The <code>vault.plist</code> file should contain SHA-256 hashes for
all files used by OpenCore. The presence of this file is highly
recommended to ensure that unintentional file modifications (including
filesystem corruption) do not go unnoticed. To create this file
automatically, use the <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/CreateVault"><code>create_vault.sh</code></a>
script. Notwithstanding the underlying file system, the path names and
cases between <code>config.plist</code> and <code>vault.plist</code>
must match.</p>
<p>The <code>vault.sig</code> file should contain a raw 256 byte
RSA-2048 signature from a SHA-256 hash of <code>vault.plist</code>. The
signature is verified against the public key embedded into
<code>OpenCore.efi</code>.</p>
<p>To embed the public key, either one of the following should be
performed:</p>
<ul>
<li><p>Provide public key during the <code>OpenCore.efi</code>
compilation in <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Platform/OpenCore/OpenCoreVault.c"><code>OpenCoreVault.c</code></a>
file.</p></li>
<li><p>Binary patch <code>OpenCore.efi</code> replacing zeroes with the
public key between <code>=BEGIN OC VAULT=</code> and
<code>==END OC VAULT==</code> ASCII markers.</p></li>
</ul>
<p>The RSA public key 520 byte format description can be found in
Chromium OS documentation. To convert the public key from X.509
certificate or from PEM file use <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/CreateVault">RsaTool</a>.</p>
<p>The complete set of commands to:</p>
<ul>
<li><p>Create <code>vault.plist</code>.</p></li>
<li><p>Create a new RSA key (always do this to avoid loading old
configuration).</p></li>
<li><p>Embed RSA key into <code>OpenCore.efi</code>.</p></li>
<li><p>Create <code>vault.sig</code>.</p></li>
</ul>
<p>Can look as follows:</p>
<pre id="createvault" data-label="createvault" style="ocbash"><code>cd /Volumes/EFI/EFI/OC
/path/to/create_vault.sh .
/path/to/RsaTool -sign vault.plist vault.sig vault.pub
off=$(($(strings -a -t d OpenCore.efi | grep &quot;=BEGIN OC VAULT=&quot; | cut -f1 -d&#39; &#39;)+16))
dd of=OpenCore.efi if=vault.pub bs=1 seek=$off count=528 conv=notrunc
rm vault.pub</code></pre>
<p><em>Note 1</em>: While it may appear obvious, an external method is
required to verify <code>OpenCore.efi</code> and
<code>BOOTx64.efi</code> for secure boot path. For this, it is
recommended to enable UEFI SecureBoot using a custom certificate and to
sign <code>OpenCore.efi</code> and <code>BOOTx64.efi</code> with a
custom key. More details on customising secure boot on modern firmware
can be found in the <a href="https://habr.com/post/273497/">Taming UEFI
SecureBoot</a> paper (in Russian).</p>
<p><em>Note 2</em>: Regardless of this option, <code>vault.plist</code>
is always used when present, and both <code>vault.plist</code> and
<code>vault.sig</code> are used and required when a public key is
embedded into <code>OpenCore.efi</code>, and errors will abort the boot
process in either case. Setting this option allows OpenCore to warn the
user if the configuration is not as required to achieve an expected
higher security level.</p></li>
</ol>
<h2 id="miscserialprops">Serial Properties</h2>
<ol>
<li><p><code>Custom</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Update serial port properties in
<code>BaseSerialPortLib16550</code>.</p>
<p>This section lists the PCD values that are used by the
<code>BaseSerialPortLib16550</code>. When option <code>Override</code>
is set to <code>false</code>, this dictionary is optional.</p></li>
<li><p><code>Init</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Perform serial port initialisation.</p>
<p>This option will perform serial port initialisation within OpenCore
prior to enabling (any) debug logging.</p>
<p>Refer to the <a
href="#troubleshootingdebug"><code>Debugging</code></a> section for
details.</p></li>
<li><p><code>Override</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Override serial port properties. When this
option is set to <code>false</code>, no keys from <code>Custom</code>
will be overridden.</p>
<p>This option will override serial port properties listed in the <a
href="#miscserialcustprops"><code>Serial Custom Properties</code></a>
section below.</p></li>
</ol>
<h3 id="miscserialcustprops">Serial Custom Properties</h3>
<ol>
<li><p><code>BaudRate</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>115200</code><br />
<strong>Description</strong>: Set the baud rate for serial port.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialBaudRate</code> defined in
<a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>ClockRate</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>1843200</code><br />
<strong>Description</strong>: Set the clock rate for serial port.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialClockRate</code> defined
in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>DetectCable</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable serial port cable detection.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialDetectCable</code> defined
in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>ExtendedTxFifoSize</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>64</code><br />
<strong>Description</strong>: Set the extended transmit FIFO size for
serial port.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialExtendedTxFifoSize</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>FifoControl</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0x07</code><br />
<strong>Description</strong>: Configure serial port FIFO Control
settings.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialFifoControl</code> defined
in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>LineControl</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0x07</code><br />
<strong>Description</strong>: Configure serial port Line Control
settings.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialLineControl</code> defined
in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>PciDeviceInfo</code><br />
<strong>Type</strong>: <code>plist data</code><br />
<strong>Failsafe</strong>: <code>0xFF</code><br />
<strong>Description</strong>: Set PCI serial device information.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialPciDeviceInfo</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p>
<p><em>Note</em>: The maximum allowed size of this option is 41 bytes.
Refer to <a
href="https://github.com/acidanthera/bugtracker/issues/1954#issuecomment-1084220743">acidanthera/bugtracker#1954</a>
for more details.</p>
<p><em>Note 2</em>: This option can be set by running the <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/FindSerialPort"><code>FindSerialPort</code></a>
tool.</p></li>
<li><p><code>RegisterAccessWidth</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>8</code><br />
<strong>Description</strong>: Set serial port register access width.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialRegisterAccessWidth</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>RegisterBase</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0x03F8</code><br />
<strong>Description</strong>: Set the base address of serial port
registers.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialRegisterBase</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>RegisterStride</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>1</code><br />
<strong>Description</strong>: Set the serial port register stride in
bytes.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialRegisterStride</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>UseHardwareFlowControl</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable serial port hardware flow
control.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialUseHardwareFlowControl</code>
defined in <a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
<li><p><code>UseMmio</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Indicate whether the serial port registers
are in MMIO space.</p>
<p>This option will override the value of
<code>gEfiMdeModulePkgTokenSpaceGuid.PcdSerialUseMmio</code> defined in
<a
href="https://github.com/acidanthera/audk/blob/master/MdeModulePkg/MdeModulePkg.dec">MdeModulePkg.dec</a>.</p></li>
</ol>
<h1 id="nvram">NVRAM</h1>
<h2 id="nvramintro">Introduction</h2>
<p>This section allows setting non-volatile UEFI variables commonly
described as NVRAM variables. Refer to <code>man nvram</code> for
details. The macOS operating system extensively uses NVRAM variables for
OS — Bootloader — Firmware intercommunication. Hence, the supply of
several NVRAM variables is required for the proper functioning of
macOS.</p>
<p>Each NVRAM variable consists of its name, value, attributes (refer to
UEFI specification), and its <a
href="https://en.wikipedia.org/wiki/Universally_unique_identifier">GUID</a>,
representing which ‘section’ the NVRAM variable belongs to. The macOS
operating system makes use of several GUIDs, including but not limited
to:</p>
<ul>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14</code>
(<code>APPLE_VENDOR_VARIABLE_GUID</code>)</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code>
(<code>APPLE_BOOT_VARIABLE_GUID</code>)</p></li>
<li><p><code>5EDDA193-A070-416A-85EB-2A1181F45B18</code> (Apple Hardware
Configuration Storage for <code>MacPro7,1</code>)</p></li>
<li><p><code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code>
(<code>EFI_GLOBAL_VARIABLE_GUID</code>)</p></li>
<li><p><code>4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102</code>
(<code>OC_VENDOR_VARIABLE_GUID</code>)</p></li>
</ul>
<p><em>Note</em>: Some of the variables may be added by the <a
href="#platforminfonvram">PlatformNVRAM</a> or <a
href="#platforminfogeneric">Generic</a> subsections of the <a
href="#platforminfo">PlatformInfo</a> section. Please ensure that
variables set in this section do not conflict with items in those
subsections as the implementation behaviour is undefined otherwise.</p>
<p>The <code>OC_FIRMWARE_RUNTIME</code> protocol implementation,
currently offered as a part of the <code>OpenRuntime</code> driver, is
often required for macOS to function properly. While this brings many
benefits, there are some limitations that should be considered for
certain use cases.</p>
<ol>
<li><p>Not all tools may be aware of protected namespaces.<br />
When <code>RequestBootVarRouting</code> is used,
<code>Boot</code>-prefixed variable access is restricted and protected
in a separate namespace. To access the original variables, tools must be
aware of the <code>OC_FIRMWARE_RUNTIME</code> logic.</p></li>
</ol>
<h2 id="nvramprops">Properties</h2>
<ol>
<li><p><code>Add</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Sets NVRAM variables from a map
(<code>plist dict</code>) of GUIDs to a map (<code>plist dict</code>) of
variable names and their values in <code>plist multidata</code> format.
GUIDs must be provided in canonic string format in upper or lower case
(e.g. <code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code>).</p>
<p>The <code>EFI_VARIABLE_BOOTSERVICE_ACCESS</code> and
<code>EFI_VARIABLE_RUNTIME_ACCESS</code> attributes of created variables
are set. Variables will only be set if not present or deleted. That is,
to overwrite an existing variable value, add the variable name to the
<code>Delete</code> section. This approach enables the provision of
default values until the operating system takes the lead.</p>
<p><em>Note</em>: The implementation behaviour is undefined when the
<code>plist key</code> does not conform to the GUID format.</p></li>
<li><p><code>Delete</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Removes NVRAM variables from a map
(<code>plist dict</code>) of GUIDs to an array
(<code>plist array</code>) of variable names in
<code>plist string</code> format.</p></li>
<li><p><code>LegacyOverwrite</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Permits overwriting firmware variables
from <code>nvram.plist</code>.</p>
<p><em>Note</em>: Only variables accessible from the operating system
will be overwritten.</p></li>
<li><p><code>LegacySchema</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Allows setting certain NVRAM variables
from a map (<code>plist dict</code>) of GUIDs to an array
(<code>plist array</code>) of variable names in
<code>plist string</code> format.</p>
<p><code>*</code> value can be used to accept all variables for certain
GUID.</p>
<p><strong>WARNING</strong>: Choose variables carefully, as the
nvram.plist file is not vaulted. For instance, do not include
<code>boot-args</code> or <code>csr-active-config</code>, as these can
be used to bypass SIP.</p></li>
<li><p><code>WriteFlash</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enables writing to flash memory for all
added variables.</p>
<p><em>Note</em>: This value should be enabled on most types of firmware
but is left configurable to account for firmware that may have issues
with NVRAM variable storage garbage collection or similar.</p></li>
</ol>
<p>The <code>nvram</code> command can be used to read NVRAM variable
values from macOS by concatenating the GUID and name variables separated
by a <code>:</code> symbol. For example,
<code>nvram 7C436110-AB2A-4BBB-A880-FE41995C9F82:boot-args</code>.</p>
<p>A continuously updated variable list can be found in a corresponding
document: <a
href="https://docs.google.com/spreadsheets/d/1HTCBwfOBkXsHiK7os3b2CUc6k68axdJYdGl-TyXqLu0">NVRAM
Variables</a>.</p>
<h2 id="nvramvars">Mandatory Variables</h2>
<p><strong>Warning</strong>: These variables may be added by the <a
href="#platforminfonvram">PlatformNVRAM</a> or <a
href="#platforminfogeneric">Generic</a> subsections of the <a
href="#platforminfo">PlatformInfo</a> section. Using
<code>PlatformInfo</code> is the recommended way of setting these
variables.</p>
<p>The following variables are mandatory for macOS functioning:</p>
<ul>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:FirmwareFeatures</code>
-bit <code>FirmwareFeatures</code>. Present on all Macs to avoid extra
parsing of SMBIOS tables.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:FirmwareFeaturesMask</code>
-bit <code>FirmwareFeaturesMask</code>. Present on all Macs to avoid
extra parsing of SMBIOS tables.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:MLB</code>
<code>BoardSerialNumber</code>. Present on newer Macs (2013+ at least)
to avoid extra parsing of SMBIOS tables, especially in
<code>boot.efi</code>.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ROM</code> Primary
network adapter MAC address or replacement value. Present on newer Macs
(2013+ at least) to avoid accessing special memory region, especially in
<code>boot.efi</code>.</p></li>
</ul>
<h2 id="nvramvarsrec">Recommended Variables</h2>
<p>The following variables are recommended for faster startup or other
improvements:</p>
<ul>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:BridgeOSHardwareModel</code>
Bridge OS hardware model variable used to propagate to IODT bridge-model
by <code>EfiBoot</code>. Read by <code>hw.target sysctl</code>, used by
SoftwareUpdateCoreSupport.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:csr-active-config</code>
-bit System Integrity Protection bitmask. Declared in XNU source code in
<a
href="https://opensource.apple.com/source/xnu/xnu-4570.71.2/bsd/sys/csr.h.auto.html">csr.h</a>.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ExtendedFirmwareFeatures</code>
Combined <code>FirmwareFeatures</code> and
<code>ExtendedFirmwareFeatures</code>. Present on newer Macs to avoid
extra parsing of SMBIOS tables.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ExtendedFirmwareFeaturesMask</code>
Combined <code>FirmwareFeaturesMask</code> and
<code>ExtendedFirmwareFeaturesMask</code>. Present on newer Macs to
avoid extra parsing of SMBIOS tables.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_BID</code> Hardware
<code>BoardProduct</code> (e.g. <code>Mac-35C1E88140C3E6CF</code>). Not
present on real Macs, but used to avoid extra parsing of SMBIOS tables,
especially in <code>boot.efi</code>.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_MLB</code> Hardware
<code>BoardSerialNumber</code>. Override for MLB. Present on newer Macs
(2013+ at least).</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_ROM</code> Hardware
ROM. Override for ROM. Present on newer Macs (2013+ at least).</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:SSN</code> Serial
number. Present on newer Macs (2013+ at least).</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:prev-lang:kbd</code>
ASCII string defining default keyboard layout. Format is
<code>lang-COUNTRY:keyboard</code>, e.g. <code>ru-RU:252</code> for
Russian locale and ABC keyboard. Also accepts short forms:
<code>ru:252</code> or <code>ru:0</code> (U.S. keyboard, compatible with
10.9). Full decoded keyboard list from
<code>AppleKeyboardLayouts-L.dat</code> can be found <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/AppleKeyboardLayouts">here</a>.
Using non-latin keyboard on 10.14 will not enable ABC keyboard, unlike
previous and subsequent macOS versions, and is thus not recommended in
case 10.14 is needed.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:security-mode</code>
ASCII string defining FireWire security mode. Legacy, can be found in
IOFireWireFamily source code in <a
href="https://opensource.apple.com/source/IOFireWireFamily/IOFireWireFamily-473/IOFireWireFamily.kmodproj/IOFireWireController.cpp.auto.html">IOFireWireController.cpp</a>.
It is recommended not to set this variable, which may speedup system
startup. Setting to <code>full</code> is equivalent to not setting the
variable and <code>none</code> disables FireWire security.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:UIScale</code>
One-byte data defining <code>boot.efi</code> user interface scaling.
Should be <strong>01</strong> for normal screens and <strong>02</strong>
for HiDPI screens.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:ForceDisplayRotationInEFI</code>
-bit integer defining display rotation. Can be <strong>0</strong> for no
rotation or any of <code>90</code>, <code>180</code>, <code>270</code>
for matching rotation in degrees.</p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:DefaultBackgroundColor</code>
Four-byte <code>BGRA</code> data defining <code>boot.efi</code> user
interface background colour. Standard colours include <strong>BF BF BF
00</strong> (Light Gray) and <strong>00 00 00 00</strong> (Syrah Black).
Other colours may be set at user’s preference.</p></li>
</ul>
<h2 id="nvramvarsother">Other Variables</h2>
<p>The following variables may be useful for certain configurations or
troubleshooting:</p>
<ul>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:boot-args</code>
Kernel arguments, used to pass configuration to Apple kernel and
drivers. There are many arguments, which may be found by looking for the
use of <code>PE_parse_boot_argn</code> function in the kernel or driver
code. Some of the known boot arguments include:</p>
<ul>
<li><p><code>acpi_layer=0xFFFFFFFF</code></p></li>
<li><p><code>acpi_level=0xFFFF5F</code> (implies <a
href="https://github.com/acpica/acpica/blob/master/source/include/acoutput.h"><code>ACPI_ALL_COMPONENTS</code></a>)</p></li>
<li><p><code>arch=i386</code> (force kernel architecture to
<code>i386</code>, see <code>KernelArch</code>)</p></li>
<li><p><code>batman=VALUE</code> (<code>AppleSmartBatteryManager</code>
debug mask)</p></li>
<li><p><code>batman-nosmc=1</code> (disable
<code>AppleSmartBatteryManager</code> SMC interface)</p></li>
<li><p><code>cpus=VALUE</code> (maximum number of CPUs used)</p></li>
<li><p><code>debug=VALUE</code> (debug mask)</p></li>
<li><p><code>io=VALUE</code> (<code>IOKit</code> debug mask)</p></li>
<li><p><code>ioaccel_debug=VALUE</code> (<code>IOAccelerator</code>
debug mask)</p></li>
<li><p><code>keepsyms=1</code> (show panic log debug symbols)</p></li>
<li><p><code>kextlog=VALUE</code> (kernel extension loading debug
mask)</p></li>
<li><p><code>nvram-log=1</code> (enables AppleEFINVRAM logs)</p></li>
<li><p><code>nv_disable=1</code> (disables NVIDIA GPU
acceleration)</p></li>
<li><p><code>nvda_drv=1</code> (legacy way to enable NVIDIA web driver,
removed in 10.12)</p></li>
<li><p><code>npci=0x2000</code> (<a
href="https://www.insanelymac.com/forum/topic/260539-1068-officially-released/?do=findComment&amp;comment=1707972">legacy</a>,
disables <code>kIOPCIConfiguratorPFM64</code>)</p></li>
<li><p><code>lapic_dont_panic=1</code> (disable lapic spurious interrupt
panic on AP cores)</p></li>
<li><p><code>panic_on_display_hang=1</code> (trigger panic on display
hang)</p></li>
<li><p><code>panic_on_gpu_hang=1</code> (trigger panic on GPU
hang)</p></li>
<li><p><code>serial=VALUE</code> (configure serial logging mode) — The
following bits are used by XNU:</p>
<ul>
<li><p><code>0x01</code> (<code>SERIALMODE_OUTPUT</code>, bit
<code>0</code>) — Enable serial output.</p></li>
<li><p><code>0x02</code> (<code>SERIALMODE_INPUT</code>, bit
<code>1</code>) — Enable serial input.</p></li>
<li><p><code>0x04</code> (<code>SERIALMODE_SYNCDRAIN</code>, bit
<code>2</code>) — Enable serial drain synchronisation.</p></li>
<li><p><code>0x08</code> (<code>SERIALMODE_BASE_TTY</code>, bit
<code>3</code>) — Load Base/Recovery/FVUnlock TTY.</p></li>
<li><p><code>0x10</code> (<code>SERIALMODE_NO_IOLOG</code>, bit
<code>4</code>) — Prevent IOLogs writing to serial.</p></li>
</ul></li>
<li><p><code>slide=VALUE</code> (manually set KASLR slide)</p></li>
<li><p><code>smcdebug=VALUE</code> (<code>AppleSMC</code> debug
mask)</p></li>
<li><p><code>spin_wait_for_gpu=1</code> (reduces GPU timeout on high
load)</p></li>
<li><p><code>-amd_no_dgpu_accel</code> (alternative to <a
href="https://github.com/acidanthera/WhateverGreen">WhateverGreen</a>’s
<code>-radvesa</code> for new GPUs)</p></li>
<li><p><code>-nehalem_error_disable</code> (disables the
AppleTyMCEDriver)</p></li>
<li><p><code>-no_compat_check</code> (disable model checking on
10.7+)</p></li>
<li><p><code>-s</code> (single mode)</p></li>
<li><p><code>-v</code> (verbose mode)</p></li>
<li><p><code>-x</code> (safe mode)</p></li>
</ul>
<p>There are multiple external places summarising macOS argument lists:
<a
href="https://osxeon.wordpress.com/2015/08/10/boot-argument-options-in-os-x">example
1</a>, <a
href="https://superuser.com/questions/255176/is-there-a-list-of-available-boot-args-for-darwin-os-x">example
2</a>.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:bootercfg</code>
Booter arguments, similar to <code>boot-args</code> but for
<code>boot.efi</code>. Accepts a set of arguments, which are hexadecimal
64-bit values with or without <code>0x</code>. At different stages
<code>boot.efi</code> will request different debugging (logging) modes
(e.g. after <code>ExitBootServices</code> it will only print to serial).
Several booter arguments control whether these requests will succeed.
The list of known requests is covered below:</p>
<ul>
<li><p><code>0x00</code> – <code>INIT</code>.</p></li>
<li><p><code>0x01</code> – <code>VERBOSE</code> (e.g. <code>-v</code>,
force console logging).</p></li>
<li><p><code>0x02</code> – <code>EXIT</code>.</p></li>
<li><p><code>0x03</code> – <code>RESET:OK</code>.</p></li>
<li><p><code>0x04</code> – <code>RESET:FAIL</code> (e.g. unknown
<code>board-id</code>, hibernate mismatch, panic loop, etc.).</p></li>
<li><p><code>0x05</code> – <code>RESET:RECOVERY</code>.</p></li>
<li><p><code>0x06</code> – <code>RECOVERY</code>.</p></li>
<li><p><code>0x07</code> – <code>REAN:START</code>.</p></li>
<li><p><code>0x08</code> – <code>REAN:END</code>.</p></li>
<li><p><code>0x09</code> – <code>DT</code> (can no longer log to
DeviceTree).</p></li>
<li><p><code>0x0A</code> – <code>EXITBS:START</code> (forced serial
only).</p></li>
<li><p><code>0x0B</code> – <code>EXITBS:END</code> (forced serial
only).</p></li>
<li><p><code>0x0C</code> – <code>UNKNOWN</code>.</p></li>
</ul>
<p>In 10.15, debugging support was defective up to the 10.15.4 release
due to refactoring issues as well as the introduction of a <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/Protocol/AppleDebugLog.h">new
debug protocol</a>. Some of the arguments and their values below may not
be valid for versions prior to 10.15.4. The list of known arguments is
covered below:</p>
<ul>
<li><p><code>boot-save-log=VALUE</code> — debug log save mode for normal
boot.</p>
<ul>
<li><p><code>0</code></p></li>
<li><p><code>1</code></p></li>
<li><p><code>2</code> — (default).</p></li>
<li><p><code>3</code></p></li>
<li><p><code>4</code> — (save to file).</p></li>
</ul></li>
<li><p><code>wake-save-log=VALUE</code> — debug log save mode for
hibernation wake.</p>
<ul>
<li><p><code>0</code> — disabled.</p></li>
<li><p><code>1</code></p></li>
<li><p><code>2</code> — (default).</p></li>
<li><p><code>3</code> — (unavailable).</p></li>
<li><p><code>4</code> — (save to file, unavailable).</p></li>
</ul></li>
<li><p><code>breakpoint=VALUE</code> — enables debug breaks (missing in
production <code>boot.efi</code>).</p>
<ul>
<li><p><code>0</code> — disables debug breaks on errors
(default).</p></li>
<li><p><code>1</code> — enables debug breaks on errors.</p></li>
</ul></li>
<li><p><code>console=VALUE</code> — enables console logging.</p>
<ul>
<li><p><code>0</code> — disables console logging.</p></li>
<li><p><code>1</code> — enables console logging when debug protocol is
missing (default).</p></li>
<li><p><code>2</code> — enables console logging unconditionally
(unavailable).</p></li>
</ul></li>
<li><p><code>embed-log-dt=VALUE</code> — enables DeviceTree logging.</p>
<ul>
<li><p><code>0</code> — disables DeviceTree logging (default).</p></li>
<li><p><code>1</code> — enables DeviceTree logging.</p></li>
</ul></li>
<li><p><code>kc-read-size=VALUE</code> — Chunk size used for buffered
I/O from network or disk for prelinkedkernel reading and related. Set to
1MB (0x100000) by default, can be tuned for faster booting.</p></li>
<li><p><code>log-level=VALUE</code> — log level bitmask.</p>
<ul>
<li><p><code>0x01</code> — enables trace logging (default).</p></li>
</ul></li>
<li><p><code>serial=VALUE</code> — enables serial logging.</p>
<ul>
<li><p><code>0</code> — disables serial logging (default).</p></li>
<li><p><code>1</code> — enables serial logging for
<code>EXITBS:END</code> onwards.</p></li>
<li><p><code>2</code> — enables serial logging for
<code>EXITBS:START</code> onwards.</p></li>
<li><p><code>3</code> — enables serial logging when debug protocol is
missing.</p></li>
<li><p><code>4</code> — enables serial logging unconditionally.</p></li>
</ul></li>
<li><p><code>timestamps=VALUE</code> — enables timestamp logging.</p>
<ul>
<li><p><code>0</code> — disables timestamp logging.</p></li>
<li><p><code>1</code> — enables timestamp logging (default).</p></li>
</ul></li>
<li><p><code>log=VALUE</code> — deprecated starting from 10.15.</p>
<ul>
<li><p><code>1</code> —
AppleLoggingConOutOrErrSet/AppleLoggingConOutOrErrPrint (classical
ConOut/StdErr)</p></li>
<li><p><code>2</code> — AppleLoggingStdErrSet/AppleLoggingStdErrPrint
(StdErr or serial?)</p></li>
<li><p><code>4</code> — AppleLoggingFileSet/AppleLoggingFilePrint
(BOOTER.LOG/BOOTER.OLD file on EFI partition)</p></li>
</ul></li>
<li><p><code>debug=VALUE</code> — deprecated starting from 10.15.</p>
<ul>
<li><p><code>1</code> — enables print something to BOOTER.LOG (stripped
code implies there may be a crash)</p></li>
<li><p><code>2</code> — enables perf logging to /efi/debug-log in the
device three</p></li>
<li><p><code>4</code> — enables timestamp printing for styled printf
calls</p></li>
</ul></li>
<li><p><code>level=VALUE</code> — deprecated starting from 10.15.
Verbosity level of DEBUG output. Everything but <code>0x80000000</code>
is stripped from the binary, and this is the default value.</p></li>
</ul>
<p><em>Note</em>: Enable the <code>AppleDebug</code> option to display
verbose output from <code>boot.efi</code> on modern macOS versions. This
will save the log to the general OpenCore log file. For versions before
10.15.4, set <code>bootercfg</code> to <code>log=1</code>. This will
print verbose output onscreen.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:bootercfg-once</code>
Booter arguments override removed after first launch. Otherwise
equivalent to <code>bootercfg</code>.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:csr-data</code>
Specify sources of kexts which will be approved regardless of SIP
<code>CSR_ALLOW_UNAPPROVED_KEXTS</code> value.<br />
Example contents:<br />
<code>&lt;dict&gt;&lt;key&gt;kext-allowed-teams&lt;/key&gt;&lt;array&gt;&lt;string&gt;{DEVELOPER-TEAM-ID}&lt;/string&gt;&lt;/array&gt;&lt;/dict&gt;%00</code></p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:efiboot-perf-record</code>
Enable performance log saving in <code>boot.efi</code>. Performance log
is saved to physical memory and is pointed to by the
<code>efiboot-perf-record-data</code> and
<code>efiboot-perf-record-size</code> variables. Starting from 10.15.4,
it can also be saved to the OpenCore log by setting the
<code>AppleDebug</code> option.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:fmm-computer-name</code>
Current saved host name. ASCII string.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:nvda_drv</code> NVIDIA
Web Driver control variable. Takes ASCII digit <code>1</code> or
<code>0</code> to enable or disable installed driver.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:run-efi-updater</code>
Override EFI firmware updating support in macOS (MultiUpdater, ThorUtil,
and so on). Setting this to <code>No</code> or alternative
boolean-castable value will prevent any firmware updates in macOS
starting with 10.10 at least.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:StartupMute</code>
Mute startup chime sound in firmware audio support. 8-bit integer. The
value of <code>0x00</code> means unmuted. Missing variable or any other
value means muted.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:SystemAudioVolume</code>
System audio volume level for firmware audio support. 8-bit unsigned
integer. The bit of <code>0x80</code> means muted. The remaining bits
are used to encode the raw amplifier gain setting to be applied to the
audio amplifier in use. Exactly what this value means depends on the
codec (and potentially on the specific amplifier within the codec). This
value is capped by macOS to the <code>MaximumBootBeepVolume</code>
AppleHDA layout value, to avoid over-loud audio playback in the
firmware.</p></li>
<li><p><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:SystemAudioVolumeDB</code>
Current system audio volume level in decibels (dB). 8-bit signed
integer. The value represents the audio offset (gain if positive,
attenuation if negative) in dB relative to the amplifier reference value
of 0 dB. Exactly which volume level is represented by 0 dB depends on
the codec (and potentially on the specific amplifier within the codec)
but it is normally at or near the maximum available amplifier volume.
Typical values of this variable range from approximately -60 (the exact
value depends on the audio hardware) up to exactly 0. On non-typical
audio hardware, the value may go above zero.</p>
<p><em>Note</em>: Unlike <code>SystemAudioVolume</code>, this value is
not capped.</p></li>
<li><p><code>5EDDA193-A070-416A-85EB-2A1181F45B18:PEXConf</code> PCI
expansion slot configuration for <code>MacPro7,1</code>. 8-byte sequence
describing default PCI slot configuration. Each byte refers to a
configuration for a dedicated PCI slot.</p>
<ul>
<li><p>Slot 1 resides at
<code>IOService:/AppleACPIPlatformExpert/PC01@0/AppleACPIPCI/BR1A@0</code>
and its path is hardcoded. This slot is not behind a muxer.</p></li>
<li><p>Slot 3 resides at
<code>IOService:/AppleACPIPlatformExpert/PC03@0/AppleACPIPCI/BR3A@0</code>
and its path is hardcoded. This slot is not behind a muxer.</p></li>
<li><p>Slots 2, 4-8 are dynamic and are matched based on
<code>AAPL,slot-name</code> property with <code>Slot-N</code> value,
where <code>N</code> is the slot number. All these slots are behind the
muxer.</p></li>
</ul>
<p>Refer to the <a href="https://support.apple.com/HT210104">support
page</a> for more details on how <code>MacPro7,1</code> slots are
configured.</p></li>
<li><p><code>5EDDA193-A070-416A-85EB-2A1181F45B18:SlotUtilPEXConf</code>
User PCI expansion slot configuration for <code>MacPro7,1</code>. 8-byte
sequence describing user PCI slot configuration.</p></li>
</ul>
<h1 id="platforminfo">PlatformInfo</h1>
<p>Platform information consists of several identification fields
generated or filled manually to be compatible with macOS services. The
base part of the configuration may be obtained from <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/AppleModels"><code>AppleModels</code></a>,
which itself generates a set of interfaces based on a database in <a
href="https://yaml.org/spec/1.2/spec.html">YAML</a> format. These fields
are written to three destinations:</p>
<ul>
<li><p><a
href="https://www.dmtf.org/standards/smbios">SMBIOS</a></p></li>
<li><p><a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Intel/Protocol/DataHub.h">Data
Hub</a></p></li>
<li><p>NVRAM</p></li>
</ul>
<p>Most of the fields specify the overrides in SMBIOS, and their field
names conform to EDK2 <a
href="https://github.com/acidanthera/audk/blob/master/MdePkg/Include/IndustryStandard/SmBios.h">SmBios.h</a>
header file. However, several important fields reside in Data Hub and
NVRAM. Some of the values can be found in more than one field and/or
destination, so there are two ways to control their update process:
manual, where all the values are specified (the default), and
semi-automatic, where (<code>Automatic</code>) only certain values are
specified, and later used for system configuration.</p>
<p>The <a href="http://www.nongnu.org/dmidecode">dmidecode</a> utility
can be used to inspect SMBIOS contents and a version with macOS specific
enhancements can be downloaded from <a
href="https://github.com/acidanthera/dmidecode/releases">Acidanthera/dmidecode</a>.</p>
<h2 id="platforminfoprops">Properties</h2>
<ol>
<li><p><code>Automatic</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Generate PlatformInfo based on the
<code>Generic</code> section instead of using values from the
<code>DataHub</code>, <code>NVRAM</code>, and <code>SMBIOS</code>
sections.</p>
<p>Enabling this option is useful when <code>Generic</code> section is
flexible enough:</p>
<ul>
<li><p>When enabled <code>SMBIOS</code>, <code>DataHub</code>, and
<code>PlatformNVRAM</code> data is unused.</p></li>
<li><p>When disabled <code>Generic</code> section is unused.</p></li>
</ul>
<p><strong>Warning</strong>: Setting this option to <code>false</code>
is strongly discouraged when intending to update platform information. A
<code>false</code> setting is typically only valid for minor corrections
to SMBIOS values on legacy Apple hardware. In all other cases, setting
<code>Automatic</code> to <code>false</code> may lead to hard-to-debug
errors resulting from inconsistent or invalid settings.</p></li>
<li><p><code>CustomMemory</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use custom memory configuration defined in
the <code>Memory</code> section. This completely replaces any existing
memory configuration in SMBIOS, and is only active when
<code>UpdateSMBIOS</code> is set to <code>true</code>.</p></li>
<li><p><code>DataHub</code><br />
<strong>Type</strong>: <code>plist dictionary</code><br />
<strong>Description</strong>: Update Data Hub fields in
non-<code>Automatic</code> mode.</p>
<p><em>Note</em>: This section is ignored and may be removed when
<code>Automatic</code> is <code>true</code>.</p></li>
<li><p><code>Generic</code><br />
<strong>Type</strong>: <code>plist dictionary</code><br />
<strong>Description</strong>: Update all fields in
<code>Automatic</code> mode.</p>
<p><em>Note</em>: This section is ignored but may not be removed when
<code>Automatic</code> is <code>false</code>.</p></li>
<li><p><code>Memory</code><br />
<strong>Type</strong>: <code>plist dictionary</code><br />
<strong>Description</strong>: Define custom memory configuration.</p>
<p><em>Note</em>: This section is ignored and may be removed when
<code>CustomMemory</code> is <code>false</code>.</p></li>
<li><p><code>PlatformNVRAM</code><br />
<strong>Type</strong>: <code>plist dictionary</code><br />
<strong>Description</strong>: Update platform NVRAM fields in
non-<code>Automatic</code> mode.</p>
<p><em>Note</em>: This section is ignored and may be removed when
<code>Automatic</code> is <code>true</code>.</p></li>
<li><p><code>SMBIOS</code><br />
<strong>Type</strong>: <code>plist dictionary</code><br />
<strong>Description</strong>: Update SMBIOS fields in
non-<code>Automatic</code> mode.</p>
<p><em>Note</em>: This section is ignored and may be removed when
<code>Automatic</code> is <code>true</code>.</p></li>
<li><p><code>UpdateDataHub</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Update Data Hub fields. These fields are
read from the <code>Generic</code> or <code>DataHub</code> sections
depending on the setting of the <code>Automatic</code> property.</p>
<p><em>Note</em>: The implementation of the Data Hub protocol in EFI
firmware on virtually all systems, including Apple hardware, means that
existing Data Hub entries cannot be overridden. New entries are added to
the end of the Data Hub instead, with macOS ignoring old entries. This
can be worked around by replacing the Data Hub protocol using the
<code>ProtocolOverrides</code> section. Refer to the
<code>DataHub</code> protocol override description for details.</p></li>
<li><p><code>UpdateNVRAM</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Update NVRAM fields related to platform
information.</p>
<p>These fields are read from the <code>Generic</code> or
<code>PlatformNVRAM</code> sections depending on the setting of the
<code>Automatic</code> property. All the other fields are to be
specified with the <code>NVRAM</code> section.</p>
<p>If <code>UpdateNVRAM</code> is set to <code>false</code>, the
aforementioned variables can be updated with the <a
href="#nvram"><code>NVRAM</code></a> section. If
<code>UpdateNVRAM</code> is set to <code>true</code>, the behaviour is
undefined when any of the fields are present in the <code>NVRAM</code>
section.</p></li>
<li><p><code>UpdateSMBIOS</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Update SMBIOS fields. These fields are
read from the <code>Generic</code> or <code>SMBIOS</code> sections
depending on the setting of the <code>Automatic</code>
property.</p></li>
<li><p><code>UpdateSMBIOSMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Create</code><br />
<strong>Description</strong>: Update SMBIOS fields approach:</p>
<ul>
<li><p><code>TryOverwrite</code> — <code>Overwrite</code> if new size is
&lt;= than the page-aligned original and there are no issues with legacy
region unlock. <code>Create</code> otherwise. Has issues on some types
of firmware.</p></li>
<li><p><code>Create</code> — Replace the tables with newly allocated
EfiReservedMemoryType at AllocateMaxAddress without any
fallbacks.</p></li>
<li><p><code>Overwrite</code> — Overwrite existing gEfiSmbiosTableGuid
and gEfiSmbiosTable3Guid data if it fits new size. Abort with
unspecified state otherwise.</p></li>
<li><p><code>Custom</code> — Write SMBIOS tables
(<code>gEfiSmbios(3)TableGuid</code>) to
<code>gOcCustomSmbios(3)TableGuid</code> to workaround firmware
overwriting SMBIOS contents at ExitBootServices. Otherwise equivalent to
<code>Create</code>. Requires patching AppleSmbios.kext and
AppleACPIPlatform.kext to read from another GUID:
<code>"EB9D2D31"</code> - <code>"EB9D2D35"</code> (in ASCII), done
automatically by <code>CustomSMBIOSGuid</code> quirk.</p></li>
</ul>
<p><em>Note</em>: A side effect of using the <code>Custom</code>
approach that it makes SMBIOS updates exclusive to macOS, avoiding a
collision with existing Windows activation and custom OEM software but
potentially obstructing the operation of Apple-specific tools.</p></li>
<li><p><code>UseRawUuidEncoding</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use raw encoding for SMBIOS UUIDs.</p>
<p>Each UUID <code>AABBCCDD-EEFF-GGHH-IIJJ-KKLLMMNNOOPP</code> is
essentially a hexadecimal 16-byte number. It can be encoded in two
ways:</p>
<ul>
<li><p><code>Big Endian</code> — by writing all the bytes as they are
without making any order changes
(<code>{AA BB CC DD EE FF GG HH II JJ KK LL MM NN OO PP}</code>). This
method is also known as <a
href="https://tools.ietf.org/html/rfc4122">RFC 4122</a> encoding or
<code>Raw</code> encoding.</p></li>
<li><p><code>Little Endian</code> — by interpreting the bytes as numbers
and using Little Endian byte representation
(<code>{DD CC BB AA FF EE HH GG II JJ KK LL MM NN OO PP}</code>).</p></li>
</ul>
<p>The SMBIOS specification did not explicitly specify the encoding
format for the UUID up to SMBIOS 2.6, where it stated that
<code>Little Endian</code> encoding shall be used. This led to the
confusion in both firmware implementations and system software as
different vendors used different encodings prior to that.</p>
<ul>
<li><p>Apple uses the <code>Big Endian</code> format everywhere but it
ignores SMBIOS UUID within macOS.</p></li>
<li><p><code>dmidecode</code> uses the <code>Big Endian</code> format
for SMBIOS 2.5.x or lower and the <code>Little Endian</code> format for
2.6 and newer. Acidanthera <a
href="https://github.com/acidanthera/dmidecode">dmidecode</a> prints all
three.</p></li>
<li><p>Windows uses the <code>Little Endian</code> format everywhere,
but this only affects the visual representation of the values.</p></li>
</ul>
<p>OpenCore always sets a recent SMBIOS version (currently 3.2) when
generating the modified DMI tables. If <code>UseRawUuidEncoding</code>
is enabled, the <code>Big Endian</code> format is used to store the
<code>SystemUUID</code> data. Otherwise, the <code>Little Endian</code>
format is used.</p>
<p><em>Note</em>: This preference does not affect UUIDs used in DataHub
and NVRAM as they are not standardised and are added by Apple. Unlike
SMBIOS, they are always stored in the <code>Big Endian</code>
format.</p></li>
</ol>
<h2 id="platforminfodatahub">DataHub Properties</h2>
<ol>
<li><p><code>ARTFrequency</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64-bit<br />
<strong>Failsafe</strong>: <code>0</code> (Automatic)<br />
<strong>Description</strong>: Sets <code>ARTFrequency</code> in
<code>gEfiProcessorSubClassGuid</code>.</p>
<p>This value contains CPU ART frequency, also known as crystal clock
frequency. Its existence is exclusive to the Skylake generation and
newer. The value is specified in Hz, and is normally 24 MHz for the
client Intel segment, 25 MHz for the server Intel segment, and 19.2 MHz
for Intel Atom CPUs. macOS till 10.15 inclusive assumes 24 MHz by
default.</p>
<p><em>Note</em>: On Intel Skylake X ART frequency may be a little less
(approx. 0.25%) than 24 or 25 MHz due to special EMI-reduction circuit
as described in <a
href="https://github.com/acidanthera/bugtracker/issues/448#issuecomment-524914166">Acidanthera
Bugtracker</a>.</p></li>
<li><p><code>BoardProduct</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>board-id</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is equal to
SMBIOS <code>BoardProduct</code> in ASCII.</p></li>
<li><p><code>BoardRevision</code><br />
<strong>Type</strong>: <code>plist data</code>, 1 byte<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Sets <code>board-rev</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs seems to
correspond to internal board revision (e.g. <code>01</code>).</p></li>
<li><p><code>DevicePathsSupported</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32-bit<br />
<strong>Failsafe</strong>: <code>0</code> (Not installed)<br />
<strong>Description</strong>: Sets <code>DevicePathsSupported</code> in
<code>gEfiMiscSubClassGuid</code>. Must be set to <code>1</code> for
AppleACPIPlatform.kext to append SATA device paths to
<code>Boot####</code> and <code>efi-boot-device-data</code> variables.
Set to <code>1</code> on all modern Macs.</p></li>
<li><p><code>FSBFrequency</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64-bit<br />
<strong>Failsafe</strong>: <code>0</code> (Automatic)<br />
<strong>Description</strong>: Sets <code>FSBFrequency</code> in
<code>gEfiProcessorSubClassGuid</code>.</p>
<p>Sets CPU FSB frequency. This value equals to CPU nominal frequency
divided by CPU maximum bus ratio and is specified in Hz. Refer to
<code>MSR_NEHALEM_PLATFORM_INFO</code> (<code>CEh</code>) MSR value to
determine maximum bus ratio on modern Intel CPUs.</p>
<p><em>Note</em>: This value is not used on Skylake and newer but is
still provided to follow suit.</p></li>
<li><p><code>InitialTSC</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64-bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Sets <code>InitialTSC</code> in
<code>gEfiProcessorSubClassGuid</code>. Sets initial TSC value, normally
0.</p></li>
<li><p><code>PlatformName</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>name</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is
<code>platform</code> in ASCII.</p></li>
<li><p><code>SmcBranch</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>RBr</code> in
<code>gEfiMiscSubClassGuid</code>. Custom property read by
<code>VirtualSMC</code> or <code>FakeSMC</code> to generate SMC
<code>RBr</code> key.</p></li>
<li><p><code>SmcPlatform</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>RPlt</code> in
<code>gEfiMiscSubClassGuid</code>. Custom property read by
<code>VirtualSMC</code> or <code>FakeSMC</code> to generate SMC
<code>RPlt</code> key.</p></li>
<li><p><code>SmcRevision</code><br />
<strong>Type</strong>: <code>plist data</code>, 6 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>REV</code> in
<code>gEfiMiscSubClassGuid</code>. Custom property read by
<code>VirtualSMC</code> or <code>FakeSMC</code> to generate SMC
<code>REV</code> key.</p></li>
<li><p><code>StartupPowerEvents</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64-bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Sets <code>StartupPowerEvents</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is power
management state bitmask, normally 0. Known bits read by
<code>X86PlatformPlugin.kext</code>:</p>
<ul>
<li><p><code>0x00000001</code> — Shutdown cause was a <code>PWROK</code>
event (Same as <code>GEN_PMCON_2</code> bit 0)</p></li>
<li><p><code>0x00000002</code> — Shutdown cause was a
<code>SYS_PWROK</code> event (Same as <code>GEN_PMCON_2</code> bit
1)</p></li>
<li><p><code>0x00000004</code> — Shutdown cause was a
<code>THRMTRIP#</code> event (Same as <code>GEN_PMCON_2</code> bit
3)</p></li>
<li><p><code>0x00000008</code> — Rebooted due to a SYS_RESET# event
(Same as <code>GEN_PMCON_2</code> bit 4)</p></li>
<li><p><code>0x00000010</code> — Power Failure (Same as
<code>GEN_PMCON_3</code> bit 1 <code>PWR_FLR</code>)</p></li>
<li><p><code>0x00000020</code> — Loss of RTC Well Power (Same as
<code>GEN_PMCON_3</code> bit 2 <code>RTC_PWR_STS</code>)</p></li>
<li><p><code>0x00000040</code> — General Reset Status (Same as
<code>GEN_PMCON_3</code> bit 9 <code>GEN_RST_STS</code>)</p></li>
<li><p><code>0xffffff80</code> — SUS Well Power Loss (Same as
<code>GEN_PMCON_3</code> bit 14)</p></li>
<li><p><code>0x00010000</code> — Wake cause was a ME Wake event (Same as
PRSTS bit 0, <code>ME_WAKE_STS</code>)</p></li>
<li><p><code>0x00020000</code> — Cold Reboot was ME Induced event (Same
as <code>PRSTS</code> bit 1 <code>ME_HRST_COLD_STS</code>)</p></li>
<li><p><code>0x00040000</code> — Warm Reboot was ME Induced event (Same
as <code>PRSTS</code> bit 2 <code>ME_HRST_WARM_STS</code>)</p></li>
<li><p><code>0x00080000</code> — Shutdown was ME Induced event (Same as
<code>PRSTS</code> bit 3 <code>ME_HOST_PWRDN</code>)</p></li>
<li><p><code>0x00100000</code> — Global reset ME Watchdog Timer event
(Same as <code>PRSTS</code> bit 6)</p></li>
<li><p><code>0x00200000</code> — Global reset PowerManagement Watchdog
Timer event (Same as <code>PRSTS</code> bit 15)</p></li>
</ul></li>
<li><p><code>SystemProductName</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>Model</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is equal to
SMBIOS <code>SystemProductName</code> in Unicode.</p></li>
<li><p><code>SystemSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>SystemSerialNumber</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is equal to
SMBIOS <code>SystemSerialNumber</code> in Unicode.</p></li>
<li><p><code>SystemUUID</code><br />
<strong>Type</strong>: <code>plist string</code>, GUID<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Sets <code>system-id</code> in
<code>gEfiMiscSubClassGuid</code>. The value found on Macs is equal to
SMBIOS <code>SystemUUID</code> (with swapped byte order).</p></li>
</ol>
<h2 id="platforminfogeneric">Generic Properties</h2>
<ol>
<li><p><code>AdviseFeatures</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Updates <code>FirmwareFeatures</code> with
supported bits.</p>
<p>Added bits to <code>FirmwareFeatures</code>:</p>
<ul>
<li><p><code>FW_FEATURE_SUPPORTS_CSM_LEGACY_MODE</code>
(<code>0x1</code>) - Without this bit, it is not possible to reboot to
Windows installed on a drive with an EFI partition that is not the first
partition on the disk.</p></li>
<li><p><code>FW_FEATURE_SUPPORTS_UEFI_WINDOWS_BOOT</code>
(<code>0x20000000</code>) - Without this bit, it is not possible to
reboot to Windows installed on a drive with an EFI partition that is the
first partition on the disk.</p></li>
<li><p><code>FW_FEATURE_SUPPORTS_APFS</code> (<code>0x00080000</code>) -
Without this bit, it is not possible to install macOS on an APFS
disk.</p></li>
<li><p><code>FW_FEATURE_SUPPORTS_LARGE_BASESYSTEM</code>
(<code>0x800000000</code>) - Without this bit, it is not possible to
install macOS versions with large BaseSystem images, such as macOS
12.</p></li>
</ul>
<p><em>Note</em>: On most newer firmwares these bits are already set,
the option may be necessary when "upgrading" the firmware with new
features.</p></li>
<li><p><code>MLB</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified or not installed)<br />
<strong>Description</strong>: Refer to SMBIOS
<code>BoardSerialNumber</code>.</p>
<p>Specify special string value <code>OEM</code> to extract current
value from NVRAM (<code>MLB</code> variable) or SMBIOS and use it
throughout the sections. This feature can only be used on Mac-compatible
firmware.</p></li>
<li><p><code>MaxBIOSVersion</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Sets <code>BIOSVersion</code> to
<code>9999.999.999.999.999</code>, recommended for legacy Macs when
using <code>Automatic</code> PlatformInfo, to avoid BIOS updates in
unofficially supported macOS versions.</p></li>
<li><p><code>ProcessorType</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (Automatic)<br />
<strong>Description</strong>: Refer to SMBIOS
<code>ProcessorType</code>.</p></li>
<li><p><code>ROM</code><br />
<strong>Type</strong>: <code>plist multidata</code>, 6 bytes<br />
<strong>Failsafe</strong>: Empty (OEM specified or not installed)<br />
<strong>Description</strong>: Refer to
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ROM</code>.</p>
<p>Specify special string value <code>OEM</code> to extract current
value from NVRAM (<code>ROM</code> variable) and use it throughout the
sections. This feature can only be used on Mac-compatible
firmware.</p></li>
<li><p><code>SpoofVendor</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Sets SMBIOS vendor fields to
<code>Acidanthera</code>.</p>
<p>It can be dangerous to use “Apple” in SMBIOS vendor fields for
reasons outlined in the <code>SystemManufacturer</code> description.
However, certain firmware may not provide valid values otherwise, which
could obstruct the operation of some software.</p></li>
<li><p><code>SystemMemoryStatus</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Indicates whether system memory is
upgradable in <code>PlatformFeature</code>. This controls the visibility
of the Memory tab in “About This Mac”.</p>
<p>Valid values:</p>
<ul>
<li><p><code>Auto</code> — use the original <code>PlatformFeature</code>
value.</p></li>
<li><p><code>Upgradable</code> — explicitly unset
<code>PT_FEATURE_HAS_SOLDERED_SYSTEM_MEMORY</code> (<code>0x2</code>) in
<code>PlatformFeature</code>.</p></li>
<li><p><code>Soldered</code> — explicitly set
<code>PT_FEATURE_HAS_SOLDERED_SYSTEM_MEMORY</code> (<code>0x2</code>) in
<code>PlatformFeature</code>.</p></li>
</ul>
<p><em>Note</em>: On certain Mac models, such as the
<code>MacBookPro10,x</code> and any <code>MacBookAir</code>,
SPMemoryReporter.spreporter will ignore
<code>PT_FEATURE_HAS_SOLDERED_SYSTEM_MEMORY</code> and assume that
system memory is non-upgradable.</p></li>
<li><p><code>SystemProductName</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified or not installed)<br />
<strong>Description</strong>: Refer to SMBIOS
<code>SystemProductName</code>.</p></li>
<li><p><code>SystemSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified or not installed)<br />
<strong>Description</strong>: Refer to SMBIOS
<code>SystemSerialNumber</code>.</p>
<p>Specify special string value <code>OEM</code> to extract current
value from NVRAM (<code>SSN</code> variable) or SMBIOS and use it
throughout the sections. This feature can only be used on Mac-compatible
firmware.</p></li>
<li><p><code>SystemUUID</code><br />
<strong>Type</strong>: <code>plist string</code>, GUID<br />
<strong>Failsafe</strong>: Empty (OEM specified or not installed)<br />
<strong>Description</strong>: Refer to SMBIOS
<code>SystemUUID</code>.</p>
<p>Specify special string value <code>OEM</code> to extract current
value from NVRAM (<code>system-id</code> variable) or SMBIOS and use it
throughout the sections. Since not every firmware implementation has
valid (and unique) values, this feature is not applicable to some
setups, and may provide unexpected results. It is highly recommended to
specify the UUID explicitly. Refer to <code>UseRawUuidEncoding</code> to
determine how SMBIOS value is parsed.</p></li>
</ol>
<h2 id="platforminfomemory">Memory Properties</h2>
<ol>
<li><p><code>DataWidth</code><br />
<strong>Type</strong>: <code>plist integer</code>, 16-bit<br />
<strong>Failsafe</strong>: <code>0xFFFF</code> (unknown)<br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Data Width<br />
<strong>Description</strong>: Specifies the data width, in bits, of the
memory. A <code>DataWidth</code> of <code>0</code> and a
<code>TotalWidth</code> of <code>8</code> indicates that the device is
being used solely to provide 8 error-correction bits.</p></li>
<li><p><code>Devices</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Specifies the custom memory devices to be
added.</p>
<p>To be filled with <code>plist dictionary</code> values, describing
each memory device. Refer to the <a
href="#platforminfomemorydevice">Memory Devices Properties</a> section
below. This should include all memory slots, even if
unpopulated.</p></li>
<li><p><code>ErrorCorrection</code><br />
<strong>Type</strong>: <code>plist integer</code>, 8-bit<br />
<strong>Failsafe</strong>: <code>0x03</code><br />
<strong>SMBIOS</strong>: Physical Memory Array (Type 16) — Memory Error
Correction<br />
<strong>Description</strong>: Specifies the primary hardware error
correction or detection method supported by the memory.</p>
<ul>
<li><p><code>0x01</code> — Other</p></li>
<li><p><code>0x02</code> — Unknown</p></li>
<li><p><code>0x03</code> — None</p></li>
<li><p><code>0x04</code> — Parity</p></li>
<li><p><code>0x05</code> — Single-bit ECC</p></li>
<li><p><code>0x06</code> — Multi-bit ECC</p></li>
<li><p><code>0x07</code> — CRC</p></li>
</ul></li>
<li><p><code>FormFactor</code><br />
<strong>Type</strong>: <code>plist integer</code>, 8-bit<br />
<strong>Failsafe</strong>: <code>0x02</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Form Factor<br />
<strong>Description</strong>: Specifies the form factor of the memory.
On Macs, this should typically be DIMM or SODIMM. Commonly used form
factors are listed below.</p>
<p>When <code>CustomMemory</code> is <code>false</code>, this value is
automatically set based on Mac product name.</p>
<p>When <code>Automatic</code> is <code>true</code>, the original value
from the the corresponding Mac model will be set if available.
Otherwise, the value from <code>OcMacInfoLib</code> will be set. When
<code>Automatic</code> is <code>false</code>, a user-specified value
will be set if available. Otherwise, the original value from the
firmware will be set. If no value is provided, the failsafe value will
be set.</p>
<ul>
<li><p><code>0x01</code> — Other</p></li>
<li><p><code>0x02</code> — Unknown</p></li>
<li><p><code>0x09</code> — DIMM</p></li>
<li><p><code>0x0D</code> — SODIMM</p></li>
<li><p><code>0x0F</code> — FB-DIMM</p></li>
</ul></li>
<li><p><code>MaxCapacity</code><br />
<strong>Type</strong>: <code>plist integer</code>, 64-bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>SMBIOS</strong>: Physical Memory Array (Type 16) — Maximum
Capacity<br />
<strong>Description</strong>: Specifies the maximum amount of memory, in
bytes, supported by the system.</p></li>
<li><p><code>TotalWidth</code><br />
<strong>Type</strong>: <code>plist integer</code>, 16-bit<br />
<strong>Failsafe</strong>: <code>0xFFFF</code> (unknown)<br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Total Width<br />
<strong>Description</strong>: Specifies the total width, in bits, of the
memory, including any check or error-correction bits. If there are no
error-correction bits, this value should be equal to
<code>DataWidth</code>.</p></li>
<li><p><code>Type</code><br />
<strong>Type</strong>: <code>plist integer</code>, 8-bit<br />
<strong>Failsafe</strong>: <code>0x02</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Memory Type<br />
<strong>Description</strong>: Specifies the memory type. Commonly used
types are listed below.</p>
<ul>
<li><p><code>0x01</code> — Other</p></li>
<li><p><code>0x02</code> — Unknown</p></li>
<li><p><code>0x0F</code> — SDRAM</p></li>
<li><p><code>0x12</code> — DDR</p></li>
<li><p><code>0x13</code> — DDR2</p></li>
<li><p><code>0x14</code> — DDR2 FB-DIMM</p></li>
<li><p><code>0x18</code> — DDR3</p></li>
<li><p><code>0x1A</code> — DDR4</p></li>
<li><p><code>0x1B</code> — LPDDR</p></li>
<li><p><code>0x1C</code> — LPDDR2</p></li>
<li><p><code>0x1D</code> — LPDDR3</p></li>
<li><p><code>0x1E</code> — LPDDR4</p></li>
</ul></li>
<li><p><code>TypeDetail</code><br />
<strong>Type</strong>: <code>plist integer</code>, 16-bit<br />
<strong>Failsafe</strong>: <code>0x4</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Type Detail<br />
<strong>Description</strong>: Specifies additional memory type
information.</p>
<ul>
<li><p><code>Bit 0</code> — Reserved, set to 0</p></li>
<li><p><code>Bit 1</code> — Other</p></li>
<li><p><code>Bit 2</code> — Unknown</p></li>
<li><p><code>Bit 7</code> — Synchronous</p></li>
<li><p><code>Bit 13</code> — Registered (buffered)</p></li>
<li><p><code>Bit 14</code> — Unbuffered (unregistered)</p></li>
</ul></li>
</ol>
<h3 id="platforminfomemorydevice">Memory Device Properties</h3>
<ol>
<li><p><code>AssetTag</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Asset Tag<br />
<strong>Description</strong>: Specifies the asset tag of this memory
device.</p></li>
<li><p><code>BankLocator</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Bank Locator<br />
<strong>Description</strong>: Specifies the physically labeled bank
where the memory device is located.</p></li>
<li><p><code>DeviceLocator</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Device Locator<br />
<strong>Description</strong>: Specifies the physically-labeled socket or
board position where the memory device is located.</p></li>
<li><p><code>Manufacturer</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Manufacturer<br />
<strong>Description</strong>: Specifies the manufacturer of this memory
device.</p>
<p>For empty slot this must be set to <code>NO DIMM</code> for macOS
System Profiler to correctly display memory slots on certain Mac models,
e.g. <code>MacPro7,1</code>. <code>MacPro7,1</code> imposes additional
requirements on the memory layout:</p>
<ul>
<li><p>The amount of installed sticks must one of the following: 4, 6,
8, 10, 12. Using any different value will cause an error in the System
Profiler.</p></li>
<li><p>The amount of memory slots must equal to 12. Using any different
value will cause an error in the System Profiler.</p></li>
<li><p>Memory sticks must be installed in dedicated memory slots as
explained on the <a href="https://support.apple.com/HT210103">support
page</a>. SMBIOS memory devices are mapped to the following slots:
<code>8, 7, 10, 9, 12, 11, 5, 6, 3, 4, 1, 2</code>.</p></li>
</ul></li>
<li><p><code>PartNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Part Number<br />
<strong>Description</strong>: Specifies the part number of this memory
device.</p></li>
<li><p><code>SerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Unknown</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Serial Number<br />
<strong>Description</strong>: Specifies the serial number of this memory
device.</p></li>
<li><p><code>Size</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32-bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Size<br />
<strong>Description</strong>: Specifies the size of the memory device,
in megabytes. <code>0</code> indicates this slot is not
populated.</p></li>
<li><p><code>Speed</code><br />
<strong>Type</strong>: <code>plist integer</code>, 16-bit<br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>SMBIOS</strong>: Memory Device (Type 17) — Speed<br />
<strong>Description</strong>: Specifies the maximum capable speed of the
device, in megatransfers per second (MT/s). <code>0</code> indicates an
unknown speed.</p></li>
</ol>
<h2 id="platforminfonvram">PlatformNVRAM Properties</h2>
<ol>
<li><p><code>BID</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Specifies the value of NVRAM variable
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_BID</code>.</p></li>
<li><p><code>FirmwareFeatures</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: This variable comes in pair with
<code>FirmwareFeaturesMask</code>. Specifies the values of NVRAM
variables:</p>
<ul>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:FirmwareFeatures</code></p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ExtendedFirmwareFeatures</code></p></li>
</ul></li>
<li><p><code>FirmwareFeaturesMask</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: This variable comes in pair with
<code>FirmwareFeatures</code>. Specifies the values of NVRAM
variables:</p>
<ul>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:FirmwareFeaturesMask</code></p></li>
<li><p><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ExtendedFirmwareFeaturesMask</code></p></li>
</ul></li>
<li><p><code>MLB</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Specifies the values of NVRAM variables
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_MLB</code> and
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:MLB</code>.</p></li>
<li><p><code>ROM</code><br />
<strong>Type</strong>: <code>plist data</code>, 6 bytes<br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Specifies the values of NVRAM variables
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_ROM</code> and
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:ROM</code>.</p></li>
<li><p><code>SystemSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Specifies the values of NVRAM variables
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:HW_SSN</code> and
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:SSN</code>.</p></li>
<li><p><code>SystemUUID</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Not installed)<br />
<strong>Description</strong>: Specifies the value of NVRAM variable
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:system-id</code> for boot
services only. The value found on Macs is equal to SMBIOS
<code>SystemUUID</code>.</p></li>
</ol>
<h2 id="platforminfosmbios">SMBIOS Properties</h2>
<ol>
<li><p><code>BIOSReleaseDate</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: BIOS Information (Type 0) — BIOS Release
Date<br />
<strong>Description</strong>: Firmware release date. Similar to
<code>BIOSVersion</code>. May look like
<code>12/08/2017</code>.</p></li>
<li><p><code>BIOSVendor</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: BIOS Information (Type 0) — Vendor<br />
<strong>Description</strong>: BIOS Vendor. All rules of
<code>SystemManufacturer</code> do apply.</p></li>
<li><p><code>BIOSVersion</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: BIOS Information (Type 0) — BIOS Version<br />
<strong>Description</strong>: Firmware version. This value gets updated
and takes part in update delivery configuration and macOS version
compatibility. This value could look like
<code>MM71.88Z.0234.B00.1809171422</code> in older firmware and is
described in <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/Guid/BiosId.h">BiosId.h</a>.
In newer firmware, it should look like <code>236.0.0.0.0</code> or
<code>220.230.16.0.0 (iBridge: 16.16.2542.0.0,0)</code>. iBridge version
is read from <code>BridgeOSVersion</code> variable, and is only present
on macs with T2.</p>
<pre><code>Apple ROM Version
 BIOS ID:      MBP151.88Z.F000.B00.1811142212
 Model:        MBP151
 EFI Version:  220.230.16.0.0
 Built by:     root@quinoa
 Date:         Wed Nov 14 22:12:53 2018
 Revision:     220.230.16 (B&amp;I)
 ROM Version:  F000_B00
 Build Type:   Official Build, RELEASE
 Compiler:     Apple LLVM version 10.0.0 (clang-1000.2.42)
 UUID:         E5D1475B-29FF-32BA-8552-682622BA42E1
 UUID:         151B0907-10F9-3271-87CD-4BF5DBECACF5</code></pre></li>
<li><p><code>BoardAssetTag</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) —
Asset Tag<br />
<strong>Description</strong>: Asset tag number. Varies, may be empty or
<code>Type2 - Board Asset Tag</code>.</p></li>
<li><p><code>BoardLocationInChassis</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) —
Location in Chassis<br />
<strong>Description</strong>: Varies, may be empty or
<code>Part Component</code>.</p></li>
<li><p><code>BoardManufacturer</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) -
Manufacturer<br />
<strong>Description</strong>: Board manufacturer. All rules of
<code>SystemManufacturer</code> do apply.</p></li>
<li><p><code>BoardProduct</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) -
Product<br />
<strong>Description</strong>: Mac Board ID (<code>board-id</code>). May
look like <code>Mac-7BA5B2D9E42DDD94</code> or <code>Mac-F221BEC8</code>
in older models.</p></li>
<li><p><code>BoardSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) —
Serial Number<br />
<strong>Description</strong>: Board serial number in defined format.
Known formats are described in <a
href="https://github.com/acidanthera/macserial/blob/master/FORMAT.md">macserial</a>.</p></li>
<li><p><code>BoardType</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) —
Board Type<br />
<strong>Description</strong>: Either <code>0xA</code> (Motherboard
(includes processor, memory, and I/O) or <code>0xB</code>
(Processor/Memory Module). Refer to Table 15 – Baseboard: Board Type for
details.</p></li>
<li><p><code>BoardVersion</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: Baseboard (or Module) Information (Type 2) -
Version<br />
<strong>Description</strong>: Board version number. Varies, may match
<code>SystemProductName</code> or
<code>SystemProductVersion</code>.</p></li>
<li><p><code>ChassisAssetTag</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Enclosure or Chassis (Type 3) — Asset
Tag Number<br />
<strong>Description</strong>: Chassis type name. Varies, could be empty
or <code>MacBook-Aluminum</code>.</p></li>
<li><p><code>ChassisManufacturer</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Enclosure or Chassis (Type 3) —
Manufacturer<br />
<strong>Description</strong>: Board manufacturer. All rules of
<code>SystemManufacturer</code> do apply.</p></li>
<li><p><code>ChassisSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Enclosure or Chassis (Type 3) —
Version<br />
<strong>Description</strong>: Should match
<code>SystemSerialNumber</code>.</p></li>
<li><p><code>ChassisType</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code> (OEM specified)<br />
<strong>SMBIOS</strong>: System Enclosure or Chassis (Type 3) —
Type<br />
<strong>Description</strong>: Chassis type. Refer to Table 17 — System
Enclosure or Chassis Types for details.</p></li>
<li><p><code>ChassisVersion</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Enclosure or Chassis (Type 3) —
Version<br />
<strong>Description</strong>: Should match
<code>BoardProduct</code>.</p></li>
<li><p><code>FirmwareFeatures</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: <code>0</code> (OEM specified on Apple
hardware, 0 otherwise)<br />
<strong>SMBIOS</strong>: <code>APPLE_SMBIOS_TABLE_TYPE128</code> -
<code>FirmwareFeatures</code> and
<code>ExtendedFirmwareFeatures</code><br />
<strong>Description</strong>: 64-bit firmware features bitmask. Refer to
<a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/IndustryStandard/AppleFeatures.h">AppleFeatures.h</a>
for details. Lower 32 bits match <code>FirmwareFeatures</code>. Upper 64
bits match <code>ExtendedFirmwareFeatures</code>.</p></li>
<li><p><code>FirmwareFeaturesMask</code><br />
<strong>Type</strong>: <code>plist data</code>, 8 bytes<br />
<strong>Failsafe</strong>: <code>0</code> (OEM specified on Apple
hardware, 0 otherwise)<br />
<strong>SMBIOS</strong>: <code>APPLE_SMBIOS_TABLE_TYPE128</code> -
<code>FirmwareFeaturesMask</code> and
<code>ExtendedFirmwareFeaturesMask</code><br />
<strong>Description</strong>: Supported bits of extended firmware
features bitmask. Refer to <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/IndustryStandard/AppleFeatures.h">AppleFeatures.h</a>
for details. Lower 32 bits match <code>FirmwareFeaturesMask</code>.
Upper 64 bits match <code>ExtendedFirmwareFeaturesMask</code>.</p></li>
<li><p><code>PlatformFeature</code><br />
<strong>Type</strong>: <code>plist integer</code>, 32-bit<br />
<strong>Failsafe</strong>: <code>0xFFFFFFFF</code> (OEM specified on
Apple hardware, do not provide the table otherwise)<br />
<strong>SMBIOS</strong>: <code>APPLE_SMBIOS_TABLE_TYPE133</code> -
<code>PlatformFeature</code><br />
<strong>Description</strong>: Platform features bitmask (Missing on
older Macs). Refer to <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/IndustryStandard/AppleFeatures.h">AppleFeatures.h</a>
for details.</p></li>
<li><p><code>ProcessorType</code><br />
<strong>Type</strong>: <code>plist integer</code>, 16-bit<br />
<strong>Failsafe</strong>: <code>0</code> (Automatic)<br />
<strong>SMBIOS</strong>: <code>APPLE_SMBIOS_TABLE_TYPE131</code> -
<code>ProcessorType</code><br />
<strong>Description</strong>: Combined of Processor Major and Minor
types.</p>
<p>Automatic value generation attempts to provide the most accurate
value for the currently installed CPU. When this fails, please raise an
<a href="https://github.com/acidanthera/bugtracker/issues">issue</a> and
provide <code>sysctl machdep.cpu</code> and <a
href="https://github.com/acidanthera/dmidecode"><code>dmidecode</code></a>
output. For a full list of available values and their limitations (the
value will only apply if the CPU core count matches), refer to the Apple
SMBIOS definitions header <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/IndustryStandard/AppleSmBios.h">here</a>.</p></li>
<li><p><code>SmcVersion</code><br />
<strong>Type</strong>: <code>plist data</code>, 16 bytes<br />
<strong>Failsafe</strong>: All zero (OEM specified on Apple hardware, do
not provide the table otherwise)<br />
<strong>SMBIOS</strong>: <code>APPLE_SMBIOS_TABLE_TYPE134</code> -
<code>Version</code><br />
<strong>Description</strong>: ASCII string containing SMC version in
upper case. Missing on T2 based Macs.</p></li>
<li><p><code>SystemFamily</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) — Family<br />
<strong>Description</strong>: Family name. May look like
<code>iMac Pro</code>.</p></li>
<li><p><code>SystemManufacturer</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) —
Manufacturer<br />
<strong>Description</strong>: OEM manufacturer of the particular board.
Use failsafe unless strictly required. Do not override to contain
<code>Apple Inc.</code> on non-Apple hardware, as this confuses numerous
services present in the operating system, such as firmware updates,
eficheck, as well as kernel extensions developed in Acidanthera, such as
Lilu and its plugins. In addition it will also make some operating
systems such as Linux unbootable.</p></li>
<li><p><code>SystemProductName</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1), Product Name<br />
<strong>Description</strong>: Preferred Mac model used to mark the
device as supported by the operating system. This value must be
specified by any configuration for later automatic generation of the
related values in this and other SMBIOS tables and related configuration
parameters. If <code>SystemProductName</code> is not compatible with the
target operating system, <code>-no_compat_check</code> boot argument may
be used as an override.</p>
<p><em>Note</em>: If <code>SystemProductName</code> is unknown, and
related fields are unspecified, default values should be assumed as
being set to <code>MacPro6,1</code> data. The list of known products can
be found in <code>AppleModels</code>.</p></li>
<li><p><code>SystemSKUNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) — SKU Number<br />
<strong>Description</strong>: Mac Board ID (<code>board-id</code>). May
look like <code>Mac-7BA5B2D9E42DDD94</code> or <code>Mac-F221BEC8</code>
in older models. Sometimes it can be just empty.</p></li>
<li><p><code>SystemSerialNumber</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) — Serial
Number<br />
<strong>Description</strong>: Product serial number in defined format.
Known formats are described in <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Utilities/macserial/FORMAT.md">macserial</a>.</p></li>
<li><p><code>SystemUUID</code><br />
<strong>Type</strong>: <code>plist string</code>, GUID<br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) — UUID<br />
<strong>Description</strong>: A UUID is an identifier that is designed
to be unique across both time and space. It requires no central
registration process.</p></li>
<li><p><code>SystemVersion</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (OEM specified)<br />
<strong>SMBIOS</strong>: System Information (Type 1) — Version<br />
<strong>Description</strong>: Product iteration version number. May look
like <code>1.1</code>.</p></li>
</ol>
<h1 id="uefi">UEFI</h1>
<h2 id="uefiintro">Introduction</h2>
<p><a href="https://uefi.org/specifications">UEFI</a> (Unified
Extensible Firmware Interface) is a specification that defines a
software interface between an operating system and platform firmware.
This section allows loading additional UEFI modules as well as applying
tweaks to the onboard firmware. To inspect firmware contents, apply
modifications and perform upgrades <a
href="https://github.com/LongSoft/UEFITool/releases">UEFITool</a> and
supplementary utilities can be used.</p>
<h2 id="uefidrivers">Drivers</h2>
<p>Depending on the firmware, a different set of drivers may be
required. Loading an incompatible driver may lead the system to
unbootable state or even cause permanent firmware damage. Some of the
known drivers are listed below:</p>
<table>
<tbody>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>AudioDxe</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#uefiaudio">HDA audio support
driver</a> in UEFI firmware for most Intel and some other analog audio
controllers. Staging driver, refer to <a
href="https://github.com/acidanthera/bugtracker/issues/740">acidanthera/bugtracker#740</a>
for known issues in AudioDxe.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OcBinaryData"><code>btrfs_x64</code></a></td>
<td style="text-align: left;">Open source BTRFS file system driver,
required for booting with <a href="#uefilinux">OpenLinuxBoot</a> from a
file system which is now quite commonly used with Linux.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>BiosVideo</code></a><strong>*</strong></td>
<td style="text-align: left;">CSM video driver implementing graphics
output protocol based on VESA and legacy BIOS interfaces. Used for UEFI
firmware with fragile GOP support (e.g. low resolution). Requires
<code>ReconnectGraphicsOnConnect</code>. Included in OpenDuet out of the
box.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>CrScreenshotDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">Screenshot making driver saving images to
the root of OpenCore partition (ESP) or any available writeable
filesystem upon pressing <code>F10</code>. Accepts optional driver
argument <code>--enable-mouse-click</code> to additionally take
screenshot on mouse click. (It is recommended to enable this option only
if a keypress would prevent a specific screenshot, and disable it again
after use.) This is a modified version of <a
href="https://github.com/LongSoft/CrScreenshotDxe"><code>CrScreenshotDxe</code></a>
driver by <a href="https://github.com/NikolajSchlej">Nikolaj
Schlej</a>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>EnableGop{Direct}</code></a><strong>*</strong></td>
<td style="text-align: left;">Early beta release firmware-embeddable
driver providing pre-OpenCore non-native GPU support on MacPro5,1.
Installation instructions can be found in the <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Staging/EnableGop/README.md"><code>Utilities/EnableGop</code></a>
directory of the OpenCore release zip file - proceed with caution.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OcBinaryData"><code>ExFatDxe</code></a></td>
<td style="text-align: left;">Proprietary ExFAT file system driver for
Bootcamp support commonly found in Apple firmware. For Sandy Bridge and
earlier CPUs, the <code>ExFatDxeLegacy</code> driver should be used due
to the lack of <code>RDRAND</code> instruction support.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OcBinaryData"><code>ext4_x64</code></a></td>
<td style="text-align: left;">Open source EXT4 file system driver,
required for booting with <a href="#uefilinux">OpenLinuxBoot</a> from
the file system most commonly used with Linux.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>FirmwareSettings</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#firmwaresettings">OpenCore
plugin</a> implementing <code>OC_BOOT_ENTRY_PROTOCOL</code> to add an
entry to the boot picker menu which reboots into UEFI firmware settings,
when this is supported by the firmware.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OcBinaryData"><code>HfsPlus</code></a></td>
<td style="text-align: left;">Recommended. Proprietary HFS file system
driver with bless support commonly found in Apple firmware. For Sandy
Bridge and earlier CPUs, the <code>HfsPlusLegacy</code> driver should be
used due to the lack of <code>RDRAND</code> instruction support.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>HiiDatabase</code></a><strong>*</strong></td>
<td style="text-align: left;">HII services support driver from
<code>MdeModulePkg</code>. This driver is included in most types of
firmware starting with the Ivy Bridge generation. Some applications with
GUI, such as UEFI Shell, may need this driver to work properly.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>EnhancedFatDxe</code></a></td>
<td style="text-align: left;">FAT filesystem driver from
<code>FatPkg</code>. This driver is embedded in all UEFI firmware and
cannot be used from OpenCore. Several types of firmware have defective
FAT support implementation that may lead to corrupted filesystems on
write attempts. Embedding this driver within the firmware may be
required in case writing to the EFI partition is needed during the boot
process.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>NvmExpressDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">NVMe support driver from
<code>MdeModulePkg</code>. This driver is included in most firmware
starting with the Broadwell generation. For Haswell and earlier,
embedding it within the firmware may be more favourable in case a NVMe
SSD drive is installed.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenCanopy</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#ueficanopy">OpenCore plugin</a>
implementing graphical interface.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenRuntime</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#uefiruntime">OpenCore plugin</a>
implementing <code>OC_FIRMWARE_RUNTIME</code> protocol.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenLegacyBoot</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#legacyboot">OpenCore plugin</a>
implementing <code>OC_BOOT_ENTRY_PROTOCOL</code> to allow detection and
booting of legacy operating systems from OpenCore on Macs, OpenDuet and
systems with a CSM.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenLinuxBoot</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#uefilinux">OpenCore plugin</a>
implementing <code>OC_BOOT_ENTRY_PROTOCOL</code> to allow direct
detection and booting of Linux distributions from OpenCore, without
chainloading via GRUB.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenNtfsDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">New Technologies File System (NTFS)
read-only driver. NTFS is the primary file system for Microsoft Windows
versions that are based on Windows NT.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenUsbKbDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">USB keyboard driver adding support for
<code>AppleKeyMapAggregator</code> protocols on top of a custom USB
keyboard driver implementation. This is an alternative to builtin
<code>KeySupport</code>, which may work better or worse depending on the
firmware.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenPartitionDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">Partition management driver with Apple
Partitioning Scheme support. This driver can be used to support loading
older DMG recoveries such as OS X 10.9 using Apple Partitioning Scheme,
or for loading other macOS Installers where these were created using the
Apple Partitioning Scheme (creating macOS Installers using GPT avoids
the need for this). OpenDuet already includes this driver.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenVariableRuntimeDxe</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#emunvram">OpenCore plugin</a>
offering emulated NVRAM support. OpenDuet already includes this
driver.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>Ps2KeyboardDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">PS/2 keyboard driver from
<code>MdeModulePkg</code>. <code>OpenDuetPkg</code> and some types of
firmware may not include this driver, but it is necessary for PS/2
keyboard to work. Note, unlike <code>OpenUsbKbDxe</code> this driver has
no <code>AppleKeyMapAggregator</code> support and thus requires
<code>KeySupport</code> to be enabled.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>Ps2MouseDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">PS/2 mouse driver from
<code>MdeModulePkg</code>. Some very old laptop firmware may not include
this driver but it is necessary for the touchpad to work in UEFI
graphical interfaces such as <code>OpenCanopy</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenHfsPlus</code></a><strong>*</strong></td>
<td style="text-align: left;">HFS file system driver with bless support.
This driver is an alternative to a closed source <code>HfsPlus</code>
driver commonly found in Apple firmware. While it is feature complete,
it is approximately 3 times slower and is yet to undergo a security
audit.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>ResetNvramEntry</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#uefiresetnvram">OpenCore
plugin</a> implementing <code>OC_BOOT_ENTRY_PROTOCOL</code> to add a
configurable <code>Reset NVRAM</code> entry to the boot picker
menu.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>ToggleSipEntry</code></a><strong>*</strong></td>
<td style="text-align: left;"><a href="#uefitogglesip">OpenCore
plugin</a> implementing <code>OC_BOOT_ENTRY_PROTOCOL</code> to add a
configurable <code>Toggle SIP</code> entry to the boot picker menu.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>UsbMouseDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">USB mouse driver from
<code>MdeModulePkg</code>. Some virtual machine firmware such as OVMF
may not include this driver but it is necessary for the mouse to work in
UEFI graphical interfaces such as <code>OpenCanopy</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/audk"><code>XhciDxe</code></a><strong>*</strong></td>
<td style="text-align: left;">XHCI USB controller support driver from
<code>MdeModulePkg</code>. This driver is included in most types of
firmware starting with the Sandy Bridge generation. For earlier firmware
or legacy systems, it may be used to support external USB 3.0 PCI
cards.</td>
</tr>
</tbody>
</table>
<p>Driver marked with <strong>*</strong> are bundled with OpenCore. To
compile the drivers from UDK (EDK II) the same command used for OpenCore
compilation can be taken, but choose a corresponding package:</p>
<pre id="compileudk" data-label="compileudk" style="ocbash"><code>git clone https://github.com/acidanthera/audk UDK
cd UDK
source edksetup.sh
make -C BaseTools
build -a X64 -b RELEASE -t XCODE5 -p FatPkg/FatPkg.dsc
build -a X64 -b RELEASE -t XCODE5 -p MdeModulePkg/MdeModulePkg.dsc</code></pre>
<h2 id="uefitools">Tools and Applications</h2>
<p>Standalone tools may help to debug firmware and hardware. Some of the
known tools are listed below. While some tools can be launched from
within OpenCore (Refer to the <a href="#misctools">Tools</a> subsection
for more details), most should be run separately either directly or from
<code>Shell</code>.</p>
<p>To boot into OpenShell or any other tool directly save
<code>OpenShell.efi</code> under the name of
<code>EFI\BOOT\BOOTX64.EFI</code> on a FAT32 partition. It is typically
unimportant whether the partition scheme is <code>GPT</code> or
<code>MBR</code>.</p>
<p>While the previous approach works both on Macs and other computers,
an alternative Mac-only approach to bless the tool on an HFS+ or APFS
volume:</p>
<pre id="blesstool" data-caption="Blessing tool" data-label="blesstool"
style="ocbash"><code>sudo bless --verbose --file /Volumes/VOLNAME/DIR/OpenShell.efi \
  --folder /Volumes/VOLNAME/DIR/ --setBoot</code></pre>
<p><em>Note 1</em>:
<code>/System/Library/CoreServices/BridgeVersion.bin</code> should be
copied to <code>/Volumes/VOLNAME/DIR</code>.<br />
<em>Note 2</em>: To be able to use the <code>bless</code> command, <a
href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/ConfiguringSystemIntegrityProtection/ConfiguringSystemIntegrityProtection.html">disabling
System Integrity Protection</a> is necessary.<br />
<em>Note 3</em>: To be able to boot <a
href="https://support.apple.com/HT208330">Secure Boot</a> might be
disabled if present.</p>
<p>Some of the known tools are listed below (builtin tools are marked
with <strong>*</strong>):</p>
<table>
<tbody>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>BootKicker</code></a><strong>*</strong></td>
<td style="text-align: left;">Display Apple BootPicker menu (for Macs
with compatible firmware).</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>ChipTune</code></a><strong>*</strong></td>
<td style="text-align: left;">Test BeepGen protocol and generate audio
signals of different style and length.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>CleanNvram</code></a><strong>*</strong></td>
<td style="text-align: left;">Reset NVRAM alternative bundled as a
standalone tool.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>CsrUtil</code></a><strong>*</strong></td>
<td style="text-align: left;">Simple implementation of SIP-related
features of Apple <code>csrutil</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>FontTester</code></a><strong>*</strong></td>
<td style="text-align: left;">Render the console font pages which the
<code>Builtin</code> renderer provides.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>GopStop</code></a><strong>*</strong></td>
<td style="text-align: left;">Test GraphicsOutput protocol with a <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Application/GopStop">simple
scenario</a>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>KeyTester</code></a><strong>*</strong></td>
<td style="text-align: left;">Test keyboard input in
<code>SimpleText</code> mode.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://www.memtest86.com"><code>MemTest86</code></a></td>
<td style="text-align: left;">Memory testing utility.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenControl</code></a><strong>*</strong></td>
<td style="text-align: left;">Unlock and lock back NVRAM protection for
other tools to be able to get full NVRAM access when launching from
OpenCore.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>OpenShell</code></a><strong>*</strong></td>
<td style="text-align: left;">OpenCore-configured <a
href="http://github.com/tianocore/edk2"><code>UEFI Shell</code></a> for
compatibility with a broad range of firmware.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>PavpProvision</code></a></td>
<td style="text-align: left;">Perform EPID provisioning (requires
certificate data configuration).</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>ResetSystem</code></a><strong>*</strong></td>
<td style="text-align: left;">Utility to perform system reset. Takes
reset type as an argument: <code>coldreset</code>,
<code>firmware</code>, <code>shutdown</code>, <code>warmreset</code>.
Defaults to <code>coldreset</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>RtcRw</code></a><strong>*</strong></td>
<td style="text-align: left;">Utility to read and write RTC (CMOS)
memory.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>ControlMsrE2</code></a><strong>*</strong></td>
<td style="text-align: left;">Check <code>CFG Lock</code> (MSR
<code>0xE2</code> write protection) consistency across all cores and
change such hidden options on selected platforms.</td>
</tr>
<tr>
<td style="text-align: left;"><a
href="https://github.com/acidanthera/OpenCorePkg"><code>TpmInfo</code></a><strong>*</strong></td>
<td style="text-align: left;">Check Intel PTT (Platform Trust
Technology) capability on the platform, which allows using fTPM 2.0 if
enabled. The tool does not check whether fTPM 2.0 is actually
enabled.</td>
</tr>
</tbody>
</table>
<h2 id="ueficanopy">OpenCanopy</h2>
<p>OpenCanopy is a graphical OpenCore user interface that runs in
<code>External</code> <code>PickerMode</code> and relies on <a
href="https://github.com/acidanthera/OpenCorePkg">OpenCorePkg</a>
<code>OcBootManagementLib</code> similar to the builtin text
interface.</p>
<p>OpenCanopy requires graphical resources located in
<code>Resources</code> directory to run. Sample resources (fonts and
images) can be found in <a
href="https://github.com/acidanthera/OcBinaryData">OcBinaryData
repository</a>. Customised icons can be found over the internet (e.g. <a
href="https://github.com/blackosx/OpenCanopyIcons">here</a> or <a
href="https://applelife.ru/threads/kastomizacija-opencanopy.2945020/">there</a>).</p>
<p>OpenCanopy provides full support for <code>PickerAttributes</code>
and offers a configurable builtin icon set. The chosen icon set may
depend on the <code>DefaultBackgroundColor</code> variable value. Refer
to <code>PickerVariant</code> for more details.</p>
<p>Predefined icons are saved in the <code>PickerVariant</code>-derived
subdirectory of the <code>\EFI\OC\Resources\Image</code> directory. A
full list of supported icons (in <code>.icns</code> format) is provided
below. When optional icons are missing, the closest available icon will
be used. External entries will use <code>Ext</code>-prefixed icon if
available (e.g. <code>OldExtHardDrive.icns</code>).</p>
<p><em>Note</em>: In the following all dimensions are normative for the
1x scaling level and shall be scaled accordingly for other levels.</p>
<ul>
<li><p><code>Cursor</code> — Mouse cursor (mandatory, up to
144x144).</p></li>
<li><p><code>Selected</code> — Selected item (mandatory,
144x144).</p></li>
<li><p><code>Selector</code> — Selecting item (mandatory, up to
144x40).</p></li>
<li><p><code>SetDefault</code> — Selecting default (mandatory, up to
144x40; must be same width as <code>Selector</code>).</p></li>
<li><p><code>Left</code> — Scrolling left (mandatory, 40x40).</p></li>
<li><p><code>Right</code> — Scrolling right (mandatory, 40x40).</p></li>
<li><p><code>HardDrive</code> — Generic OS (mandatory,
128x128).</p></li>
<li><p><code>Background</code> — Centred background image.</p></li>
<li><p><code>Apple</code> — Apple OS (128x128).</p></li>
<li><p><code>AppleRecv</code> — Apple Recovery OS (128x128).</p></li>
<li><p><code>AppleTM</code> — Apple Time Machine (128x128).</p></li>
<li><p><code>Windows</code> — Windows (128x128).</p></li>
<li><p><code>Other</code> — Custom entry (see <code>Entries</code>,
128x128).</p></li>
<li><p><code>ResetNVRAM</code> — Reset NVRAM system action or tool
(128x128).</p></li>
<li><p><code>Shell</code> — Entry with UEFI Shell name for e.g.
<code>OpenShell</code> (128x128).</p></li>
<li><p><code>Tool</code> — Any other tool (128x128).</p></li>
</ul>
<p>Predefined labels are saved in the
<code>\EFI\OC\Resources\Label</code> directory. Each label has
<code>.lbl</code> or <code>.l2x</code> suffix to represent the scaling
level. Full list of labels is provided below. All labels are
mandatory.</p>
<ul>
<li><p><code>EFIBoot</code> — Generic OS.</p></li>
<li><p><code>Apple</code> — Apple OS.</p></li>
<li><p><code>AppleRecv</code> — Apple Recovery OS.</p></li>
<li><p><code>AppleTM</code> — Apple Time Machine.</p></li>
<li><p><code>Windows</code> — Windows.</p></li>
<li><p><code>Other</code> — Custom entry (see
<code>Entries</code>).</p></li>
<li><p><code>ResetNVRAM</code> — Reset NVRAM system action or
tool.</p></li>
<li><p><code>SIPDisabled</code> — Toggle SIP tool with SIP
disabled.</p></li>
<li><p><code>SIPEnabled</code> — Toggle SIP tool with SIP
enabled.</p></li>
<li><p><code>Shell</code> — Entry with UEFI Shell name (e.g.
<code>OpenShell</code>).</p></li>
<li><p><code>FirmwareSettings</code> — Firmware settings menu
entry.</p></li>
<li><p><code>Tool</code> — Any other tool.</p></li>
</ul>
<p><em>Note</em>: All labels must have a height of exactly 12 px. There
is no limit for their width.</p>
<p>Label and icon generation can be performed with bundled utilities:
<code>disklabel</code> and <code>icnspack</code>. Font is Helvetica 12
pt times scale factor.</p>
<p>Font format corresponds to <a
href="https://www.angelcode.com/products/bmfont">AngelCode binary
BMF</a>. While there are many utilities to generate font files,
currently it is recommended to use <a
href="https://github.com/danpla/dpfontbaker">dpFontBaker</a> to generate
bitmap font (<a
href="https://github.com/danpla/dpfontbaker/pull/1">using CoreText
produces best results</a>) and <a
href="https://github.com/usr-sse2/fonverter">fonverter</a> to export it
to binary format.</p>
<h2 id="uefiruntime">OpenRuntime</h2>
<p><code>OpenRuntime</code> is an OpenCore plugin implementing
<code>OC_FIRMWARE_RUNTIME</code> protocol. This protocol implements
multiple features required for OpenCore that are otherwise not possible
to implement in OpenCore itself as they are needed to work in runtime,
i.e. during operating system functioning. Feature highlights:</p>
<ul>
<li><p>NVRAM namespaces, allowing to isolate operating systems from
accessing select variables (e.g. <code>RequestBootVarRouting</code> or
<code>ProtectSecureBoot</code>).</p></li>
<li><p>Read-only and write-only NVRAM variables, enhancing the security
of OpenCore, Lilu, and Lilu plugins, such as VirtualSMC, which
implements <code>AuthRestart</code> support.</p></li>
<li><p>NVRAM isolation, allowing to protect all variables from being
written from an untrusted operating system (e.g.
<code>DisableVariableWrite</code>).</p></li>
<li><p>UEFI Runtime Services memory protection management to workaround
read-only mapping (e.g. <code>EnableWriteUnprotector</code>).</p></li>
</ul>
<h2 id="legacyboot">OpenLegacyBoot</h2>
<p>OpenLegacyBoot is an OpenCore plugin implementing
<code>OC_BOOT_ENTRY_PROTOCOL</code>. It aims to detect and boot legacy
installed operating systems on supported systems, such as OpenDuet and
Mac models capable of legacy booting.</p>
<p>Usage:</p>
<ul>
<li><p>Add <code>OpenLegacyBoot.efi</code> and also optionally (see
below) <code>OpenNtfsDxe.efi</code> to the <code>config.plist</code>
<code>Drivers</code> section.</p></li>
<li><p>Install Windows or another legacy operating system as normal if
this has not been done earlier – OpenLegacyBoot is not involved in this
stage and may be unable to boot from installation media such as a USB
device.</p></li>
<li><p>Reboot into OpenCore: the installed legacy operating system
should appear and boot directly from OpenCore when selected.</p></li>
</ul>
<p>OpenLegacyBoot does not require any additional filesystem drivers
such as <code>OpenNtfsDxe.efi</code> to be loaded for base
functionality, but loading them will enable the use of
<code>.contentDetails</code> and <code>.VolumeIcon.icns</code> files for
boot entry customisation.</p>
<h3 id="configuration">Configuration</h3>
<p>No additional configuration should work well in most circumstances,
but if required the following options for the driver may be specified in
<code>UEFI/Drivers/Arguments</code>:</p>
<ul>
<li><p><code>--hide-devices</code> - String value, no default.</p>
<p>When this option is present and has one or more values separated by
semicolons<br />
(e.g.
--hide-devices=PciRoot(0x0)/Pci(0x1F,0x2)/Sata(0x0,0xFFFF,0x0)/HD(2,GPT,...)),
it disables scanning the specified disks for legacy operating system
boot sectors.</p></li>
</ul>
<h2 id="uefilinux">OpenLinuxBoot</h2>
<p>OpenLinuxBoot is an OpenCore plugin implementing
<code>OC_BOOT_ENTRY_PROTOCOL</code>. It aims to automatically detect and
boot most Linux distros without additional configuration.</p>
<p>Usage is as follows:</p>
<ul>
<li><p>Add <code>OpenLinuxBoot.efi</code> and also typically (see below)
<code>ext4_x64.efi</code> to the <code>config.plist</code>
<code>Drivers</code> section.</p></li>
<li><p>Make sure <code>RequestBootVarRouting</code> and
<code>LauncherOption</code> are enabled in <code>config.plist</code>; it
is also recommended to enable <code>HideAuxiliary</code> in order to
hide older Linux kernels except when required (they are added as
auxiliary entries and so may then be shown by pressing the
<code>Spacebar</code> key in the OpenCore boot menu).</p></li>
<li><p>Install Linux as normal if this has not been done earlier –
OpenLinuxBoot is not involved in this stage.</p></li>
<li><p>Reboot into OpenCore: the installed Linux distribution should
just appear and boot directly from OpenCore when selected, which it does
without chainloading via GRUB.</p></li>
</ul>
<p>If OpenCore has already been manually set up to boot Linux, e.g. via
<code>BlessOverride</code> or via <code>Entries</code> then then these
settings may be removed so that the Linux distribution is not displayed
twice in the boot menu.</p>
<p>It is recommended to install Linux with its default bootloader, even
though this will not be actively used when booting via OpenLinuxBoot.
This is because OpenLinuxBoot has to detect the correct kernel options
to use, and does so by looking in files left by the default bootloader.
If no bootloader was installed (or these options cannot be found)
booting is still possible, but the correct boot options must be manually
specified before OpenLinuxBoot will attempt to start the distro.</p>
<p>OpenLinuxBoot typically requires filesystem drivers that are not
available in firmware, such as EXT4 and BTRFS drivers. These drivers can
be obtained from external sources. Drivers tested in basic scenarios can
be downloaded from <a
href="https://github.com/acidanthera/OcBinaryData">OcBinaryData</a>. Be
aware that these drivers are not tested for reliability in all
scenarious, nor did they undergo tamper-resistance testing, therefore
they may carry potential security or data-loss risks.</p>
<p>Most Linux distros require the <a
href="https://github.com/acidanthera/OcBinaryData"><code>ext4_x64</code></a>
driver, a few may require the <a
href="https://github.com/acidanthera/OcBinaryData"><code>btrfs_x64</code></a>
driver, and a few may require no additional file system driver: it
depends on the filesystem of the boot partition of the installed distro,
and on what filesystems are already supported by the system’s firmware.
LVM is not currently supported - this is because it is not believed that
there is currently a stand-alone UEFI LVM filesystem driver.</p>
<p>Be aware of the <code>SyncRuntimePermissions</code> quirk, which may
need to be set to avoid early boot failure (typically halting with a
black screen) of the Linux kernel, due to a firmware bug of some
firmware released after 2017. When present and not mitigated by this
quirk, this affects booting via OpenCore with or without
OpenLinuxBoot.</p>
<p>After installing OpenLinuxBoot, it is recommended to compare the
options shown in the OpenCore debug log when booting (or attempting to
boot) a given distro against the options seen using the shell command
<code>cat /proc/cmdline</code> when the same distro has been booted via
its native bootloader. In general (for safety and security of the
running distro) these options should match, and if they do not it is
recommended to use the driver arguments below (in particular
<code>LINUX_BOOT_ADD_RO</code>, <code>LINUX_BOOT_ADD_RW</code>,
<code>autoopts:{PARTUUID}</code> and <code>autoopts</code>) to modify
the options as required. Note however that the following differences are
normal and do not need to be fixed:</p>
<ul>
<li><p>If the default bootloader is GRUB then the options generated by
OpenLinuxBoot will not contain a <code>BOOT_IMAGE=...</code> value where
the GRUB options do, and will contain an <code>initrd=...</code> value
where the GRUB options do not.</p></li>
<li><p>OpenLinuxBoot uses <code>PARTUUID</code> rather than filesystem
<code>UUID</code> to identify the location of <code>initrd</code>, this
is by design as UEFI filesystem drivers do not make Linux filesystem
<code>UUID</code> values available.</p></li>
<li><p>Less important graphics handover options (such as discussed in
the Ubuntu example given in <code>autoopts</code> below) will not match
exactly, this is not important as long as distro boots
successfully.</p></li>
</ul>
<p>If using OpenLinuxBoot with Secure Boot, users may wish to install a
user built, user signed Shim bootloader giving SBAT and MOK integration,
as explained in <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/ShimUtils">OpenCore
ShimUtils</a>.</p>
<h3 id="configuration-1">Configuration</h3>
<p>The default parameter values should work well with no changes under
most circumstances, but if required the following options for the driver
may be specified in <code>UEFI/Drivers/Arguments</code>:</p>
<ul>
<li><p><code>flags</code> - Default: all flags are set except the
following:</p>
<ul>
<li><p><code>LINUX_BOOT_ADD_RW</code>,</p></li>
<li><p><code>LINUX_BOOT_LOG_VERBOSE</code> and</p></li>
<li><p><code>LINUX_BOOT_ADD_DEBUG_INFO</code>.</p></li>
</ul>
<p>Available flags are:</p>
<ul>
<li><p><code>0x00000001</code> (bit <code>0</code>) —
<code>LINUX_BOOT_SCAN_ESP</code>, Allows scanning for entries on EFI
System Partition.</p></li>
<li><p><code>0x00000002</code> (bit <code>1</code>) —
<code>LINUX_BOOT_SCAN_XBOOTLDR</code>, Allows scanning for entries on
Extended Boot Loader Partition.</p></li>
<li><p><code>0x00000004</code> (bit <code>2</code>) —
<code>LINUX_BOOT_SCAN_LINUX_ROOT</code>, Allows scanning for entries on
Linux Root filesystems.</p></li>
<li><p><code>0x00000008</code> (bit <code>3</code>) —
<code>LINUX_BOOT_SCAN_LINUX_DATA</code>, Allows scanning for entries on
Linux Data filesystems.</p></li>
<li><p><code>0x00000080</code> (bit <code>7</code>) —
<code>LINUX_BOOT_SCAN_OTHER</code>, Allows scanning for entries on file
systems not matched by any of the above.</p>
<p>The following notes apply to all of the above options:</p>
<p><em>Note 1</em>: Apple filesystems APFS and HFS are never
scanned.</p>
<p><em>Note 2</em>: Regardless of the above flags, a file system must
first be allowed by <code>Misc/Security/ScanPolicy</code> before it can
be seen by OpenLinuxBoot or any other
<code>OC_BOOT_ENTRY_PROTOCOL</code> driver.</p>
<p><em>Note 3</em>: It is recommended to enable scanning
<code>LINUX_ROOT</code> and <code>LINUX_DATA</code> in both
OpenLinuxBoot flags and <code>Misc/Security/ScanPolicy</code> in order
to be sure to detect all valid Linux installs, since Linux boot
filesystems are very often marked as <code>LINUX_DATA</code>.</p></li>
<li><p><code>0x00000100</code> (bit <code>8</code>) —
<code>LINUX_BOOT_ALLOW_AUTODETECT</code>, If set allows autodetecting
and linking <code>vmlinuz*</code> and <code>init*</code> ramdisk files
when <code>loader/entries</code> files are not found.</p></li>
<li><p><code>0x00000200</code> (bit <code>9</code>) —
<code>LINUX_BOOT_USE_LATEST</code>, When a Linux entry generated by
OpenLinuxBoot is selected as the default boot entry in OpenCore,
automatically switch to the latest kernel when a new version is
installed.</p>
<p>When this option is set, an internal menu entry id is shared between
kernel versions from the same install of Linux. Linux boot options are
always sorted highest kernel version first, so this means that the
latest kernel version of the same install always shows as the default,
with this option set.</p>
<p><em>Note</em>: This option is recommended on all systems.</p></li>
<li><p><code>0x00000400</code> (bit <code>10</code>) —
<code>LINUX_BOOT_ADD_RO</code>, This option applies to autodetected
Linux only (i.e. not to BLSpec or Fedora-style distributions which have
<code>/loader/entries/*.conf</code> files). Some distributions run a
filesystem check on loading which requires the root filesystem to
initially be mounted read-only via the <code>ro</code> kernel option,
which requires this option to be added to the autodetected options. Set
this bit to add this option on autodetected distros; should be harmless
but very slightly slow down boot time (due to requried remount as
read-write) on distros which do not require it. When there are multiple
distros and it is required to specify this option for specific distros
only, use <code>autoopts:{PARTUUID}+=ro</code> to manually add the
option where required, instead of using this flag.</p></li>
<li><p><code>0x00000800</code> (bit <code>11</code>) —
<code>LINUX_BOOT_ADD_RW</code>, Like <code>LINUX_BOOT_ADD_RO</code>,
this option applies to autodetected Linux only. It is not required for
most distros (which usually require either <code>ro</code> or nothing to
be added to detected boot options), but is required on some Arch-derived
distros, e.g. EndeavourOS. When there are multiple distros and it is
required to specify this option for specific distros only, use
<code>autoopts:{PARTUUID}+=rw</code> to manually add the option where
required, instead of using this flag. If this option and
<code>LINUX_BOOT_ADD_RO</code> are both specified, only this option is
applied and <code>LINUX_BOOT_ADD_RO</code> is ignored.</p></li>
<li><p><code>0x00002000</code> (bit <code>13</code>) —
<code>LINUX_BOOT_ALLOW_CONF_AUTO_ROOT</code>, In some instances of
<code>BootLoaderSpecByDefault</code> in combination with
<code>ostree</code>, the <code>/loader/entries/*.conf</code> files do
not specify a required <code>root=...</code> kernel option – it is added
by GRUB. If this bit is set and this situation is detected, then
automatically add this option. (Required for example by Endless
OS.)</p></li>
<li><p><code>0x00004000</code> (bit <code>14</code>) —
<code>LINUX_BOOT_LOG_VERBOSE</code>, Add additional debug log info about
files encountered and autodetect options added while scanning for Linux
boot entries.</p></li>
<li><p><code>0x00008000</code> (bit <code>15</code>) —
<code>LINUX_BOOT_ADD_DEBUG_INFO</code>, Adds a human readable file
system type, followed by the first eight characters of the partition’s
unique partition uuid, to each generated entry name. Can help with
debugging the origin of entries generated by the driver when there are
multiple Linux installs on one system.</p></li>
</ul>
<p>Flag values can be specified in hexadecimal beginning with
<code>0x</code> or in decimal, e.g. <code>flags=0x80</code> or
<code>flags=128</code>. It is also possible to specify flags to add or
remove, using syntax such as <code>flags+=0xC000</code> to add all
debugging options or <code>flags-=0x400</code> to remove the
<code>LINUX_BOOT_ADD_RO</code> option.</p></li>
<li><p><code>autoopts:{PARTUUID}[+]="{options}"</code> - Default: not
set.</p>
<p>Allows manually specifying kernel options to use in autodetect mode
for a given partition only. Replace the text <code>{PARTUUID}</code>
with the specific partition UUID on which the kernels are stored (in
normal layout, the partition which contains <code>/boot</code>), e.g.
<code>autoopts:11223344-5566-7788-99aa-bbccddeeff00+="vt.handoff=7"</code>.
If specified with <code>+=</code> then these options are used in
addition to any autodetected options, if specified with <code>=</code>
they are used instead. Used for autodetected Linux only – values
specified here are never used for entries created from
<code>/loader/entries/*.conf</code> files.</p>
<p><em>Note</em>: The <code>PARTUUID</code> value to be specified here
is typically the same as the <code>PARTUUID</code> seen in
<code>root=PARTUUID=...</code> in the Linux kernel boot options (view
using <code>cat /proc/cmdline</code>). Alternatively, and for more
advanced scenarios, it is possible to examine how the distro’s
partitions are mounted using the Linux <code>mount</code> command, and
then find out the partuuid of relevant mounted partitions by examining
the output of <code>ls -l /dev/disk/by-partuuid</code>.</p></li>
<li><p><code>autoopts[+]="{options}"</code> - Default: None
specified.</p>
<p>Allows manually specifying kernel options to use in autodetect mode.
The alternative format <code>autoopts:{PARTUUID}</code> is more suitable
where there are multiple distros, but <code>autoopts</code> with no
PARTUUID required may be more convenient for just one distro. If
specified with <code>+=</code> then these are used in addition to
autodetected options, if specified with <code>=</code> they are used
instead. Used for autodetected Linux only – values specified here are
never used for entries created from <code>/loader/entries/*.conf</code>
files.</p>
<p>As example usage, it is possible to use <code>+=</code> format to add
a <code>vt.handoff</code> options, such as
<code>autoopts+="vt.handoff=7"</code> or
<code>autoopts+="vt.handoff=3"</code> (check
<code>cat /proc/cmdline</code> when booted via the distro’s default
bootloader) on Ubuntu and related distros, in order to add the
<code>vt.handoff</code> option to the auto-detected GRUB defaults, and
avoid a flash of text showing before the distro splash screen.</p></li>
</ul>
<h3 id="additional-information">Additional information</h3>
<p>OpenLinuxBoot can detect the <code>loader/entries/*.conf</code> files
created according to the <a
href="https://systemd.io/BOOT_LOADER_SPECIFICATION/">Boot Loader
Specification</a> or the closely related <a
href="https://fedoraproject.org/wiki/Changes/BootLoaderSpecByDefault">systemd
BootLoaderSpecByDefault</a>. The former is specific to systemd-boot and
is used by Arch Linux, the latter applies to most Fedora-related distros
including Fedora itself, RHEL and variants.</p>
<p>Where the above files are not present, OpenLinuxBoot can autodetect
and boot <code>{boot}/vmlinuz*</code> kernel files directly. It links
these automatically – based on the kernel version in the filename – to
their associated <code>{boot}/init*</code> ramdisk files. This applies
to most Debian-related distros, including Debian itself, Ubuntu and
variants.</p>
<p>When autodetecting in <code>/boot</code> as part of the root
filesystem, OpenLinuxBoot looks in <code>/etc/default/grub</code> for
kernel boot options and <code>/etc/os-release</code> for the distro
name. When autodetecting in a standalone boot partition (i.e. when
<code>/boot</code> has its own mount point), OpenLinuxBoot cannot
autodetect kernel arguments and all kernel arguments except
<code>initrd=...</code> must be fully specified by hand using
<code>autoopts=...</code> or <code>autoopts:{partuuid}=...</code>
(<code>+=</code> variants of these options will not work, as these only
add additional arguments).</p>
<p>BootLoaderSpecByDefault (but not pure Boot Loader Specification) can
expand GRUB variables in the <code>*.conf</code> files – and this is
used in practice in certain distros such as CentOS. In order to handle
this correctly, when this situation is detected OpenLinuxBoot extracts
all variables from <code>{boot}/grub2/grubenv</code> and also any
unconditionally set variables from <code>{boot}/grub2/grub.cfg</code>,
and then expands these where required in <code>*.conf</code> file
entries.</p>
<p>The only currently supported method of starting Linux kernels relies
on their being compiled with EFISTUB. This applies to almost all modern
distros, particularly those which use systemd. Note that most modern
distros use systemd as their system manager, even though most do not use
systemd-boot as their bootloader.</p>
<p>systemd-boot users (probably almost exclusively Arch Linux users)
should be aware that OpenLinuxBoot does not support the
systemd-boot–specific <a
href="https://systemd.io/BOOT_LOADER_INTERFACE/">Boot Loader
Interface</a>; therefore <code>efibootmgr</code> rather than
<code>bootctl</code> must be used for any low-level Linux command line
interaction with the boot menu.</p>
<h2 id="other-boot-entry-protocol-drivers">Other Boot Entry Protocol
drivers</h2>
<p>In addition to the <a href="#uefilinux">OpenLinuxBoot</a> plugin, the
following <code>OC_BOOT_ENTRY_PROTOCOL</code> plugins are made available
to add optional, configurable boot entries to the OpenCore boot
picker.</p>
<h3 id="uefiresetnvram">ResetNvramEntry</h3>
<p>Adds a menu entry which resets NVRAM and immediately restarts.
Additionally adds support for hotkey <code>CMD+OPT+P+R</code> to perform
the same action. Note that on some combinations of firmware and drivers,
the <code>TakeoffDelay</code> option must be configured in order for
this and other builtin hotkeys to be reliably detected.</p>
<p><em>Note 1</em>: It is known that some Lenovo laptops have a firmware
bug, which makes them unbootable after performing NVRAM reset. Refer to
<a
href="https://github.com/acidanthera/bugtracker/issues/995">acidanthera/bugtracker#995</a>
for details.</p>
<p><em>Note 2</em>: If <code>LauncherOption</code> is set to
<code>Full</code> or <code>Short</code> then the OpenCore boot entry is
protected. Resetting NVRAM will normally erase any other boot options
not specified via <code>BlessOverride</code>, for example Linux
installations to custom locations and not using the
<code>OpenLinuxBoot</code> driver, or user-specified UEFI boot menu
entries. To obtain reset NVRAM functionality which does not remove other
boot options, it is possible to use the <code>--preserve-boot</code>
option (though see the warning specified).</p>
<p>The following configuration options may be specified in the
<code>Arguments</code> section for this driver:</p>
<ul>
<li><p><code>--preserve-boot</code> - Boolean flag, enabled if
present.</p>
<p>If enabled, BIOS boot entries are not cleared during NVRAM reset.
This option should be used with caution, as some boot problems can be
fixed by clearing these entries.</p></li>
<li><p><code>--apple</code> - Boolean flag, enabled if present.</p>
<p>On Apple firmware only, this performs a system NVRAM reset. This can
result in additional, desirable operations such as NVRAM garbage
collection. This is achieved by setting the <code>ResetNVRam</code>
NVRAM variable. Where available, this has the same effect as pressing
<code>CMD+OPT+P+R</code> during native boot, although note that if
accessed from the menu entry only one boot chime will be heard.</p>
<p><em>Note 1</em>: Due to using system NVRAM reset, this option is not
compatible with the <code>--preserve-boot</code> option and will
override it, therefore all BIOS boot entries will be removed.</p>
<p><em>Note 2</em>: Due to using system NVRAM reset, the OpenCore boot
option cannot be preserved and OpenCore will have to either be
reselected in the native boot picker or re-blessed.</p>
<p><em>Note 3</em>: On non-Apple hardware, this option will still set
this variable but the variable will not be recognised by the firmware
and no NVRAM reset will happen.</p></li>
</ul>
<h3 id="uefitogglesip">ToggleSipEntry</h3>
<p>Provides a boot entry for enabling and disabling System Integrity
Protection (SIP) in OpenCore picker.</p>
<p>While macOS is running, SIP involves multiple configured software
protection systems, however all the information about which of these
protections to enable is stored in the single Apple NVRAM variable
<code>csr-active-config</code>. As long as this variable is set before
macOS startup, SIP will be fully configured, so setting the variable
using this boot option (or in any other way, before macOS starts) has
exactly the same end result as configuring SIP using the
<code>csrutil</code> command in macOS Recovery.</p>
<p><code>csr-active-config</code> will be toggled between <code>0</code>
for enabled, and a user-specified or default value for disabled.</p>
<p>Options for the driver should be specified as plain text values
separated by whitespace in the <code>Arguments</code> section of
<code>Driver</code> entry. Available options are:</p>
<ul>
<li><p><code>--show-csr</code> - Boolean flag, enabled if present.</p>
<p>If enabled, show the current hexadecimal value of
<code>csr-active-config</code> in the boot entry name. This option will
not work in OpenCanopy when used in combination with
<code>OC_ATTR_USE_GENERIC_LABEL_IMAGE</code> in
<code>PickerAttributes</code>.</p></li>
<li><p>Numerical value - Default value <code>0x27F</code>.</p>
<p>Specify the <code>csr-active-config</code> value to use to disabled
SIP. This can be specified as hexadecimal, beginning with
<code>0x</code>, or as decimal. For more info see Note 2 below.</p></li>
</ul>
<p><em>Note 1</em>: It is recommended not to run macOS with SIP
disabled. Use of this boot option may make it easier to quickly disable
SIP protection when genuinely needed - it should be re-enabled again
afterwards.</p>
<p><em>Note 2</em>: The default value for disabling SIP with this boot
entry is <code>0x27F</code>. For comparison,
<code>csrutil disable</code> with no other arguments on macOS Big Sur
and Monterey sets <code>0x7F</code>, and on Catalina it sets
<code>0x77</code>. The OpenCore default value of <code>0x27F</code> is a
variant of the Big Sur and Monterey value, chosen as follows:</p>
<ul>
<li><p><code>CSR_ALLOW_UNAPPROVED_KEXTS</code> (<code>0x200</code>) is
included in the default value, since it is generally useful, in the case
where you need to have SIP disabled anyway, to be able to install
unsigned kexts without manual approval in System Preferences.</p></li>
<li><p><code>CSR_ALLOW_UNAUTHENTICATED_ROOT</code> (<code>0x800</code>)
is not included in the default value, as it is very easy when using it
to inadvertently break OS seal and prevent incremental OTA
updates.</p></li>
<li><p>If unsupported bits from a later OS are specified in
<code>csr-active-config</code> (e.g. specifying <code>0x7F</code> on
Catalina) then <code>csrutil status</code> will report that SIP has a
non-standard value, however protection will be functionally the
same.</p></li>
</ul>
<h3 id="firmwaresettings">FirmwareSettings</h3>
<p>Adds a menu entry which will reboot into UEFI firmware settings, when
supported. No menu entry added and logs a warning when not
supported.</p>
<h2 id="uefiaudio">AudioDxe</h2>
<p>High Definition Audio (HDA) support driver in UEFI firmware for most
Intel and some other analog audio controllers.</p>
<p><em>Note</em>: AudioDxe is a staging driver, refer to <a
href="https://github.com/acidanthera/bugtracker/issues/740">acidanthera/bugtracker#740</a>
for known issues.</p>
<h3 id="configuration-2">Configuration</h3>
<p>Most UEFI audio configuration is handled via the <a
href="#uefiaudioprops"><code>UEFI Audio Properties</code></a> section,
but in addition some of the following configuration options may be
required in order to allow AudioDxe to correctly drive certain devices.
All options are specified as text strings, separated by space if more
than one option is required, in the <code>Arguments</code> property for
the driver within the <code>UEFI/Drivers</code> section:</p>
<ul>
<li><p><code>--codec-setup-delay</code> - Integer value, default
<code>0</code>.</p>
<p>Amount of time in milliseconds to wait for all widgets to come fully
on, applied per codec during driver connection phase. In most systems
this should not be needed and a faster boot will be achieved by using
<code>Audio</code> section <code>SetupDelay</code> if any audio setup
delay is required. Where required, values of up to one second may be
needed.</p></li>
<li><p><code>--force-codec</code> - Integer value, no default.</p>
<p>Force use of an audio codec, this value should be equal to
<code>Audio</code> section <code>AudioCodec</code>. Can result in faster
boot especially when used in conjuction with
<code>--force-device</code>.</p></li>
<li><p><code>--force-device</code> - String value, no default.</p>
<p>When this option is present and has a value (e.g.
<code>--force-device=PciRoot(0x0)/Pci(0x1f,0x3)</code>), it forces
AudioDxe to connect to the specified PCI device, even if the device does
not report itself as an HDA audio controller.</p>
<p>During driver connection, AudioDxe automatically provides audio
services on all supported codecs of all available HDA controllers.
However, if the relevant controller is misreporting its identity
(typically, it will be reporting itself as a legacy audio device instead
of an HDA controller) then this argument may be required.</p>
<p>Applies if the audio device can be made to work in macOS, but shows
no sign of being detected by AudioDxe (e.g. when including
<code>DEBUG_INFO</code> in <code>DisplayLevel</code> and using a DEBUG
build of AudioDxe, no controller and codec layout information is
displayed during the <code>Connecting drivers...</code> phase of
OpenCore log).</p></li>
<li><p><code>--gpio-setup</code> - Default value is <code>0</code> (GPIO
setup disabled) if argument is not provided, or <code>7</code> (all GPIO
setup stages stages enabled) if the argument is provided with no
value.</p>
<p>Available values, which may be combined by adding, are:</p>
<ul>
<li><p><code>0x00000001</code> (bit <code>0</code>) —
<code>GPIO_SETUP_STAGE_DATA</code>, set GPIO pin data high on specified
pins. Required e.g. on <code>MacBookPro10,2</code> and
<code>MacPro5,1</code>.</p></li>
<li><p><code>0x00000002</code> (bit <code>1</code>) —
<code>GPIO_SETUP_STAGE_DIRECTION</code>, set GPIO data direction to
output on specified pins. Required e.g. on
<code>MacPro5,1</code>.</p></li>
<li><p><code>0x00000004</code> (bit <code>2</code>) —
<code>GPIO_SETUP_STAGE_ENABLE</code>, enable specified GPIO pins.
Required e.g. on <code>MacPro5,1</code>.</p></li>
</ul>
<p>If audio appears to be ‘playing’ on the correct codec, e.g. based on
the debug log, but no sound is heard on any channel, it is suggested to
use <code>--gpio-setup</code> (with no value) in the AudioDxe driver
arguments. If specified with no value, all stages will be enabled
(equivalent of specifying <code>7</code>). If this produces sound, it is
then possible to try fewer bits, e.g. <code>--gpio-setup=1</code>,
<code>--gpio-setup=3</code>, to find out which stages are actually
required.</p>
<p><em>Note</em>: Value <code>7</code> (all flags enabled) of this
option – as required for the <code>MacPro5,1</code> – is compatible with
most systems, but is known to cause problems with sound (previous sounds
are not allowed to finish before new sounds start) on a small number of
other systems, hence this option is not enabled by default.</p></li>
<li><p><code>--gpio-pins</code> - Default: <code>0</code>,
auto-detect.</p>
<p>Specifies which GPIO pins should be operated on by
<code>--gpio-setup</code>. This is a bit mask, with possible values from
<code>0x0</code> to <code>0xFF</code>. The usable maximum depends on the
number if available pins on the audio out function group of the codec in
use, e.g. it is <code>0x3</code> (lowest two bits) if two GPIO pins are
present, <code>0x7</code> if three pins are present, etc.</p>
<p>When <code>--gpio-setup</code> is enabled (i.e. non-zero), then
<code>0</code> is a special value for <code>--gpio-pins</code>, meaning
that the pin mask will be auto-generated based on the reported number of
GPIO pins on the specified codec (see <code>AudioCodec</code>), e.g. if
the codec’s audio out function group reports 4 GPIO pins, a mask of
<code>0xF</code> will be used. The value in use can be seen in the debug
log in a line such as:</p>
<p><code>HDA: GPIO setup on pins 0x0F - Success</code></p>
<p>Values for driver parameters can be specified in hexadecimal
beginning with <code>0x</code> or in decimal, e.g.
<code>--gpio-pins=0x12</code> or <code>--gpio-pins=18</code>.</p></li>
<li><p><code>--restore-nosnoop</code> - Boolean flag, enabled if
present.</p>
<p>AudioDxe clears the Intel HDA No Snoop Enable (NSNPEN) bit. On some
systems, this change must be reversed on exit in order to avoid breaking
sound in Windows or Linux. If so, this flag should be added to AudioDxe
driver arguments. Not enabled by default, since restoring the flag can
prevent sound from working in macOS on some other systems.</p></li>
<li><p><code>--use-conn-none</code> - Boolean flag, enabled if
present.</p>
<p>On some sound cards enabling this option will enable additional
usable audio channels (e.g. the bass or treble speaker of a pair, where
only one is found without it).</p>
<p><em>Note</em>: Enabling this option may increase the available
channels, in which case any custom setting of <code>AudioOutMask</code>
may need to be changed to match the new channel list.</p></li>
</ul>
<h2 id="emunvram">OpenVariableRuntimeDxe</h2>
<p>Provides in-memory emulated NVRAM implementation. This can be useful
on systems with fragile (e.g. MacPro5,1, see discussion linked from this
<a href="https://forums.macrumors.com/posts/30945127">forum post</a>) or
incompatible NVRAM implementations. This driver is included by default
in OpenDuet.</p>
<p>In addition to installing emulated NVRAM, this driver additionally
installs an OpenCore compatible protocol enabling the following:</p>
<ul>
<li><p>NVRAM values are loaded from <code>NVRAM/nvram.plist</code> (or
from <code>NVRAM/nvram.fallback</code> if it is present and
<code>NVRAM/nvram.plist</code> is missing) on boot</p></li>
<li><p>The Reset NVRAM option installed by the
<code>ResetNvramEntry</code> driver removes the above files instead of
affecting underlying NVRAM</p></li>
<li><p><code>CTRL+Enter</code> in the OpenCore bootpicker updates or
creates <code>NVRAM/nvram.plist</code></p></li>
</ul>
<p>Recommended configuration settings for this driver:</p>
<ul>
<li><p><code>OpenVariableRuntimeDxe.efi</code> loaded using
<code>LoadEarly=true</code>. OpenDuet users should not load this driver,
as it is included in OpenDuet.</p></li>
<li><p><code>OpenRuntime.efi</code> specified after
<code>OpenVariableRuntimeDxe.efi</code> (when applicable), also loaded
using <code>LoadEarly=true</code> for correct operation of
<code>RequestBootVarRouting</code>.</p>
<ul>
<li><p><code>RequestBootVarRouting</code> is never strictly needed while
using emulated NVRAM, but it can be convenient to leave it set on a
system which needs to switch between real and emulated NVRAM.</p></li>
<li><p><code>RequestBootVarRouting</code> is never required on an
OpenDuet system, since there are no BIOS-managed boot entries to
protect, therefore on OpenDuet recommended settings are
<code>LoadEarly=false</code> for <code>OpenRuntime.efi</code> and
<code>RequestBootVarRouting=false</code>.</p></li>
</ul></li>
<li><p><code>LegacySchema</code> populated.</p>
<ul>
<li><p>For simpler testing (allows arbitrary test variables), and
future-proofing against changes in the variables required by macOS
updates, use <code>&lt;string&gt;*&lt;/string&gt;</code> settings, as
described in notes below.</p></li>
<li><p>For increased security, populate sections with known required
keys only, as shown in OpenCore’s sample <code>.plist</code>
files.</p></li>
</ul></li>
<li><p><code>ExposeSensitiveData</code> with at least bit
<code>0x1</code> set to make <code>boot-path</code> variable containing
the OpenCore EFI partition UUID available to the
<code>Launchd.command</code> script.</p></li>
</ul>
<p>Variable loading happens prior to the NVRAM <code>Delete</code> (and
<code>Add</code>) phases. Unless <code>LegacyOverwrite</code> is
enabled, it will not overwrite any existing variable. Variables allowed
for loading and for saving with <code>CTRL+Enter</code> must be
specified in <code>LegacySchema</code>.</p>
<p>In order to allow changes to NVRAM within macOS to be captured and
saved, an additional script must be installed. An example of such script
can be found in <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Utilities/LogoutHook/Launchd.command"><code>Utilities/LogoutHook/Launchd.command</code></a>.</p>
<p><em>Note 1</em>: This driver requires working FAT write support in
firmware, and sufficient free space on the OpenCore EFI partition for up
to three saved NVRAM files.</p>
<p><em>Note 2</em>: The <code>nvram.plist</code> (and
<code>nvram.fallback</code> if present) files must have a root
<code>plist dictionary</code> type and contain two fields:</p>
<ul>
<li><p><code>Version</code> — <code>plist integer</code>, file version,
must be set to 1.</p></li>
<li><p><code>Add</code> — <code>plist dictionary</code>, equivalent to
<code>Add</code> from <code>config.plist</code>.</p></li>
</ul>
<p><em>Note 3</em>: When setting up legacy NVRAM, it can be convenient
to set <code>&lt;string&gt;*&lt;/string&gt;</code> as the value for the
following three GUID keys in <code>LegacySchema</code>:</p>
<ul>
<li><p>36C28AB5-6566-4C50-9EBD-CBB920F83843</p></li>
<li><p>7C436110-AB2A-4BBB-A880-FE41995C9F82</p></li>
<li><p>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</p></li>
</ul>
<p>This enables all variables saved by <code>Launchd.command</code> to
be saved to <code>nvram.plist</code>, therefore it allows all arbitrary
user test variables (e.g. as set by <code>sudo nvram foo=bar</code>) to
be saved. Using this permissive policy is also future-proof against any
changes in the variables which need to be passed from macOS update setup
to the <code>macOS Installer</code> stage, in order for it to succeed.
Nevertheless, once emulated NVRAM is set up, only allowing known
strictly required variables (as shown in OpenCore’s sample
<code>.plist</code> files) is considerably more secure. See also the
following warning about the overall security of loading NVRAM variables
from a non-vaulted file.</p>
<p><strong>Warning</strong>: The ability to load NVRAM from a file on
disk can be dangerous, as it passes unprotected data to firmware
variable services. Only use when no hardware NVRAM implementation is
provided by the firmware or when the NVRAM implementation available in
firmware is incompatible or dangerously fragile (e.g. in a state where
excessive use may cause bricked hardware).</p>
<h3 id="managing-macos-updates-when-using-emulated-nvram">Managing macOS
updates when using emulated NVRAM</h3>
<p>OpenCore combined with <code>OpenVariableRuntimeDxe</code> will only
use a given saved <code>nvram.plist</code> file once, if it is used to
launch a <code>macOS Installer</code> boot entry. After that the used
settings are moved to <code>nvram.used</code> and fallback settings, if
any, from <code>nvram.fallback</code> are used instead.
<code>Launchd.command</code> itself always copies the previous NVRAM
settings to fallback, each time it saves new settings.</p>
<p>This strategy is used to work round the limitation that the
<code>Launchd.command</code> script is not running, and therefore cannot
save NVRAM changes (particularly default boot entry changes), during the
second and subsequent restarts of the macOS installer.</p>
<p>In brief, this fallback strategy allows full or incremental OTA
updates of recent macOS, which are started from within an existing macOS
(with the <code>Launchd.command</code> script installed), to proceed
without manual intervention.</p>
<p>However, for full installs, there can be more than one full restart
back to the <code>macOS Installer</code> entry. In this case the
fallback strategy will lose track of the correct startup item (i.e.
<code>macOS Installer</code>) from the second reboot onwards. Equally,
if installing to a drive other than the current default boot partition,
this will not be automatically selected after the installer completes,
as it would be when using non-emulated NVRAM. (This behaviour remains
preferable to not having the fallback strategy, in which case a
<code>macOS Installer</code> entry would be continually recreated in the
picker menu, even once it no longer exists).</p>
<p>In both the above two cases it is recommended to use the following
settings, to make it easy to manually control which boot entry is
selected during the installer process:</p>
<ul>
<li><p>Set <code>ShowPicker=true</code>.</p></li>
<li><p>Set <code>Timeout=0</code>.</p></li>
<li><p>Set <code>DisableWatchdog=true</code>.</p></li>
<li><p>If possible, start from a situation where there are no other
pending <code>macOS Installer</code> entries in the boot menu (to avoid
potential confusion as to which is relevant).</p></li>
</ul>
<p>The first reboot should correctly select
<code>macOS Installer</code>. For second and subsequent reboots, if a
<code>macOS Installer</code> entry is still present it should be
manually selected (using just Enter, not <code>CTRL+Enter</code>). Once
a <code>macOS Installer</code> entry is no longer present, the entry for
the new OS will still be automatically selected if it was the previous
boot default. If not, it should be manually selected (at this point,
<code>CTRL+Enter</code> is a good idea as any final remaining
installation restarts will be to this entry).</p>
<p><em>Note 1</em>: When using emulated NVRAM but not installing from
within an existing installed macOS (i.e. when installing from within
macOS Recovery, or from an installation USB), please refer to this <a
href="https://applelife.ru/posts/916248">forum post</a> (in Russian) for
additional options.</p>
<p><em>Note 2</em>: After upgrading from an earlier macOS version to
macOS Sonoma, the <code>Launchd.command</code> script should be
reinstalled, as a different strategy is required in order for NVRAM to
be saved successfully.</p>
<p><em>Note 3</em>: In macOS Sonoma the following additional constraints
apply to the ESP partition on which OpenCore is installed, in order for
the <code>Launchd.command</code> script to work successfully:</p>
<ul>
<li><p>It must not be set to automount.</p></li>
<li><p>It must be unmounted again before shutdown or restart if it was
manually mounted.</p></li>
</ul>
<h2 id="uefiprops">Properties</h2>
<ol>
<li><p><code>APFS</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Provide APFS support as configured in the
<a href="#uefiapfsprops">APFS Properties</a> section below.</p></li>
<li><p><code>AppleInput</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Configure the re-implementation of the
Apple Event protocol described in the <a
href="#uefiappleinputprops">AppleInput Properties</a> section
below.</p></li>
<li><p><code>Audio</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Configure audio backend support described
in the <a href="#uefiaudioprops"><code>Audio Properties</code></a>
section below.</p>
<p>Unless documented otherwise (e.g. <code>ResetTrafficClass</code>)
settings in this section are for UEFI audio support only (e.g. OpenCore
generated boot chime and audio assist) and are unrelated to any
configuration needed for OS audio support (e.g.
<code>AppleALC</code>).</p>
<p>UEFI audio support provides a way for upstream protocols to interact
with the selected audio hardware and resources. All audio resources
should reside in <code>\EFI\OC\Resources\Audio</code> directory.
Currently the supported audio file formats are MP3 and WAVE PCM. While
it is driver-dependent which audio stream format is supported, most
common audio cards support 16-bit signed stereo audio at 44100 or 48000
Hz.</p>
<p>Audio file path is determined by audio type, audio localisation, and
audio path. Each filename looks as follows:
<code>[audio type]_[audio localisation]_[audio path].[audio ext]</code>.
For unlocalised files filename does not include the language code and
looks as follows: <code>[audio type]_[audio path].[audio ext]</code>.
Audio extension can either be <code>mp3</code> or <code>wav</code>.</p>
<ul>
<li><p>Audio type can be <code>OCEFIAudio</code> for OpenCore audio
files or <code>AXEFIAudio</code> for macOS bootloader audio
files.</p></li>
<li><p>Audio localisation is a two letter language code (e.g.
<code>en</code>) with an exception for Chinese, Spanish, and Portuguese.
Refer to <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/Protocol/AppleVoiceOver.h"><code>APPLE_VOICE_OVER_LANGUAGE_CODE</code>
definition</a> for the list of all supported localisations.</p></li>
<li><p>Audio path is the base filename corresponding to a file
identifier. For macOS bootloader audio paths refer to <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Apple/Protocol/AppleVoiceOver.h"><code>APPLE_VOICE_OVER_AUDIO_FILE</code>
definition</a>. For OpenCore audio paths refer to <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Acidanthera/Protocol/OcAudio.h"><code>OC_VOICE_OVER_AUDIO_FILE</code>
definition</a>. The only exception is OpenCore boot chime file, which is
<code>OCEFIAudio_VoiceOver_Boot.mp3</code>.</p></li>
</ul>
<p>Audio localisation is determined separately for macOS bootloader and
OpenCore. For macOS bootloader it is set in
<code>preferences.efires</code> archive in
<code>systemLanguage.utf8</code> file and is controlled by the operating
system. For OpenCore the value of <code>prev-lang:kbd</code> variable is
used. When native audio localisation of a particular file is missing,
English language (<code>en</code>) localisation is used. Sample audio
files can be found in <a
href="https://github.com/acidanthera/OcBinaryData">OcBinaryData
repository</a>.</p></li>
<li><p><code>ConnectDrivers</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Perform UEFI controller connection after
driver loading.</p>
<p>This option is useful for loading drivers following UEFI driver model
as they may not start by themselves. Examples of such drivers are
filesystem or audio drivers. While effective, this option may not be
necessary for drivers performing automatic connection, and may slightly
slowdown the boot.</p>
<p><em>Note</em>: Some types of firmware, particularly those made by
Apple, only connect the boot drive to speed up the boot process. Enable
this option to be able to see all the boot options when running multiple
drives.</p></li>
<li><p><code>Drivers</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Load selected drivers from
<code>OC/Drivers</code> directory.</p>
<p>To be filled with <code>plist dict</code> values, describing each
driver. Refer to the <a href="#uefidriversprops">Drivers Properties</a>
section below.</p></li>
<li><p><code>Input</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual settings designed for
input (keyboard and mouse) in the <a href="#uefiinputprops">Input
Properties</a> section below.</p></li>
<li><p><code>Output</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual settings designed for
output (text and graphics) in the <a href="#uefioutputprops">Output
Properties</a> section below.</p></li>
<li><p><code>ProtocolOverrides</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Force builtin versions of certain
protocols described in the <a href="#uefiprotoprops">ProtocolOverrides
Properties</a> section below.</p>
<p><em>Note</em>: all protocol instances are installed prior to driver
loading.</p></li>
<li><p><code>Quirks</code><br />
<strong>Type</strong>: <code>plist dict</code><br />
<strong>Description</strong>: Apply individual firmware quirks described
in the <a href="#uefiquirkprops">Quirks Properties</a> section
below.</p></li>
<li><p><code>ReservedMemory</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: To be filled with <code>plist dict</code>
values, describing memory areas exclusive to specific firmware and
hardware functioning, which should not be used by the operating system.
Examples of such memory regions could be the second 256 MB corrupted by
the Intel HD 3000 or an area with faulty RAM. Refer to the <a
href="#uefirsvdprops">ReservedMemory Properties</a> section below for
details.</p></li>
<li><p><code>Unload</code><br />
<strong>Type</strong>: <code>plist array</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Unload specified firmware drivers.</p>
<p>To be filled with <code>plist string</code> entries containing the
names of firmware drivers to unload before loading the
<code>Drivers</code> section. This setting is typically only required if
a user-provided driver is a variant of an existing system firmware
driver, and if the new driver would detect itself as partially loaded,
or otherwise fail to operate correctly, if the old driver is not
unloaded first.</p>
<p><strong>Warning</strong>: Unloading system firmware drivers is
usually not required and not recommended. Poorly written drivers may
crash when unloaded, or cause subsequent crashes (e.g by allowing
themselves to be unloaded even though they have active dependencies).
However standard UEFI network stack drivers should unload cleanly.</p>
<p><em>Note 1</em>: See
<code>SysReport/Drivers/DriverImageNames.txt</code> for the list of
drivers which this option can attempt to unload. The relevant name is
the driver component name. Drivers are only listed if they implement
<code>DriverBindingProtocol</code> and <code>LoadedImageProtocol</code>,
and have an available component name.</p>
<p><em>Note 2</em>: The NVRAM <code>Lang</code> and
<code>PlatformLang</code> variables are ignored when determining the
driver component names recognised by this option, and listed in the
<code>SysReport</code> file. This is in order to make unloading images
stable across changes in these variables. The UEFI Shell <code>dh</code>
command takes account of these variables, so in some circumstances may
display different driver component names from those listed for this
option, unless these variables are cleared.</p></li>
</ol>
<h2 id="uefiapfsprops">APFS Properties</h2>
<ol>
<li><p><code>EnableJumpstart</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Load embedded APFS drivers from APFS
containers.</p>
<p>An APFS EFI driver is bundled in all bootable APFS containers. This
option performs the loading of signed APFS drivers (consistent with the
<code>ScanPolicy</code>). Refer to the “EFI Jumpstart” section of the <a
href="https://developer.apple.com/support/apple-file-system/Apple-File-System-Reference.pdf">Apple
File System Reference</a> for details.</p></li>
<li><p><code>GlobalConnect</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Perform full device connection during APFS
loading.</p>
<p>Every handle is connected recursively instead of the partition handle
connection typically used for APFS driver loading. This may result in
additional time being taken but can sometimes be the only way to access
APFS partitions on certain firmware, such as those on older HP
laptops.</p></li>
<li><p><code>HideVerbose</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Hide verbose output from APFS driver.</p>
<p>APFS verbose output can be useful for debugging.</p></li>
<li><p><code>JumpstartHotPlug</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Load APFS drivers for newly connected
devices.</p>
<p>Permits APFS USB hot plug which enables loading APFS drivers, both at
OpenCore startup and during OpenCore picker display. Disable if not
required.</p></li>
<li><p><code>MinDate</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Minimal allowed APFS driver date.</p>
<p>The APFS driver date connects the APFS driver with the calendar
release date. Apple ultimately drops support for older macOS releases
and APFS drivers from such releases may contain vulnerabilities that can
be used to compromise a computer if such drivers are used after support
ends. This option permits restricting APFS drivers to current macOS
versions.</p>
<ul>
<li><p><code>0</code> — require the default supported release date of
APFS in OpenCore. The default release date will increase with time and
thus this setting is recommended. Currently set to 2021/01/01.</p></li>
<li><p><code>-1</code> — permit any release date to load (strongly
discouraged).</p></li>
<li><p>Other — use custom minimal APFS release date, e.g.
<code>20200401</code> for 2020/04/01. APFS release dates can be found in
OpenCore boot log and <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Acidanthera/Library/OcApfsLib.h"><code>OcApfsLib</code></a>.</p></li>
</ul></li>
<li><p><code>MinVersion</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Minimal allowed APFS driver version.</p>
<p>The APFS driver version connects the APFS driver with the macOS
release. Apple ultimately drops support for older macOS releases and
APFS drivers from such releases may contain vulnerabilities that can be
used to compromise a computer if such drivers are used after support
ends. This option permits restricting APFS drivers to current macOS
versions.</p>
<ul>
<li><p><code>0</code> — require the default supported version of APFS in
OpenCore. The default version will increase with time and thus this
setting is recommended. Currently set to allow macOS Big Sur and newer
(<code>1600000000000000</code>).</p></li>
<li><p><code>-1</code> — permit any version to load (strongly
discouraged).</p></li>
<li><p>Other — use custom minimal APFS version, e.g.
<code>1412101001000000</code> from macOS Catalina 10.15.4. APFS versions
can be found in OpenCore boot log and <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Acidanthera/Library/OcApfsLib.h"><code>OcApfsLib</code></a>.</p></li>
</ul></li>
</ol>
<h2 id="uefiappleinputprops">AppleInput Properties</h2>
<ol>
<li><p><code>AppleEvent</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Determine whether the OpenCore builtin or
the OEM Apple Event protocol is used.</p>
<p>This option determines whether the OEM Apple Event protocol is used
(where available), or whether OpenCore’s reversed engineered and updated
re-implementation is used. In general OpenCore’s re-implementation
should be preferred, since it contains updates such as noticeably
improved fine mouse cursor movement and configurable key repeat
delays.</p>
<ul>
<li><p><code>Auto</code> — Use the OEM Apple Event implementation if
available, connected and recent enough to be used, otherwise use the
OpenCore re-implementation. On non-Apple hardware, this will use the
OpenCore builtin implementation. On some Macs such as Classic Mac Pros,
this will prefer the Apple implementation but on both older and newer
Mac models than these, this option will typically use the OpenCore
re-implementation instead. On older Macs, this is because the
implementation available is too old to be used while on newer Macs, it
is because of optimisations added by Apple which do not connect the
Apple Event protocol except when needed – e.g. except when the Apple
boot picker is explicitly started. Due to its somewhat unpredicatable
results, this option is not typically recommended.</p></li>
<li><p><code>Builtin</code> — Always use OpenCore’s updated
re-implementation of the Apple Event protocol. Use of this setting is
recommended even on Apple hardware, due to improvements (better fine
mouse control, configurable key delays) made in the OpenCore
re-implementation of the protocol.</p></li>
<li><p><code>OEM</code> — Assume Apple’s protocol will be available at
driver connection. On all Apple hardware where a recent enough Apple OEM
version of the protocol is available – whether or not connected
automatically by Apple’s firmware – this option will reliably access the
Apple implementation. On all other systems, this option will result in
no keyboard or mouse support. For the reasons stated,
<code>Builtin</code> is recommended in preference to this option in most
cases.</p></li>
</ul></li>
<li><p><code>CustomDelays</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable custom key repeat delays when using
the OpenCore re-implementation of the Apple Event protocol. Has no
effect when using the OEM Apple implementation (see
<code>AppleEvent</code> setting).</p>
<ul>
<li><p><code>true</code> — The values of <code>KeyInitialDelay</code>
and <code>KeySubsequentDelay</code> are used.</p></li>
<li><p><code>false</code> — Apple default values of 500ms
(<code>50</code>) and 50ms (<code>5</code>) are used.</p></li>
</ul></li>
<li><p><code>GraphicsInputMirroring</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Apple’s own implementation of AppleEvent
prevents keyboard input during graphics applications from appearing on
the basic console input stream.</p>
<p>With the default setting of <code>false</code>, OpenCore’s builtin
implementation of AppleEvent replicates this behaviour.</p>
<p>On non-Apple hardware this can stop keyboard input working in
graphics-based applications such as Windows BitLocker which use
non-Apple key input methods.</p>
<p>The recommended setting on all hardware is <code>true</code>.</p>
<p><em>Note</em>: AppleEvent’s default behaviour is intended to prevent
unwanted queued keystrokes from appearing after exiting graphics-based
UEFI applications; this issue is already handled separately within
OpenCore.</p>
<ul>
<li><p><code>true</code> — Allow keyboard input to reach graphics mode
apps which are not using Apple input protocols.</p></li>
<li><p><code>false</code> — Prevent key input mirroring to non-Apple
protocols when in graphics mode.</p></li>
</ul></li>
<li><p><code>KeyInitialDelay</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>50</code> (500ms before first key
repeat)<br />
<strong>Description</strong>: Configures the initial delay before
keyboard key repeats in the OpenCore re-implementation of the Apple
Event protocol, in units of 10ms.</p>
<p>The Apple OEM default value is <code>50</code> (500ms).</p>
<p><em>Note 1</em>: On systems not using <code>KeySupport</code>, this
setting may be freely used to configure key repeat behaviour.</p>
<p><em>Note 2</em>: On systems using <code>KeySupport</code>, but which
do not show the ‘two long delays’ behavior (see Note 3) and/or which
always show a solid ‘set default’ indicator (see
<code>KeyForgetThreshold</code>) then this setting may also be freely
used to configure key repeat initial delay behaviour, except that it
should never be set to less than <code>KeyForgetThreshold</code> to
avoid uncontrolled key repeats.</p>
<p><em>Note 3</em>: On some systems using <code>KeySupport</code>, you
may find that you see one additional slow key repeat before normal speed
key repeat starts, when holding a key down. If so, you may wish to
configure <code>KeyInitialDelay</code> and
<code>KeySubsequentDelay</code> according to the instructions at Note 3
of <code>KeySubsequentDelay</code>.</p></li>
<li><p><code>KeySubsequentDelay</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>5</code> (50ms between subsequent key
repeats)<br />
<strong>Description</strong>: Configures the gap between keyboard key
repeats in the OpenCore re-implementation of the Apple Event protocol,
in units of 10ms.</p>
<p>The Apple OEM default value is <code>5</code> (50ms). <code>0</code>
is an invalid value for this option (will issue a debug log warning and
use <code>1</code> instead).</p>
<p><em>Note 1</em>: On systems not using <code>KeySupport</code>, this
setting may be freely used to configure key repeat behaviour.</p>
<p><em>Note 2</em>: On systems using <code>KeySupport</code>, but which
do not show the ‘two long delays’ behaviour (see Note 3) and/or which
always show a solid ‘set default’ indicator (see
<code>KeyForgetThreshold</code>) (which should apply to many/most
systems using <code>AMI</code> <code>KeySupport</code> mode) then this
setting may be freely used to configure key repeat subsequent delay
behaviour, except that it should never be set to less than
<code>KeyForgetThreshold</code> to avoid uncontrolled key repeats.</p>
<p><em>Note 3</em>: On some systems using <code>KeySupport</code>,
particularly <code>KeySupport</code> in non-<code>AMI</code> mode, you
may find that after configuring <code>KeyForgetThreshold</code> you get
one additional slow key repeat before normal speed key repeat starts,
when holding a key down. On systems where this is the case, it is an
unavoidable artefect of using <code>KeySupport</code> to emulate raw
keyboard data, which is not made available by UEFI. While this ‘two long
delays’ issue has minimal effect on overall usability, nevertheless you
may wish to resolve it, and it is possible to do so as follows:</p>
<ul>
<li><p>Set <code>CustomDelays</code> to <code>true</code></p></li>
<li><p>Set <code>KeyInitialDelay</code> to <code>0</code></p></li>
<li><p>Set <code>KeySubsequentDelay</code> to at least the value of your
<code>KeyForgetThreshold</code> setting</p></li>
</ul>
<p>The above procedure works as follows:</p>
<ul>
<li><p>Setting <code>KeyInitialDelay</code> to <code>0</code> cancels
the Apple Event initial repeat delay (when using the OpenCore builtin
Apple Event implementation with <code>CustomDelays</code> enabled),
therefore the only long delay you will see is the the non-configurable
and non-avoidable initial long delay introduced by the BIOS key support
on these machines.</p></li>
<li><p>Key-smoothing parameter <code>KeyForgetThreshold</code>
effectively acts as the shortest time for which a key can appear to be
held, therefore a key repeat delay of less than this will guarantee at
least one extra repeat for every key press, however quickly the key is
physically tapped.</p></li>
<li><p>In the unlikely event that you still get frequent, or occasional,
double key responses after setting <code>KeySubsequentDelay</code> equal
to your system’s value of <code>KeyForgetThreshold</code>, then increase
<code>KeySubsequentDelay</code> by one or two more until this effect
goes away.</p></li>
</ul></li>
<li><p><code>PointerDwellClickTimeout</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Configure pointer dwell-clicking single
left click timeout in milliseconds in the OpenCore re-implementation of
the Apple Event protocol. Has no effect when using the OEM Apple
implementation (see <code>AppleEvent</code> setting).</p>
<p>When the timeout expires, a single left click is issued at the
current position. <code>0</code> indicates the timeout is
disabled.</p></li>
<li><p><code>PointerDwellDoubleClickTimeout</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Configure pointer dwell-clicking single
left double click timeout in milliseconds in the OpenCore
re-implementation of the Apple Event protocol. Has no effect when using
the OEM Apple implementation (see <code>AppleEvent</code> setting).</p>
<p>When the timeout expires, a single left double click is issued at the
current position. <code>0</code> indicates the timeout is
disabled.</p></li>
<li><p><code>PointerDwellRadius</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Configure pointer dwell-clicking tolerance
radius in pixels in the OpenCore re-implementation of the Apple Event
protocol. Has no effect when using the OEM Apple implementation (see
<code>AppleEvent</code> setting).</p>
<p>The radius is scaled by <code>UIScale</code>. When the pointer leaves
this radius, the timeouts for <code>PointerDwellClickTimeout</code> and
<code>PointerDwellDoubleClickTimeout</code> are reset and the new
position is the centre for the new dwell-clicking tolerance
radius.</p></li>
<li><p><code>PointerPollMask</code><br />
<strong>Type</strong>: <code>plist integer, 32 bit</code><br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Description</strong>: Configure indices of polled pointers.</p>
<p>Selects pointer devices to poll for AppleEvent motion events.
<code>-1</code> implies all devices. A bit sum is used to determine
particular devices. E.g. to enable devices 0, 2, 3 the value will be
<code>1+4+8</code> (corresponding powers of two). A total of 32
configurable devices is supported.</p>
<p>Certain pointer devices can be present in the firmware even when no
corresponding physical devices are available. These devices usually are
placeholders, aggregate devices, or proxies. Gathering information from
these devices may result in inaccurate motion activity in the user
interfaces and even cause performance issues. Disabling such pointer
devices is recommended for laptop setups having issues of this kind.</p>
<p>The amount of pointer devices available in the system can be found in
the log. Refer to <code>Found N pointer devices</code> message for more
details.</p>
<p><em>Note</em>: Has no effect when using the OEM Apple implementation
(see <code>AppleEvent</code> setting).</p></li>
<li><p><code>PointerPollMax</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Configure maximum pointer polling period
in ms.</p>
<p>This is the maximum period the OpenCore builtin AppleEvent driver
polls pointer devices (e.g. mice, trackpads) for motion events. The
period is increased up to this value as long as the devices do not
respond in time. The current implementation defaults to 80 ms. Setting
<code>0</code> leaves this default unchanged.</p>
<p>Certain trackpad drivers often found in Dell laptops can be very slow
to respond when no physical movement happens. This can affect OpenCanopy
and FileVault 2 user interface responsiveness and loading times.
Increasing the polling periods can reduce the impact.</p>
<p><em>Note</em>: The OEM Apple implementation uses a polling rate of 2
ms.</p></li>
<li><p><code>PointerPollMin</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Configure minimal pointer polling period
in ms.</p>
<p>This is the minimal period the OpenCore builtin AppleEvent driver
polls pointer devices (e.g. mice, trackpads) for motion events. The
current implementation defaults to 10 ms. Setting <code>0</code> leaves
this default unchanged.</p>
<p><em>Note</em>: The OEM Apple implementation uses a polling rate of 2
ms.</p></li>
<li><p><code>PointerSpeedDiv</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>1</code><br />
<strong>Description</strong>: Configure pointer speed divisor in the
OpenCore re-implementation of the Apple Event protocol. Has no effect
when using the OEM Apple implementation (see <code>AppleEvent</code>
setting).</p>
<p>Configures the divisor for pointer movements. The Apple OEM default
value is <code>1</code>. <code>0</code> is an invalid value for this
option.</p>
<p><em>Note</em>: The recommended value for this option is
<code>1</code>. This value may optionally be modified in combination
with <code>PointerSpeedMul</code>, according to user preference, to
achieve customised mouse movement scaling.</p></li>
<li><p><code>PointerSpeedMul</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>1</code><br />
<strong>Description</strong>: Configure pointer speed multiplier in the
OpenCore re-implementation of the Apple Event protocol. Has no effect
when using the OEM Apple implementation (see <code>AppleEvent</code>
setting).</p>
<p>Configures the multiplier for pointer movements. The Apple OEM
default value is <code>1</code>.</p>
<p><em>Note</em>: The recommended value for this option is
<code>1</code>. This value may optionally be modified in combination
with <code>PointerSpeedDiv</code>, according to user preference, to
achieve customised mouse movement scaling.</p></li>
</ol>
<h2 id="uefiaudioprops">Audio Properties</h2>
<ol>
<li><p><code>AudioCodec</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Codec address on the specified audio
controller for audio support.</p>
<p>This typically contains the first audio codec address on the builtin
analog audio controller (<code>HDEF</code>). Audio codec addresses, e.g.
<code>2</code>, can be found in the debug log (marked in
bold-italic):</p>
<p><code>OCAU: 1/3 PciRoot(0x0)/Pci(0x1,0x0)/Pci(0x0,0x1)/VenMsg(&lt;redacted&gt;,</code><em><strong><code>00000000</code></strong></em><code>) (4 outputs)</code><br />
<code>OCAU: 2/3 PciRoot(0x0)/Pci(0x3,0x0)/VenMsg(&lt;redacted&gt;,</code><em><strong><code>00000000</code></strong></em><code>) (1 outputs)</code><br />
<code>OCAU: 3/3 PciRoot(0x0)/Pci(0x1B,0x0)/VenMsg(&lt;redacted&gt;,</code><em><strong><code>02000000</code></strong></em><code>) (7 outputs)</code></p>
<p>As an alternative, this value can be obtained from
<code>IOHDACodecDevice</code> class in I/O Registry containing it in
<code>IOHDACodecAddress</code> field.</p></li>
<li><p><code>AudioDevice</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Device path of the specified audio
controller for audio support.</p>
<p>This typically contains builtin analog audio controller
(<code>HDEF</code>) device path, e.g.
<code>PciRoot(0x0)/Pci(0x1b,0x0)</code>. The list of recognised audio
controllers can be found in the debug log (marked in bold-italic):</p>
<p><code>OCAU: 1/3 </code><em><strong><code>PciRoot(0x0)/Pci(0x1,0x0)/Pci(0x0,0x1)</code></strong></em><code>/VenMsg(&lt;redacted&gt;,00000000) (4 outputs)</code><br />
<code>OCAU: 2/3 </code><em><strong><code>PciRoot(0x0)/Pci(0x3,0x0)</code></strong></em><code>/VenMsg(&lt;redacted&gt;,00000000) (1 outputs)</code><br />
<code>OCAU: 3/3 </code><em><strong><code>PciRoot(0x0)/Pci(0x1B,0x0)</code></strong></em><code>/VenMsg(&lt;redacted&gt;,02000000) (7 outputs)</code></p>
<p>If using <code>AudioDxe</code>, the available controller device paths
are also output on lines formatted like this:</p>
<p><code>HDA: Connecting controller - </code><em><strong><code>PciRoot(0x0)/Pci(0x1B,0x0)</code></strong></em></p>
<p>Finally, <code>gfxutil -f HDEF</code> command can be used in macOS to
obtain the device path.</p>
<p>Specifying an empty device path results in the first available codec
and audio controller being used. The value of <code>AudioCodec</code> is
ignored in this case. This can be a convenient initial option to try to
get UEFI audio working. Manual settings as above will be required when
this default value does not work.</p></li>
<li><p><code>AudioOutMask</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Description</strong>: Bit field indicating which output channels
to use for UEFI sound.</p>
<p>Audio mask is 1 &lt;&lt; audio output (equivalently 2 <code>^</code>
audio output). E.g. for audio output <code>0</code> the bitmask is
<code>1</code>, for output <code>3</code> it is <code>8</code>, and for
outputs <code>0</code> and <code>3</code> it is <code>9</code>.</p>
<p>The number of available output nodes (<code>N</code>) for each HDA
codec is shown in the debug log (marked in bold-italic), audio outputs
<code>0</code> to <code>N - 1</code> may be selected:</p>
<p><code>OCAU: 1/3 PciRoot(0x0)/Pci(0x1,0x0)/Pci(0x0,0x1)/VenMsg(&lt;redacted&gt;,00000000) (</code><em><strong><code>4 outputs</code></strong></em><code>)</code><br />
<code>OCAU: 2/3 PciRoot(0x0)/Pci(0x3,0x0)/VenMsg(&lt;redacted&gt;,00000000) (</code><em><strong><code>1 outputs</code></strong></em><code>)</code><br />
<code>OCAU: 3/3 PciRoot(0x0)/Pci(0x1B,0x0)/VenMsg(&lt;redacted&gt;,02000000) (</code><em><strong><code>7 outputs</code></strong></em><code>)</code></p>
<p>When <code>AudioDxe</code> is used then additional information about
each output channel is logged during driver binding, including the
bitmask for each output. The bitmask values for the desired outputs
should be added together to obtain the <code>AudioOutMask</code>
value:</p>
<p><code>HDA: | Port widget @ 0x9 is an output (pin defaults 0x2B4020) (</code><em><strong><code>bitmask 1</code></strong></em><code>)</code><br />
<code>HDA: | Port widget @ 0xA is an output (pin defaults 0x90100112) (</code><em><strong><code>bitmask 2</code></strong></em><code>)</code><br />
<code>HDA: | Port widget @ 0xB is an output (pin defaults 0x90100110) (</code><em><strong><code>bitmask 4</code></strong></em><code>)</code><br />
<code>HDA: | Port widget @ 0x10 is an output (pin defaults 0x4BE030) (</code><em><strong><code>bitmask 8</code></strong></em><code>)</code></p>
<p>Further information on the available output channels may be found
from a Linux codec dump using the command:</p>
<p><code>cat /proc/asound/card{n}/codec#{m}</code></p>
<p>Using <code>AudioOutMask</code>, it is possible to play sound to more
than one channel (e.g. main speaker plus bass speaker; headphones plus
speakers) as long as all the chosen outputs support the sound file
format in use; if any do not then no sound will play and a warning will
be logged.</p>
<p>When all available output channels on the codec support the available
sound file format then a value of <code>-1</code> will play sound to all
channels simultaneously. If this does not work it will usually be
quickest to try each available output channel one by one, by setting
<code>AudioOutMask</code> to <code>1</code>, <code>2</code>,
<code>4</code>, etc., up to 2 <code>^</code> <code>N - 1</code>, in
order to work out which channel(s) produce sound.</p></li>
<li><p><code>AudioSupport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Activate audio support by connecting to a
backend driver.</p>
<p>Enabling this setting routes audio playback from builtin protocols to
specified (<code>AudioOutMask</code>) dedicated audio ports of the
specified codec (<code>AudioCodec</code>), located on the specified
audio controller (<code>AudioDevice</code>).</p></li>
<li><p><code>DisconnectHda</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Disconnect HDA controller before loading
drivers.</p>
<p>May be required on some systems (e.g. Apple hardware, VMware Fusion
guest) to allow a UEFI sound driver (such as <code>AudioDxe</code>) to
take control of the audio hardware.</p>
<p><em>Note</em>: In addition to this option, most Apple hardware also
requires the <code>--gpio-setup</code> driver argument which is dealt
with in the <a href="#uefiaudio">AudioDxe</a> section.</p></li>
<li><p><code>MaximumGain</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-15</code><br />
<strong>Description</strong>: Maximum gain to use for UEFI audio,
specified in decibels (dB) with respect to amplifier reference level of
0 dB (see note 1).</p>
<p>All UEFI audio will use this gain setting when the system amplifier
gain read from the <code>SystemAudioVolumeDB</code> NVRAM variable is
higher than this. This is to avoid over-loud UEFI audio when the system
volume is set very high, or the <code>SystemAudioVolumeDB</code> NVRAM
value has been misconfigured.</p>
<p><em>Note 1</em>: Decibels (dB) specify gain (postive values; increase
in volume) or attenuation (negative values; decrease in volume) compared
to some reference level. When you hear the sound level of a jet plane
expressed as 120 decibels, say, the reference level is the sound level
just audible to an average human. However generally in acoustic science
and computer audio any reference level can be specified. Intel HDA and
macOS natively use decibels to specify volume level. On most Intel HDA
hardware the reference level of 0 dB is the <em>loudest</em> volume of
the hardware, and all lower volumes are therefore negative numbers. The
quietest volume on typical sound hardware is around -55 dB to -60
dB.</p>
<p><em>Note 2</em>: Matching how macOS handles decibel values, this
value is converted to a signed byte; therefore values outside <span
class="math inline">−128</span> dB to <span
class="math inline">+127</span> dB (which are well beyond physically
plausible volume levels) are not allowed.</p>
<p><em>Note 3</em>: Digital audio output – which does not have a volume
slider in-OS – ignores this and all other gain settings, only mute
settings are relevant.</p></li>
<li><p><code>MinimumAssistGain</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-30</code><br />
<strong>Description</strong>: Minimum gain in decibels (dB) to use for
picker audio assist.</p>
<p>The screen reader will use this amplifier gain if the system
amplifier gain read from the <code>SystemAudioVolumeDB</code> NVRAM
variable is lower than this.</p>
<p><em>Note 1</em>: In addition to this setting, because audio assist
must be audible to serve its function, audio assist is not muted even if
the OS sound is muted or the <code>StartupMute</code> NVRAM variable is
set.</p>
<p><em>Note 2</em>: See <code>MaximumGain</code> for an explanation of
decibel volume levels.</p></li>
<li><p><code>MinimumAudibleGain</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-128</code><br />
<strong>Description</strong>: Minimum gain in decibels (dB) at which to
attempt to play any sound.</p>
<p>The boot chime will not play if the system amplifier gain level in
the <code>SystemAudioVolumeDB</code> NVRAM variable is lower than
this.</p>
<p><em>Note 1</em>: This setting is designed to save unecessary pauses
due to audio setup at inaudible volume levels, when no sound will be
heard anyway. Whether there are inaudible volume levels depends on the
hardware. On some hardware (including Apple) the audio values are well
enough matched to the hardware that the lowest volume levels available
are very quiet but audible, whereas on some other hardware combinations,
the lowest part of the volume range may not be audible at all.</p>
<p><em>Note 2</em>: See <code>MaximumGain</code> for an explanation of
decibel volume levels.</p></li>
<li><p><code>PlayChime</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Play chime sound at startup.</p>
<p>Enabling this setting plays the boot chime using the builtin audio
support. The volume level is determined by the
<code>SystemAudioVolumeDB</code> NVRAM variable. Supported values
are:</p>
<ul>
<li><p><code>Auto</code> — Enables chime when <code>StartupMute</code>
NVRAM variable is not present or set to <code>00</code>.</p></li>
<li><p><code>Enabled</code> — Enables chime unconditionally.</p></li>
<li><p><code>Disabled</code> — Disables chime unconditionally.</p></li>
</ul>
<p><em>Note 1</em>: <code>Enabled</code> can be used separately from the
<code>StartupMute</code> NVRAM variable to avoid conflicts when the
firmware is able to play the boot chime.</p>
<p><em>Note 2</em>: Regardless of this setting, the boot chime will not
play if system audio is muted, i.e. if the
<code>SystemAudioVolume</code> NVRAM variable has bit <code>0x80</code>
set.</p></li>
<li><p><code>ResetTrafficClass</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Set HDA Traffic Class Select Register to
<code>TC0</code>.</p>
<p>AppleHDA kext will function correctly only if <code>TCSEL</code>
register is configured to use <code>TC0</code> traffic class. Refer to
Intel I/O Controller Hub 9 (ICH9) Family Datasheet (or any other ICH
datasheet) for more details about this register.</p>
<p><em>Note</em>: This option is independent from
<code>AudioSupport</code>. If AppleALC is used it is preferred to use
AppleALC <code>alctcsel</code> property instead.</p></li>
<li><p><code>SetupDelay</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Audio codec reconfiguration delay in
milliseconds.</p>
<p>Some codecs require a vendor-specific delay after the reconfiguration
(e.g. volume setting). This option makes it configurable. A typical
delay can be up to 0.5 seconds.</p></li>
</ol>
<h2 id="uefidriversprops">Drivers Properties</h2>
<ol>
<li><p><code>Arguments</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Some OpenCore plugins accept optional
additional arguments which may be specified as a string here.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: If <code>false</code> this driver entry
will be ignored.</p></li>
<li><p><code>LoadEarly</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Load the driver early in the OpenCore boot
process, before NVRAM setup.</p>
<p><em>Note</em>: Do not enable this option unless specifically
recommended to do so for a given driver and purpose.</p></li>
<li><p><code>Path</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Path of file to be loaded as a UEFI driver
from <code>OC/Drivers</code> directory.</p></li>
</ol>
<h2 id="uefiinputprops">Input Properties</h2>
<ol>
<li><p><code>KeyFiltering</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable keyboard input sanity checking.</p>
<p>Apparently some boards such as the GA Z77P-D3 may return
uninitialised data in <code>EFI_INPUT_KEY</code> with all input
protocols. This option discards keys that are neither ASCII, nor are
defined in the UEFI specification (see tables 107 and 108 in version
2.8).</p></li>
<li><p><code>KeyForgetThreshold</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Treat duplicate key presses as held keys
if they arrive during this timeout, in 10 ms units. Only applies to
systems using <code>KeySupport</code>.</p>
<p><code>AppleKeyMapAggregator</code> protocol is supposed to contain a
fixed length buffer of currently pressed keys. However, the majority of
the drivers which require <code>KeySupport</code> report key presses as
interrupts, with automatically generated key repeat behaviour with some
defined initial and subsequent delay. As a result, to emulate the raw
key behaviour required by several Apple boot systems, we use a timeout
to merge multiple repeated keys which are submitted within a small
timeout window.</p>
<p>This option allows setting this timeout based on the platform. The
recommended value for the majority of platforms is from <code>5</code>
(<code>50</code> milliseconds) to <code>7</code> (<code>70</code>
milliseconds), although values up to <code>9</code> (<code>90</code>
milliseconds) have been observed to be required on some PS/2 systems.
For reference, holding a key on VMware will repeat roughly every
<code>20</code> milliseconds and the equivalent value for APTIO V is
<code>30-40</code> milliseconds. <code>KeyForgetThreshold</code> should
be configured to be longer than this. Thus, it is possible to configure
a lower <code>KeyForgetThreshold</code> value on platforms with a faster
native driver key repeat rate, for more responsive input, and it is
required to set a higher value on slower platforms.</p>
<p>Pressing keys one after the other results in delays of at least
<code>60</code> and <code>100</code> milliseconds for the same
platforms. Ideally, <code>KeyForgetThreshold</code> should remain lower
than this value, to avoid merging real key presses.</p>
<p>Tuning the value of <code>KeyForgetThreshold</code> is necessary for
accurate and responsive keyboard input on systems on which
<code>KeySupport</code> is enabled, and it is recommended to follow the
instructions below to tune it correctly for your system.</p>
<p><em>Note 1</em>: To tune <code>KeyForgetThreshold</code>, you may use
the ‘set default’ indicator within either OpenCanopy or the builtin
picker. If <code>KeyForgetThreshold</code> is too low then the ‘set
default’ indicator will continue to flicker while <code>CTRL</code> or
<code>=/+</code> is held down. You should configure the lowest value
which avoids this flicker. On some systems (e.g. Aptio IV and
potentially other systems using <code>AMI</code> <code>KeySupport</code>
mode) you will be able to find a minimum <code>KeyForgetThreshold</code>
value at which the ‘set default’ indicator goes on and stays on with no
flicker at all - if so, use this value. On most other systems using
<code>KeySupport</code>, you will find that the ‘set default’ indicator
will flicker once, when first pressing and holding the <code>CTRL</code>
or <code>=/+</code> key, and then after a further very brief interval
will go on and stay on. On such systems, you should chose the lowest
value of <code>KeyForgetThreshold</code> at which you see only one
initial flicker and then no subsequent flickering. (Where this happens,
it is an unavoidable artefect on those systems of using
<code>KeySupport</code> to emulate raw keyboard data, which is not made
available by UEFI.)</p>
<p><em>Note 2</em>: <code>KeyForgetThreshold</code> should never need to
be more than about <code>9</code> or <code>10</code> at most. If it is
set to a value much higher than this, it will result in noticeably
unresponsive keyboard input. Therefore, for overall key responsiveness,
it is strongly recommended to configure a relatively lower value, at
which the ‘set default’ indicator flickers once and then does not
flicker, rather than using a much higher value (i.e. significantly
greater than <code>10</code>), which you may be able to find but should
not use, where the ‘set default’ indicator does not flicker at
all.</p></li>
<li><p><code>KeySupport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable internal keyboard input translation
to <code>AppleKeyMapAggregator</code> protocol.</p>
<p>This option activates the internal keyboard interceptor driver, based
on <code>AppleGenericInput</code>, also known as
<code>AptioInputFix</code>, to fill the
<code>AppleKeyMapAggregator</code> database for input functioning. In
cases where a separate driver such as <code>OpenUsbKbDxe</code> is used,
this option should never be enabled. Additionally, this option is not
required and should not be enabled with Apple firmware.</p></li>
<li><p><code>KeySupportMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Set internal keyboard input translation to
<code>AppleKeyMapAggregator</code> protocol mode.</p>
<ul>
<li><p><code>Auto</code> — Performs automatic choice as available with
the following preference: <code>AMI</code>, <code>V2</code>,
<code>V1</code>.</p></li>
<li><p><code>V1</code> — Uses UEFI standard legacy input protocol
<code>EFI_SIMPLE_TEXT_INPUT_PROTOCOL</code>.</p></li>
<li><p><code>V2</code> — Uses UEFI standard modern input protocol
<code>EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL</code>.</p></li>
<li><p><code>AMI</code> — Uses APTIO input protocol
<code>AMI_EFIKEYCODE_PROTOCOL</code>.</p></li>
</ul>
<p><em>Note</em>: Currently <code>V1</code>, <code>V2</code>, and
<code>AMI</code> unlike <code>Auto</code> only do filtering of the
particular specified protocol. This may change in the future
versions.</p></li>
<li><p><code>KeySwap</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Swap <code>Command</code> and
<code>Option</code> keys during submission.</p>
<p>This option may be useful for keyboard layouts with
<code>Option</code> key situated to the right of <code>Command</code>
key.</p></li>
<li><p><code>PointerSupport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable internal pointer driver.</p>
<p>This option implements standard UEFI pointer protocol
(<code>EFI_SIMPLE_POINTER_PROTOCOL</code>) through certain OEM
protocols. The option may be useful on Z87 ASUS boards, where
<code>EFI_SIMPLE_POINTER_PROTOCOL</code> is defective.</p></li>
<li><p><code>PointerSupportMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Set OEM protocol used for internal pointer
driver.</p>
<p>Currently the only supported variant is <code>ASUS</code>, using
specialised protocol available on certain Z87 and Z97 ASUS boards. More
details can be found in <a
href="https://github.com/LongSoft/UEFITool/pull/116"><code>LongSoft/UefiTool#116</code></a>.
The value of this property cannot be empty if
<code>PointerSupport</code> is enabled.</p></li>
<li><p><code>TimerResolution</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Set architecture timer resolution.</p>
<p>This option allows updating the firmware architecture timer period
with the specified value in <code>100</code> nanosecond units. Setting a
lower value typically improves performance and responsiveness of the
interface and input handling.</p>
<p>The recommended value is <code>50000</code> (<code>5</code>
milliseconds) or slightly higher. Select ASUS Z87 boards use
<code>60000</code> for the interface. Apple boards use
<code>100000</code>. In case of issues, this option can be left as
<code>0</code> to not change the timer resolution.</p></li>
</ol>
<h2 id="uefioutputprops">Output Properties</h2>
<ol>
<li><p><code>ClearScreenOnModeSwitch</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware only clear part of
the screen when switching from graphics to text mode, leaving a fragment
of previously drawn images visible. This option fills the entire
graphics screen with black colour before switching to text mode.</p>
<p><em>Note</em>: This option only applies to <code>System</code>
renderer.</p></li>
<li><p><code>ConsoleFont</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (use OpenCore builtin console
font)<br />
<strong>Description</strong>: Specify the console font to use for
OpenCore <code>Builtin</code> text renderer.</p>
<p>The font file must be located in
<code>EFI/OC/Resources/Font/{font-name}.hex</code> and must be 8x16
resolution. Various console fonts can be found online in either
<code>.bdf</code> or <code>.hex</code> format. <code>.bdf</code> can be
converted to <code>.hex</code> format using <code>gbdfed</code>
(available for Linux or macOS).</p>
<p>There is often no need to change console font, the main use-case
being to provide an extended character set for those relatively rare EFI
applications which have multi-lingual support (e.g.
<code>memtest86</code>).</p>
<p>The <a
href="https://github.com/acidanthera/OcBinaryData">OcBinaryData
repository</a> includes:</p>
<ul>
<li><p><a href="https://terminus-font.sourceforge.net/">Terminus</a> — A
font with extensive character support suitable for applications such as
the above.</p></li>
<li><p>TerminusCore — A lightly modified version of the Terminus font,
making some glyphs (<code>@KMRSTVWimrsw</code>) more similar to the free
ISO Latin font used in XNU and OpenCore.</p></li>
</ul>
<p><code>Terminus</code> and <code>TerminusCore</code> are provided
under the SIL Open Font License, Version 1.1. Some additional GPL
licensed fonts from the EPTO Fonts library, converted to the required
<code>.hex</code> format, can be found <a
href="https://github.com/mikebeaton/epto-fonts">here</a>.</p>
<p><em>Note 1</em>: On many newer systems the <code>System</code> text
renderer already provides a full set of international characters, in
which case this can be used without requiring the <code>Builtin</code>
renderer and a custom font.</p>
<p><em>Note 2</em>: This option only affects the <code>Builtin</code>
text renderer and only takes effect from the point at which the
<code>Builtin</code> renderer is configured. When console output is
visible before this point, it is using the system console font.</p></li>
<li><p><code>ConsoleMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Maintain current console mode)<br />
<strong>Description</strong>: Sets console output mode as specified with
the <code>WxH</code> (e.g. <code>80x24</code>) formatted string.</p>
<p>Set to <code>Max</code> to attempt using the largest available
console mode.</p>
<p><em>Note</em>: This field is best left empty on most types of
firmware.</p></li>
<li><p><code>DirectGopRendering</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use builtin graphics output protocol
renderer for console.</p>
<p>On certain firmware, such as on the <code>MacPro5,1</code>, this may
provide better performance or fix rendering issues. However, this option
is not recommended unless there is an obvious benefit as it may result
in issues such as slower scrolling.</p>
<p>This renderer fully supports <code>AppleEg2Info</code> protocol and
will provide screen rotation for all EFI applications. In order to
provide seamless rotation compatibility with <code>EfiBoot</code>,
builtin <code>AppleFramebufferInfo</code> should also be used, i.e. it
may need to be overridden on Mac EFI.</p></li>
<li><p><code>ForceResolution</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Forces <code>Resolution</code> to be set
in cases where the desired resolution is not available by default, such
as on legacy Intel GMA and first generation Intel HD Graphics
(Ironlake/Arrandale). Setting <code>Resolution</code> to
<code>Max</code> will try to pull the largest available resolution from
the connected display’s EDID.</p>
<p><em>Note</em>: This option depends on the <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Include/Acidanthera/Protocol/OcForceResolution.h"><code>OC_FORCE_RESOLUTION_PROTOCOL</code></a>
protocol being present. This protocol is currently only supported by
<code>OpenDuetPkg</code>. The <code>OpenDuetPkg</code> implementation
currently only supports Intel iGPUs and certain ATI GPUs.</p></li>
<li><p><code>GopBurstMode</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable write-combining (WC) caching for
GOP memory, if system firmware has not already enabled it.</p>
<p>Some older firmware (e.g. EFI-era Macs) fails to set write-combining
caching (aka burst mode) for GOP memory, even though the CPU supports
it. Setting this can give a considerable speed-up for GOP operations,
especially on systems which require <code>DirectGopRendering</code>.</p>
<p><em>Note 1</em>: This quirk takes effect whether or not
<code>DirectGopRendering</code> is set, and in some cases may give a
noticeable speed-up to GOP operations even when
<code>DirectGopRendering</code> is <code>false</code>.</p>
<p><em>Note 2</em>: On most systems from circa 2013 onwards,
write-combining caching is already applied by the firmware to GOP
memory, in which case <code>GopBurstMode</code> is unnecessary. On such
systems enabling the quirk should normally be harmless, producing an
<code>OCC:</code> debug log entry indicating that burst mode is already
started.</p>
<p><em>Note 3</em>: Some caution should be taken when enabling this
quirk, as it has been observed to cause hangs on a few systems. Since
additional guards have been added to try to prevent this, please log a
bugtracker issue if such a system is found.</p></li>
<li><p><code>GopPassThrough</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Disabled</code><br />
<strong>Description</strong>: Provide GOP protocol instances on top of
UGA protocol instances.</p>
<p>This option provides the GOP protocol via a UGA-based proxy for
firmware that do not implement the protocol. The supported values for
the option are as follows:</p>
<ul>
<li><p><code>Enabled</code> — provide GOP for all UGA
protocols.</p></li>
<li><p><code>Apple</code> — provide GOP for
<code>AppleFramebufferInfo</code>-enabled protocols.</p></li>
<li><p><code>Disabled</code> — do not provide GOP.</p></li>
</ul>
<p><em>Note</em>: This option requires <code>ProvideConsoleGop</code> to
be enabled.</p></li>
<li><p><code>IgnoreTextInGraphics</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware output text
onscreen in both graphics and text mode. This is typically unexpected as
random text may appear over graphical images and cause UI corruption.
Setting this option to <code>true</code> will discard all text output if
console control is not in <code>Text</code> mode.</p>
<p><em>Note</em>: This option only applies to the <code>System</code>
renderer.</p></li>
<li><p><code>InitialMode</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Auto</code><br />
<strong>Description</strong>: Selects the internal
<code>ConsoleControl</code> mode in which <code>TextRenderer</code> will
operate.</p>
<p>Available values are <code>Auto</code>, <code>Text</code> and
<code>Graphics</code>. <code>Text</code> and <code>Graphics</code>
specify the named mode. <code>Auto</code> uses the current mode of the
system <code>ConsoleControl</code> protocol when one exists, defaulting
to <code>Text</code> mode otherwise.</p>
<p>UEFI firmware typically supports <code>ConsoleControl</code> with two
rendering modes: <code>Graphics</code> and <code>Text</code>. Some types
of firmware do not provide a native <code>ConsoleControl</code> and
rendering modes. OpenCore and macOS expect text to only be shown in
<code>Text</code> mode but graphics to be drawn in any mode, and this is
how the OpenCore <code>Builtin</code> renderer behaves. Since this is
not required by the UEFI specification, behaviour of the system
<code>ConsoleControl</code> protocol, when it exists, may vary.</p></li>
<li><p><code>ProvideConsoleGop</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Ensure GOP (Graphics Output Protocol) on
console handle.</p>
<p>macOS bootloader requires GOP or UGA (for 10.4 EfiBoot) to be present
on console handle, yet the exact location of the graphics protocol is
not covered by the UEFI specification. This option will ensure GOP and
UGA, if present, are available on the console handle.</p>
<p><em>Note</em>: This option will also replace incompatible
implementations of GOP on the console handle, as may be the case on the
<code>MacPro5,1</code> when using modern GPUs.</p></li>
<li><p><code>ReconnectGraphicsOnConnect</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Reconnect all graphics drivers during
driver connection.</p>
<p>On certain firmware, it may be desireable to use an alternative
graphics driver, for example BiosVideo.efi, providing better screen
resolution options on legacy machines, or a driver supporting
<code>ForceResolution</code>. This option attempts to disconnect all
currently connected graphics drivers before connecting newly loaded
drivers.</p>
<p><em>Note</em>: This option requires <code>ConnectDrivers</code> to be
enabled.</p></li>
<li><p><code>ReconnectOnResChange</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Reconnect console controllers after
changing screen resolution.</p>
<p>On certain firmware, the controllers that produce the console
protocols (simple text out) must be reconnected when the screen
resolution is changed via GOP. Otherwise, they will not produce text
based on the new resolution.</p>
<p><em>Note</em>: On several boards this logic may result in black
screen when launching OpenCore from Shell and thus it is optional. In
versions prior to 0.5.2 this option was mandatory and not configurable.
Please do not use this unless required.</p></li>
<li><p><code>ReplaceTabWithSpace</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware do not print tab
characters or everything that follows them, causing difficulties in
using the UEFI Shell’s builtin text editor to edit property lists and
other documents. This option makes the console output spaces instead of
tabs.</p>
<p><em>Note</em>: This option only applies to <code>System</code>
renderer.</p></li>
<li><p><code>Resolution</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty (Maintain current screen
resolution)<br />
<strong>Description</strong>: Sets console output screen resolution.</p>
<ul>
<li><p>Set to <code>WxH@Bpp</code> (e.g. <code>1920x1080@32</code>) or
<code>WxH</code> (e.g. <code>1920x1080</code>) formatted string to
request custom resolution from GOP if available.</p></li>
<li><p>Set to <code>Max</code> to attempt using the largest available
screen resolution.</p></li>
</ul>
<p>On HiDPI screens <code>APPLE_VENDOR_VARIABLE_GUID</code>
<code>UIScale</code> NVRAM variable may need to be set to
<code>02</code> to enable HiDPI scaling in <code>Builtin</code> text
renderer, FileVault 2 UEFI password interface, and boot screen logo.
Refer to the <a href="#nvramvarsrec">Recommended Variables</a> section
for details.</p>
<p><em>Note</em>: This will fail when console handle has no GOP
protocol. When the firmware does not provide it, it can be added with
<code>ProvideConsoleGop</code> set to <code>true</code>.</p></li>
<li><p><code>SanitiseClearScreen</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware reset screen
resolutions to a failsafe value (such as <code>1024x768</code>) on the
attempts to clear screen contents when large display (e.g. 2K or 4K) is
used. This option attempts to apply a workaround.</p>
<p><em>Note</em>: This option only applies to the <code>System</code>
renderer. On all known affected systems, <code>ConsoleMode</code> must
be set to an empty string for this option to work.</p></li>
<li><p><code>TextRenderer</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>BuiltinGraphics</code><br />
<strong>Description</strong>: Chooses renderer for text going through
standard console output.</p>
<p>Currently two renderers are supported: <code>Builtin</code> and
<code>System</code>. The <code>System</code> renderer uses firmware
services for text rendering, however with additional options provided to
sanitize the output. The <code>Builtin</code> renderer bypasses firmware
services and performs text rendering on its own. Each renderer supports
a different set of options. It is recommended to use the
<code>Builtin</code> renderer, as it supports HiDPI mode and uses full
screen resolution.</p>
<p>Each renderer provides its own <code>ConsoleControl</code> protocol
(in the case of <code>SystemGeneric</code> only, this passes some
operations through to the system <code>ConsoleControl</code> protocol,
if one exists).</p>
<p>Valid values of this option are combinations of the renderer to use
and the <code>ConsoleControl</code> mode to set on the underlying system
<code>ConsoleControl</code> protocol before starting. To control the
initial mode of the provided <code>ConsoleControl</code> protocol once
started, use the <code>InitialMode</code> option.</p>
<ul>
<li><p><code>BuiltinGraphics</code> — Switch to <code>Graphics</code>
mode then use <code>Builtin</code> renderer with custom
<code>ConsoleControl</code>.</p></li>
<li><p><code>BuiltinText</code> — Switch to <code>Text</code> mode then
use <code>Builtin</code> renderer with custom
<code>ConsoleControl</code>.</p></li>
<li><p><code>SystemGraphics</code> — Switch to <code>Graphics</code>
mode then use <code>System</code> renderer with custom
<code>ConsoleControl</code>.</p></li>
<li><p><code>SystemText</code> — Switch to <code>Text</code> mode then
use <code>System</code> renderer with custom
<code>ConsoleControl</code>.</p></li>
<li><p><code>SystemGeneric</code> — Use <code>System</code> renderer
with custom a <code>ConsoleControl</code> protocol which passes its mode
set and get operations through to system <code>ConsoleControl</code>
when it exists.</p></li>
</ul>
<p>The use of <code>BuiltinGraphics</code> is straightforward. For most
platforms, it is necessary to enable <code>ProvideConsoleGop</code> and
set <code>Resolution</code> to <code>Max</code>. The
<code>BuiltinText</code> variant is an alternative to
<code>BuiltinGraphics</code> for some very old and defective laptop
firmware, which can only draw in <code>Text</code> mode.</p>
<p>The use of <code>System</code> protocols is more complicated.
Typically, the preferred setting is <code>SystemGraphics</code> or
<code>SystemText</code>. Enabling <code>ProvideConsoleGop</code>,
setting <code>Resolution</code> to <code>Max</code>, enabling
<code>ReplaceTabWithSpace</code> is useful on almost all platforms.
<code>SanitiseClearScreen</code>, <code>IgnoreTextInGraphics</code>, and
<code>ClearScreenOnModeSwitch</code> are more specific, and their use
depends on the firmware.</p>
<p><em>Note</em>: Some Macs, such as the <code>MacPro5,1</code>, may
have incompatible console output when using modern GPUs, and thus only
<code>BuiltinGraphics</code> may work for them in such cases. NVIDIA
GPUs may require additional <a
href="https://github.com/acidanthera/bugtracker/issues/1280">firmware
upgrades</a>.</p></li>
<li><p><code>UIScale</code><br />
<strong>Type</strong>: <code>plist integer</code>, 8 bit<br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Description</strong>: User interface scaling factor.</p>
<p>Corresponds to
<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14:UIScale</code> variable.</p>
<ul>
<li><p><code>1</code> — 1x scaling, corresponds to normal
displays.</p></li>
<li><p><code>2</code> — 2x scaling, corresponds to HiDPI
displays.</p></li>
<li><p><code>-1</code> — leaves the current variable unchanged.</p></li>
<li><p><code>0</code> — automatically chooses scaling based on the
current resolution.</p></li>
</ul>
<p><em>Note 1</em>: Automatic scale factor detection works on the basis
of total pixel area and may fail on small HiDPI displays, in which case
the value may be manually managed using the NVRAM section.</p>
<p><em>Note 2</em>: When switching from manually specified NVRAM
variable to this preference an NVRAM reset may be needed.</p></li>
<li><p><code>UgaPassThrough</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Provide UGA protocol instances on top of
GOP protocol instances.</p>
<p>Some types of firmware do not implement the legacy UGA protocol but
this may be required for screen output by older EFI applications such as
EfiBoot from 10.4.</p></li>
</ol>
<h2 id="uefiprotoprops">ProtocolOverrides Properties</h2>
<ol>
<li><p><code>AppleAudio</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces Apple audio protocols with
builtin versions.</p>
<p>Apple audio protocols allow OpenCore and the macOS bootloader to play
sounds and signals for screen reading or audible error reporting.
Supported protocols are beep generation and VoiceOver. The VoiceOver
protocol is only provided natively by Gibraltar machines (T2), however
versions of macOS which support VoiceOver will see and use the
implementation provided by OpenCore, on screens such as FileVault 2
unlock. VoiceOver is not supported before macOS High Sierra (10.13).
Older macOS versions use the AppleHDA protocol (which is not currently
implemented) instead.</p>
<p>Only one set of audio protocols can be available at a time, so this
setting should be enabled in order to enable audio playback in the
OpenCore user interface on Mac systems implementing some of these
protocols.</p>
<p><em>Note</em>: The backend audio driver needs to be configured in
<code>UEFI Audio</code> section for these protocols to be able to stream
audio.</p></li>
<li><p><code>AppleBootPolicy</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple Boot Policy protocol
with a builtin version. This may be used to ensure APFS compatibility on
VMs and legacy Macs.</p>
<p><em>Note</em>: This option is advisable on certain Macs, such as the
<code>MacPro5,1</code>, that are APFS compatible but on which the Apple
Boot Policy protocol has recovery detection issues.</p></li>
<li><p><code>AppleDebugLog</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple Debug Log protocol with
a builtin version.</p></li>
<li><p><code>AppleEg2Info</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple EFI Graphics 2 protocol
with a builtin version.</p>
<p><em>Note 1</em>: This protocol allows newer <code>EfiBoot</code>
versions (at least 10.15) to expose screen rotation to macOS. Refer to
<code>ForceDisplayRotationInEFI</code> variable description on how to
set screen rotation angle.</p>
<p><em>Note 2</em>: On systems without native support for
<code>ForceDisplayRotationInEFI</code>,
<code>DirectGopRendering=true</code> is also required for this setting
to have an effect.</p></li>
<li><p><code>AppleFramebufferInfo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple Framebuffer Info
protocol with a builtin version. This may be used to override
framebuffer information on VMs and legacy Macs to improve compatibility
with legacy EfiBoot such as the one in Mac OS X 10.4.</p>
<p><em>Note</em>: The current implementation of this property results in
it only being active when GOP is available (it is always equivalent to
<code>false</code> otherwise).</p></li>
<li><p><code>AppleImageConversion</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple Image Conversion
protocol with a builtin version.</p></li>
<li><p><code>AppleImg4Verification</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple IMG4 Verification
protocol with a builtin version. This protocol is used to verify
<code>im4m</code> manifest files used by Apple Secure Boot.</p></li>
<li><p><code>AppleKeyMap</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces Apple Key Map protocols with
builtin versions.</p></li>
<li><p><code>AppleRtcRam</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple RTC RAM protocol with a
builtin version.</p>
<p><em>Note</em>: Builtin version of Apple RTC RAM protocol may filter
out I/O attempts to certain RTC memory addresses. The list of addresses
can be specified in
<code>4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:rtc-blacklist</code> variable
as a data array.</p></li>
<li><p><code>AppleSecureBoot</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple Secure Boot protocol
with a builtin version.</p></li>
<li><p><code>AppleSmcIo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple SMC I/O protocol with a
builtin version.</p>
<p>This protocol replaces the legacy <code>VirtualSmc</code> UEFI
driver, and is compatible with any SMC kernel extension. However, in
case the <code>FakeSMC</code> kernel extension is used, manual NVRAM key
variable addition may be needed.</p></li>
<li><p><code>AppleUserInterfaceTheme</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Apple User Interface Theme
protocol with a builtin version.</p></li>
<li><p><code>DataHub</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Data Hub protocol with a
builtin version.</p>
<p><em>Note</em>: This will discard all previous entries if the protocol
was already installed, so all properties required for the safe operation
of the system must be specified in the configuration file.</p></li>
<li><p><code>DeviceProperties</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the Device Property protocol with
a builtin version. This may be used to ensure full compatibility on VMs
and legacy Macs.</p>
<p><em>Note</em>: This will discard all previous entries if the protocol
was already installed, so all properties required for safe operation of
the system must be specified in the configuration file.</p></li>
<li><p><code>FirmwareVolume</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Wraps Firmware Volume protocols, or
installs a new version, to support custom cursor images for FileVault 2.
Set to <code>true</code> to ensure FileVault 2 compatibility on anything
other than on VMs and legacy Macs.</p>
<p><em>Note</em>: Several virtual machines, including VMware, may have
corrupted cursor images in HiDPI mode and thus, may also require
enabling this setting.</p></li>
<li><p><code>HashServices</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces Hash Services protocols with
builtin versions. Set to <code>true</code> to ensure FileVault 2
compatibility on platforms with defective SHA-1 hash implementations.
This can be determined by an invalid cursor size when
<code>UIScale</code> is set to <code>02</code>. Platforms earlier than
APTIO V (Haswell and older) are typically affected.</p></li>
<li><p><code>OSInfo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces the OS Info protocol with a
builtin version. This protocol is typically used by the firmware and
other applications to receive notifications from the macOS
bootloader.</p></li>
<li><p><code>PciIo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces functions in CpuIo and
PciRootBridgeIo with 64-bit MMIO compatible ones to fix
<code>Invalid Parameter</code> when using 4G Decoding. This affects UEFI
drivers such as <code>AudioDxe</code> which access 64-bit MMIO devices.
Platforms earlier than APTIO V (Haswell and older) are typically
affected.</p></li>
<li><p><code>UnicodeCollation</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Replaces unicode collation services with
builtin versions. Set to <code>true</code> to ensure UEFI Shell
compatibility on platforms with defective unicode collation
implementations. Legacy Insyde and APTIO platforms on Ivy Bridge, and
earlier, are typically affected.</p></li>
</ol>
<h2 id="uefiquirkprops">Quirks Properties</h2>
<ol>
<li><p><code>ActivateHpetSupport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Activates HPET support.</p>
<p>Older boards like ICH6 may not always have HPET setting in the
firmware preferences, this option tries to force enable it.</p></li>
<li><p><code>DisableSecurityPolicy</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Disable platform security policy.</p>
<p><em>Note</em>: This setting disables various security features of the
firmware, defeating the purpose of any kind of Secure Boot. Do NOT
enable if using UEFI Secure Boot.</p></li>
<li><p><code>EnableVectorAcceleration</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable AVX vector acceleration of SHA-512
and SHA-384 hashing algorithms.</p>
<p><em>Note</em>: This option may cause issues on certain laptop
firmwares, including Lenovo.</p></li>
<li><p><code>EnableVmx</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enable Intel virtual machine
extensions.</p>
<p><em>Note</em>: Required to allow virtualization in Windows on some
Mac hardware. VMX is enabled or disabled and locked by BIOS before
OpenCore starts on most firmware. Use BIOS to enable virtualization
where possible.</p></li>
<li><p><code>ExitBootServicesDelay</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Adds delay in microseconds after
<code>EXIT_BOOT_SERVICES</code> event.</p>
<p>This is a very rough workaround to circumvent the
<code>Still waiting for root device</code> message on some APTIO IV
firmware (ASUS Z87-Pro) particularly when using FileVault 2. It appears
that for some reason, they execute code in parallel to
<code>EXIT_BOOT_SERVICES</code>, which results in the SATA controller
being inaccessible from macOS. A better approach is required and
Acidanthera is open to suggestions. Expect 3 to 5 seconds to be adequate
when this quirk is needed.</p></li>
<li><p><code>ForceOcWriteFlash</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Enables writing to flash memory for all
OpenCore-managed NVRAM system variables.</p>
<p><em>Note</em>: This value should be disabled on most types of
firmware but is left configurable to account for firmware that may have
issues with volatile variable storage overflows or similar. Boot issues
across multiple OSes can be observed on e.g. Lenovo Thinkpad T430 and
T530 without this quirk. Apple variables related to Secure Boot and
hibernation are exempt from this for security reasons. Furthermore, some
OpenCore variables are exempt for different reasons, such as the boot
log due to an available user option, and the TSC frequency due to timing
issues. When toggling this option, a NVRAM reset may be required to
ensure full functionality.</p></li>
<li><p><code>ForgeUefiSupport</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Implement partial UEFI 2.x support on EFI
1.x firmware.</p>
<p>This setting allows running some software written for UEFI 2.x
firmware, such as NVIDIA GOP Option ROMs, on hardware with older EFI 1.x
firmware (e.g. <code>MacPro5,1</code>).</p></li>
<li><p><code>IgnoreInvalidFlexRatio</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware (such as APTIO IV)
may contain invalid values in the <code>MSR_FLEX_RATIO</code>
(<code>0x194</code>) MSR register. These values may cause macOS boot
failures on Intel platforms.</p>
<p><em>Note</em>: While the option is not expected to harm unaffected
firmware, its use is recommended only when specifically
required.</p></li>
<li><p><code>ReleaseUsbOwnership</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Attempt to detach USB controller ownership
from the firmware driver. While most types of firmware manage to do this
properly, or at least have an option for this, some do not. As a result,
the operating system may freeze upon boot. Not recommended unless
specifically required.</p></li>
<li><p><code>ReloadOptionRoms</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Query PCI devices and reload their Option
ROMs if available.</p>
<p>For example, this option allows reloading NVIDIA GOP Option ROM on
older Macs after the firmware version is upgraded via
<code>ForgeUefiSupport</code>.</p></li>
<li><p><code>RequestBootVarRouting</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Request redirect of all <code>Boot</code>
prefixed variables from <code>EFI_GLOBAL_VARIABLE_GUID</code> to
<code>OC_VENDOR_VARIABLE_GUID</code>.</p>
<p>This quirk requires <code>OC_FIRMWARE_RUNTIME</code> protocol
implemented in <code>OpenRuntime.efi</code>. The quirk lets default boot
entry preservation at times when the firmware deletes incompatible boot
entries. In summary, this quirk is required to reliably use the <a
href="https://support.apple.com/HT202796">Startup Disk</a> preference
pane in firmware that is not compatible with macOS boot entries by
design.</p>
<p>By redirecting <code>Boot</code> prefixed variables to a separate
GUID namespace with the help of <code>RequestBootVarRouting</code> quirk
we achieve multiple goals:</p>
<ul>
<li><p>Operating systems are jailed and only controlled by OpenCore boot
environment to enhance security.</p></li>
<li><p>Operating systems do not mess with OpenCore boot priority, and
guarantee fluent updates and hibernation wakes for cases that require
reboots with OpenCore in the middle.</p></li>
<li><p>Potentially incompatible boot entries, such as macOS entries, are
not deleted or corrupted in any way.</p></li>
</ul></li>
<li><p><code>ResizeGpuBars</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>-1</code><br />
<strong>Description</strong>: Configure GPU PCI BAR sizes.</p>
<p>This quirk sets GPU PCI BAR sizes as specified or chooses the largest
available below the <code>ResizeGpuBars</code> value. The specified
value follows PCI Resizable BAR spec. Use <code>0</code> for 1 MB,
<code>1</code> for 2 MB, <code>2</code> for 4 MB, and so on up to
<code>19</code> for 512 GB.</p>
<p>Resizable BAR technology allows to ease PCI device programming by
mapping a configurable memory region, BAR, into CPU address space (e.g.
VRAM to RAM) as opposed to a fixed memory region. This technology is
necessary, because one cannot map the largest memory region by default,
for the reasons of backwards compatibility with older hardware not
supporting 64-bit BARs. Consequentially devices of the last decade use
BARs up to 256 MB by default (4 remaining bits are used by other data)
but generally allow resizing them to both smaller and larger powers of
two (e.g. from 1 MB up to VRAM size).</p>
<p>Operating systems targeting x86 platforms generally do not control
PCI address space, letting UEFI firmware decide on the BAR addresses and
sizes. This illicit practice resulted in Resizable BAR technology being
unused up until 2020 despite being standardised in 2008 and becoming
widely available in the hardware soon after.</p>
<p>Modern UEFI firmware allow the use of Resizable BAR technology but
generally restrict the configurable options to failsafe default
(<code>OFF</code>) and maximum available (<code>ON</code>). This quirk
allows to fine-tune this value for testing and development purposes.</p>
<p>Consider a GPU with 2 BARs:</p>
<ul>
<li><p><code>BAR0</code> supports sizes from 256 MB to 8 GB. Its value
is 4 GB.</p></li>
<li><p><code>BAR1</code> supports sizes from 2 MB to 256 MB. Its value
is 256 MB.</p></li>
</ul>
<p><em>Example 1</em>: Setting <code>ResizeGpuBars</code> to 1 GB will
change <code>BAR0</code> to 1 GB and leave <code>BAR1</code>
unchanged.<br />
<em>Example 2</em>: Setting <code>ResizeGpuBars</code> to 1 MB will
change <code>BAR0</code> to 256 MB and <code>BAR0</code> to 2 MB.<br />
<em>Example 3</em>: Setting <code>ResizeGpuBars</code> to 16 GB will
change <code>BAR0</code> to 8 GB and leave <code>BAR1</code>
unchanged.</p>
<p><em>Note 1</em>: This quirk shall not be used to workaround macOS
limitation to address BARs over 1 GB. <code>ResizeAppleGpuBars</code>
should be used instead.</p>
<p><em>Note 2</em>: While this quirk can increase GPU PCI BAR sizes,
this will not work on most firmware as is, because the quirk does not
relocate BARs in memory, and they will likely overlap. In most cases it
is best to either update the firmware to the latest version or customise
it with a specialised driver like <a
href="https://github.com/xCuri0/ReBarUEFI">ReBarUEFI</a>.</p></li>
<li><p><code>ResizeUsePciRbIo</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Use PciRootBridgeIo for
<code>ResizeGpuBars</code> and <code>ResizeAppleGpuBars</code></p>
<p>The quirk makes <code>ResizeGpuBars</code> and
<code>ResizeAppleGpuBars</code> use <code>PciRootBridgeIo</code> instead
of PciIo. This is needed on systems with a buggy <code>PciIo</code>
implementation where trying to configure Resizable BAR results in
<code>Capability I/O Error</code>. Typically this is required on older
systems which have been modified with <a
href="https://github.com/xCuri0/ReBarUEFI">ReBarUEFI</a>.</p></li>
<li><p><code>ShimRetainProtocol</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Request Linux Shim to keep protocol
installed for subsequent image loads.</p>
<p>This option is only required if chaining OpenCore from Shim. It must
be set in order to allow OpenCore to launch items which are verified by
certificates present in Shim, but not in the system Secure Boot
database.</p></li>
<li><p><code>TscSyncTimeout</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Attempts to perform TSC synchronisation
with a specified timeout.</p>
<p>The primary purpose of this quirk is to enable early bootstrap TSC
synchronisation on some server and laptop models when running a debug
XNU kernel. For the debug kernel the TSC needs to be kept in sync across
the cores before any kext could kick in rendering all other solutions
problematic. The timeout is specified in microseconds and depends on the
amount of cores present on the platform, the recommended starting value
is <code>500000</code>.</p>
<p>This is an experimental quirk, which should only be used for the
aforementioned problem. In all other cases, the quirk may render the
operating system unstable and is not recommended. The recommended
solution in the other cases is to install a kernel extension such as <a
href="https://github.com/RehabMan/VoodooTSCSync">VoodooTSCSync</a>, <a
href="https://github.com/interferenc/TSCAdjustReset">TSCAdjustReset</a>,
or <a href="https://github.com/lvs1974/CpuTscSync">CpuTscSync</a> (a
more specialised variant of VoodooTSCSync for newer laptops).</p>
<p><em>Note</em>: This quirk cannot replace the kernel extension because
it cannot operate in ACPI S3 (sleep wake) mode and because the UEFI
firmware only provides very limited multicore support which prevents
precise updates of the MSR registers.</p></li>
<li><p><code>UnblockFsConnect</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: Some types of firmware block partition
handles by opening them in <code>By Driver</code> mode, resulting in an
inability to install File System protocols.</p>
<p><em>Note</em>: This quirk is useful in cases where unsuccessful drive
detection results in an absence of boot entries.</p></li>
</ol>
<h2 id="uefirsvdprops">ReservedMemory Properties</h2>
<ol>
<li><p><code>Address</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Start address of the reserved memory
region, which should be allocated as reserved effectively marking the
memory of this type inaccessible to the operating system.</p>
<p>The addresses written here must be part of the memory map, have a
<code>EfiConventionalMemory</code> type, and be page-aligned (4
KBs).</p>
<p><em>Note</em>: Some types of firmware may not allocate memory areas
used by S3 (sleep) and S4 (hibernation) code unless CSM is enabled
causing wake failures. After comparing the memory maps with CSM disabled
and enabled, these areas can be found in the lower memory and can be
fixed up by doing the reservation. Refer to the
<code>Sample.plist</code> file for details.</p></li>
<li><p><code>Comment</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: Empty<br />
<strong>Description</strong>: Arbitrary ASCII string used to provide
human readable reference for the entry. Whether this value is used is
implementation defined.</p></li>
<li><p><code>Enabled</code><br />
<strong>Type</strong>: <code>plist boolean</code><br />
<strong>Failsafe</strong>: <code>false</code><br />
<strong>Description</strong>: This region will not be reserved unless
set to <code>true</code>.</p></li>
<li><p><code>Size</code><br />
<strong>Type</strong>: <code>plist integer</code><br />
<strong>Failsafe</strong>: <code>0</code><br />
<strong>Description</strong>: Size of the reserved memory region, must
be page-aligned (4 KBs).</p></li>
<li><p><code>Type</code><br />
<strong>Type</strong>: <code>plist string</code><br />
<strong>Failsafe</strong>: <code>Reserved</code><br />
<strong>Description</strong>: Memory region type matching the UEFI
specification memory descriptor types. Mapping:</p>
<ul>
<li><p><code>Reserved</code> —
<code>EfiReservedMemoryType</code></p></li>
<li><p><code>LoaderCode</code> — <code>EfiLoaderCode</code></p></li>
<li><p><code>LoaderData</code> — <code>EfiLoaderData</code></p></li>
<li><p><code>BootServiceCode</code> —
<code>EfiBootServicesCode</code></p></li>
<li><p><code>BootServiceData</code> —
<code>EfiBootServicesData</code></p></li>
<li><p><code>RuntimeCode</code> —
<code>EfiRuntimeServicesCode</code></p></li>
<li><p><code>RuntimeData</code> —
<code>EfiRuntimeServicesData</code></p></li>
<li><p><code>Available</code> —
<code>EfiConventionalMemory</code></p></li>
<li><p><code>Persistent</code> —
<code>EfiPersistentMemory</code></p></li>
<li><p><code>UnusableMemory</code> —
<code>EfiUnusableMemory</code></p></li>
<li><p><code>ACPIReclaimMemory</code> —
<code>EfiACPIReclaimMemory</code></p></li>
<li><p><code>ACPIMemoryNVS</code> —
<code>EfiACPIMemoryNVS</code></p></li>
<li><p><code>MemoryMappedIO</code> —
<code>EfiMemoryMappedIO</code></p></li>
<li><p><code>MemoryMappedIOPortSpace</code> —
<code>EfiMemoryMappedIOPortSpace</code></p></li>
<li><p><code>PalCode</code> — <code>EfiPalCode</code></p></li>
</ul></li>
</ol>
<h1 id="troubleshooting">Troubleshooting</h1>
<h2 id="legacyapple">Legacy Apple OS</h2>
<p>Older operating systems may be more complicated to install, but are
sometimes necessary for various reasons. While a compatible board
identifier and CPUID are the obvious requirements for proper functioning
of an older operating system, there are many other less obvious things
to consider. This section covers a common set of issues relevant to
installing older macOS operating systems.</p>
<p>While newer operating systems can be downloaded over the internet,
older operating systems did not have installation media for every minor
release. For compatible distributions of such, download a
device-specific image and modify it if necessary. Visit this archived
Apple Support <a
href="https://web.archive.org/web/20170705003629/https://support.apple.com/en-us/HT204319">article</a>
for a list of the bundled device-specific builds for legacy operating
systems. However, as this may not always be accurate, the latest
versions are listed below.</p>
<h3 id="legacy108">OS X 10.8 and 10.9</h3>
<ul>
<li><p>Disk images on these systems use the Apple Partitioning Scheme
and require the <code>OpenPartitionDxe</code> driver to run DMG recovery
and installation (included in OpenDuet). It is possible to set
<code>DmgLoading</code> to <code>Disabled</code> to run the recovery
without DMG loading avoiding the need for
<code>OpenPartitionDxe</code>.</p></li>
<li><p>Cached kernel images often do not contain family drivers for
networking (<code>IONetworkingFamily</code>) or audio
(<code>IOAudioFamily</code>) requiring the use of <code>Force</code>
loading in order to inject networking or audio drivers.</p></li>
</ul>
<h3 id="legacy107">Mac OS X 10.7</h3>
<ul>
<li><p>All previous issues apply.</p></li>
<li><p><code>SSSE3</code> support (not to be confused with
<code>SSE3</code> support) is a hard requirement for Mac OS X 10.7
kernel.</p></li>
<li><p>Many kexts, including <code>Lilu</code> when 32-bit kernel is
used and a lot of <code>Lilu</code> plugins, are unsupported on Mac OS
X 10.7 and older as they require newer kernel APIs, which are not part
of the Mac OS X 10.7 SDK.</p></li>
<li><p>Prior to OS X 10.8 KASLR sliding is not supported, which will
result in memory allocation failures on firmware that utilise lower
memory for their own purposes. Refer to <a
href="https://github.com/acidanthera/bugtracker/issues/1125">acidanthera/bugtracker#1125</a>
for tracking.</p></li>
</ul>
<h3 id="legacy106">Mac OS X 10.6</h3>
<ul>
<li><p>All previous issues apply.</p></li>
<li><p><code>SSSE3</code> support is a requirement for Mac OS X 10.6
kernel with 64-bit userspace enabled. This limitation can mostly be
lifted by enabling the <code>LegacyCommpage</code> quirk.</p></li>
<li><p>Last released installer images for Mac OS X 10.6 are Mac OS
X 10.6.7 builds <code>10J3250</code> (for <code>MacBookPro8,x</code>)
and <code>10J4139</code> (for <code>iMac12,x</code>), without Xcode).
These images are limited to their target model identifiers and have no
<code>-no_compat_check</code> boot argument support. Modified images
(with <code>ACDT</code> suffix) without model restrictions can be found
<a
href="https://archive.org/details/10.6.7-10j3250-disk-images">here</a>
(<a href="https://mega.nz/folder/z5YUhYTb#gA_IRY5KMuYpnNCg7kR3ug">MEGA
Mirror</a>), assuming Mac OS X 10.6 is legally owned. Refer to the
<code>DIGEST.txt</code> file for details. Note that these are the
earliest tested versions of Mac OS X 10.6 with OpenCore.</p></li>
</ul>
<p>Model checking may also be erased by editing
<code>OSInstall.mpkg</code> with e.g. <code>Flat Package Editor</code>
by making <code>Distribution</code> script to always return
<code>true</code> in <code>hwbeModelCheck</code> function. Since
updating the only file in the image and not corrupting other files can
be difficult and may cause slow booting due to kernel cache date
changes, it is recommended to script image rebuilding as shown
below:</p>
<pre id="snowrebuild" data-label="snowrebuild" style="ocbash"><code>#!/bin/bash
# Original.dmg is original image, OSInstall.mpkg is patched package
mkdir RO
hdiutil mount Original.dmg -noverify -noautoopen -noautoopenrw -noautofsck -mountpoint RO
cp RO/.DS_Store DS_STORE
hdiutil detach RO -force
rm -rf RO
hdiutil convert Original.dmg -format UDRW -o ReadWrite.dmg
mkdir RW
xattr -c OSInstall.mpkg
hdiutil mount ReadWrite.dmg -noverify -noautoopen -noautoopenrw -noautofsck -mountpoint RW
cp OSInstall.mpkg RW/System/Installation/Packages/OSInstall.mpkg
killall Finder fseventsd
rm -rf RW/.fseventsd
cp DS_STORE RW/.DS_Store
hdiutil detach RW -force
rm -rf DS_STORE RW
hdiutil convert ReadWrite.dmg -format UDZO -o ReadOnly.dmg</code></pre>
<h3 id="legacy105">Mac OS X 10.5</h3>
<ul>
<li><p>All previous issues apply.</p></li>
<li><p>This macOS version does not support <code>x86_64</code> kernel
and requires <code>i386</code> kernel extensions and patches.</p></li>
<li><p>This macOS version uses the first (V1) version of
<code>prelinkedkernel</code>, which has kext symbol tables corrupted by
the kext tools. This nuance renders <code>prelinkedkernel</code> kext
injection impossible in OpenCore. <code>Mkext</code> kext injection will
still work without noticeable performance drain and will be chosen
automatically when <code>KernelCache</code> is set to
<code>Auto</code>.</p></li>
<li><p>Last released installer image for Mac OS X 10.5 is Mac OS
X 10.5.7 build <code>9J3050</code> (for <code>MacBookPro5,3</code>).
Unlike the others, this image is not limited to the target model
identifiers and can be used as is. The original <code>9J3050</code>
image can be found <a
href="https://archive.org/details/10.5.7-9-j-3050">here</a> (<a
href="https://mega.nz/folder/inRBTarD#zanf7fUbviwz3WHBU5xpCg">MEGA
Mirror</a>), assuming Mac OS X 10.5 is legally owned. Refer to the
<code>DIGEST.txt</code> file for details. Note that this is the earliest
tested version of Mac OS X 10.5 with OpenCore.</p></li>
</ul>
<h3 id="legacy104">Mac OS X 10.4</h3>
<ul>
<li><p>All previous issues apply.</p></li>
<li><p>This macOS version has a hard requirement to access all the
optional packages on the second DVD disk installation media, requiring
either two disks or USB media installation.</p></li>
<li><p>Last released installer images for Mac OS X 10.4 are Mac OS
X 10.4.10 builds <code>8R4061a</code> (for <code>MacBookPro3,1</code>)
and <code>8R4088</code> (for <code>iMac7,1</code>)). These images are
limited to their target model identifiers as on newer macOS versions.
Modified <code>8R4088</code> images (with <code>ACDT</code> suffix)
without model restrictions can be found <a
href="https://archive.org/details/10.4.10-8-r-4088-acdt">here</a> (<a
href="https://mega.nz/folder/D3ASzLzA#7sjYXE2X09f6aGjol_C7dg">MEGA
Mirror</a>), assuming Mac OS X 10.4 is legally owned. Refer to the
<code>DIGEST.txt</code> file for details. Note that these are the
earliest tested versions of Mac OS X 10.4 with OpenCore.</p></li>
</ul>
<h2 id="uefisecureboot">UEFI Secure Boot</h2>
<p>OpenCore is designed to provide a secure boot chain between firmware
and operating system. On most x86 platforms trusted loading is
implemented via <a
href="https://en.wikipedia.org/wiki/UEFI_Secure_Boot">UEFI Secure
Boot</a> model. Not only OpenCore fully supports this model, but it also
extends its capabilities to ensure sealed configuration via <a
href="#securevaulting">vaulting</a> and provide trusted loading to the
operating systems using custom verification, such as <a
href="#secureapplesb">Apple Secure Boot</a>. Proper secure boot chain
requires several steps and careful configuration of certain settings as
explained below:</p>
<ol>
<li><p>Enable Apple Secure Boot by setting <code>SecureBootModel</code>
to run macOS. Note, that not every macOS is compatible with Apple Secure
Boot and there are several other restrictions as explained in <a
href="#secureapplesb">Apple Secure Boot</a> section.</p></li>
<li><p>Disable DMG loading by setting <code>DmgLoading</code> to
<code>Disabled</code> if users have concerns of loading old vulnerable
DMG recoveries. This is <strong>not</strong> required, but recommended.
For the actual tradeoffs see the details in <a
href="#securedmgloading">DMG loading</a> section.</p></li>
<li><p>Make sure that APFS JumpStart functionality restricts the loading
of old vulnerable drivers by setting <code>MinDate</code> and
<code>MinVersion</code> to <code>0</code>. More details are provided in
<a href="#uefiapfsprops">APFS JumpStart</a> section. An alternative is
to install <code>apfs.efi</code> driver manually.</p></li>
<li><p>Make sure that <code>Force</code> driver loading is not needed
and all the operating systems are still bootable.</p></li>
<li><p>Make sure that <code>ScanPolicy</code> restricts loading from
undesired devices. It is a good idea to prohibit all removable drivers
or unknown filesystems.</p></li>
<li><p>Sign all the installed drivers and tools with the private key. Do
not sign tools that provide administrative access to the computer, such
as UEFI Shell.</p></li>
<li><p>Vault the configuration as explained <a
href="#securevaulting">Vaulting</a> section.</p></li>
<li><p>Sign all OpenCore binaries (<code>BOOTX64.efi</code>,
<code>BOOTIa32.efi</code>, <code>OpenCore.efi</code>, custom launchers)
used on this system with the same private key.</p></li>
<li><p>Sign all third-party operating system (not made by Microsoft or
Apple) bootloaders if needed. For Linux there is an option to install a
user built, user signed Shim bootloader giving SBAT and MOK integration,
as explained in the <code>/Utilities/ShimUtils</code> directory of
OpenCore source or releases.</p></li>
<li><p>Enable UEFI Secure Boot in firmware preferences and install the
certificate with a private key. Details on how to generate a certificate
can be found in various articles, such as <a
href="https://habr.com/en/post/273497">this one</a>, and are out of the
scope of this document. If Windows is needed one will also need to add
the <a href="http://go.microsoft.com/fwlink/?LinkID=321192">Microsoft
Windows Production CA 2011</a>. To launch option ROMs or to use signed
Linux drivers if not using a user build of Shim, <a
href="http://go.microsoft.com/fwlink/?LinkId=321194">Microsoft UEFI
Driver Signing CA</a> will also be needed.</p></li>
<li><p>Password-protect changing firmware settings to ensure that UEFI
Secure Boot cannot be disabled without the user’s knowledge.</p></li>
</ol>
<h2 id="troubleshootingwin">Windows support</h2>
<p><strong>Can I install Windows?</strong></p>
<p>While no official Windows support is provided, 64-bit UEFI Windows
installations (Windows 8 and above) prepared with Boot Camp are supposed
to work. Third-party UEFI installations as well as systems partially
supporting UEFI boot, such as Windows 7, might work with some extra
precautions. Things to consider:</p>
<ul>
<li><p>MBR (Master Boot Record) installations are legacy and are only
supported with the OpenLegacyBoot driver on legacy systems.</p></li>
<li><p>All the modifications applied (to ACPI, NVRAM, SMBIOS, etc.) are
supposed to be operating system agnostic, i.e. apply equally regardless
of the OS booted. This enables Boot Camp software experience on
Windows.</p></li>
<li><p>macOS requires the first partition to be EFI System Partition,
and does not support the default Windows layout. While OpenCore does
have a <a
href="https://github.com/acidanthera/bugtracker/issues/327">workaround</a>
for this, it is highly recommend not to rely on it and install
properly.</p></li>
<li><p>Windows may need to be reactivated. To avoid it consider setting
SystemUUID to the original firmware UUID. Be aware that it may be
invalid on old firmware, i.e., not random. If there still are issues,
consider using HWID or KMS38 license or making the use
<code>Custom</code> <code>UpdateSMBIOSMode</code>. Other nuances of
Windows activation are out of the scope of this document and can be
found online.</p></li>
</ul>
<p><strong>What additional software do I need?</strong></p>
<p>To enable operating system switching and install relevant drivers in
the majority of cases Windows support software from <a
href="https://support.apple.com/boot-camp">Boot Camp</a> is required.
For simplicity of the download process or when configuring an already
installed Windows version a third-party utility, <a
href="https://github.com/timsutton/brigadier">Brigadier</a>, can be used
successfully. Note, that <a href="https://www.7-zip.org">7-Zip</a> may
be downloaded and installed prior to using Brigadier.</p>
<p>Remember to always use the latest version of Windows support software
from Boot Camp, as versions prior to 6.1 do not support APFS, and thus
will not function correctly. To download newest software pass most
recent Mac model to Brigadier, for example
<code>./brigadier.exe -m iMac19,1</code>. To install Boot Camp on an
unsupported Mac model afterwards run PowerShell as Administrator and
enter <code>msiexec /i BootCamp.msi</code>. If there is a previous
version of Boot Camp installed it should be removed first by running
<code>msiexec /x BootCamp.msi</code> command. <code>BootCamp.msi</code>
file is located in <code>BootCamp/Drivers/Apple</code> directory and can
be reached through Windows Explorer.</p>
<p>While Windows support software from Boot Camp solves most of
compatibility problems, the rest may still have to be addressed
manually:</p>
<ul>
<li><p>To invert mouse wheel scroll direction <code>FlipFlopWheel</code>
must be set to <code>1</code> as explained on <a
href="https://superuser.com/a/364353">SuperUser</a>.</p></li>
<li><p><code>RealTimeIsUniversal</code> must be set to <code>1</code> to
avoid time desync between Windows and macOS as explained on <a
href="https://superuser.com/q/494432">SuperUser</a> (this is typically
not required).</p></li>
<li><p>To access Apple filesystems such as HFS+ and APFS, separate
software may need to be installed. Some of the known utilities are: <a
href="https://forums.macrumors.com/threads/apple-hfs-windows-driver-download.1368010/">Apple
HFS+ driver</a> (<a
href="https://forums.macrumors.com/threads/apple-hfs-windows-driver-download.1368010/post-24180079">workaround
for Windows 10</a>), <a
href="http://www.catacombae.org/hfsexplorer">HFSExplorer</a>, MacDrive,
Paragon APFS, Paragon HFS+, TransMac, etc. Remember to never ever
attempt to modify Apple file systems from Windows as this often leads to
irrecoverable data loss.</p></li>
</ul>
<p><strong>Why do I see <code>Basic data partition</code> in the Boot
Camp Startup Disk control panel?</strong></p>
<p>The Boot Camp control panel uses the GPT partition table to obtain
each boot option name. After installing Windows separately, the
partition has to be relabelled manually. This can be done with many
utilities including the open-source <a
href="https://sourceforge.net/projects/gptfdisk">gdisk</a> utility.
Reference example:</p>
<pre id="relabel" data-caption="Relabeling Windows volume"
data-label="relabel" style="ocbash"><code>PS C:\gdisk&gt; .\gdisk64.exe \\.\physicaldrive0
GPT fdisk (gdisk) version 1.0.4

Command (? for help): p
Disk \\.\physicaldrive0: 419430400 sectors, 200.0 GiB
Sector size (logical): 512 bytes
Disk identifier (GUID): DEC57EB1-B3B5-49B2-95F5-3B8C4D3E4E12
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 419430366
Partitions will be aligned on 2048-sector boundaries
Total free space is 4029 sectors (2.0 MiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         1023999   499.0 MiB   2700  Basic data partition
   2         1024000         1226751   99.0 MiB    EF00  EFI system partition
   3         1226752         1259519   16.0 MiB    0C01  Microsoft reserved ...
   4         1259520       419428351   199.4 GiB   0700  Basic data partition

Command (? for help): c
Partition number (1-4): 4
Enter name: BOOTCAMP

Command (? for help): w

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING PARTITIONS!!

Do you want to proceed? (Y/N): Y
OK; writing new GUID partition table (GPT) to \\.\physicaldrive0.
Disk synchronization succeeded! The computer should now use the new partition table.
The operation has completed successfully.</code></pre>
<p><strong>How do I choose Windows BOOTCAMP with custom NTFS
drivers?</strong></p>
<p>Third-party drivers providing NTFS support, such as <a
href="https://www.tuxera.com/community/open-source-ntfs-3g">NTFS-3G</a>,
Paragon NTFS, Tuxera NTFS or <a
href="https://www.seagate.com/support/software/paragon">Seagate Paragon
Driver</a> disrupt certain macOS functionality, including the <a
href="https://support.apple.com/HT202796">Startup Disk</a> preference
pane normally used for operating system selection. While the recommended
option remains not to use such drivers as they commonly corrupt the
filesystem, and prefer the driver bundled with macOS with optional write
support ( <a
href="http://osxdaily.com/2013/10/02/enable-ntfs-write-support-mac-os-x">command</a>
or <a href="https://mounty.app">GUI</a>), there still exist
vendor-specific workarounds for their products: <a
href="https://www.tuxera.com/products/tuxera-ntfs-for-mac/faq">Tuxera</a>,
<a href="https://kb.paragon-software.com/article/6604">Paragon</a>,
etc.</p>
<h2 id="troubleshootingdebug">Debugging</h2>
<p>Similar to other projects working with hardware OpenCore supports
auditing and debugging. The use of <code>NOOPT</code> or
<code>DEBUG</code> build modes instead of <code>RELEASE</code> can
produce a lot more debug output. With <code>NOOPT</code> source level
debugging with GDB or IDA Pro is also available. For GDB check <a
href="https://github.com/acidanthera/OpenCorePkg/tree/master/Debug">OpenCore
Debug</a> page. For IDA Pro, version 7.3 or newer is needed, and <a
href="https://www.hex-rays.com/products/ida/support/tutorials/index.shtml">Debugging
the XNU Kernel with IDA Pro</a> may also help.</p>
<p>To obtain the log during boot serial port debugging can be used.
Serial port debugging is enabled in <code>Target</code>, e.g.
<code>0xB</code> for onscreen with serial. To initialise serial within
OpenCore use <code>Init</code> configuration option under
<code>Misc-&gt;Serial</code> with other values properly set. For macOS
the best choice is CP2102-based UART devices. Connect motherboard
<code>TX</code> to USB UART <code>RX</code>, and motherboard
<code>GND</code> to USB UART <code>GND</code>. Use <code>screen</code>
utility to get the output, or download GUI software, such as <a
href="https://freeware.the-meiers.org">CoolTerm</a>.</p>
<p><em>Note</em>: On several motherboards (and possibly USB UART
dongles) PIN naming may be incorrect. It is very common to have
<code>GND</code> swapped with <code>RX</code>, thus, motherboard
“<code>TX</code>” must be connected to USB UART <code>GND</code>, and
motherboard “<code>GND</code>” to USB UART <code>RX</code>.</p>
<p>Remember to enable <code>COM</code> port in firmware settings, and
never use USB cables longer than 1 meter to avoid output corruption. To
additionally enable XNU kernel serial output <code>debug=0x8</code> boot
argument is needed.</p>
<h2 id="troubleshootingtricks">Tips and Tricks</h2>
<ol>
<li><p><strong>How do I debug boot failures?</strong></p>
<p>Obtaining the actual error message is usually adequate. For this,
ensure that:</p>
<ul>
<li><p>A <code>DEBUG</code> or <code>NOOPT</code> version of OpenCore is
used.</p></li>
<li><p>Logging is enabled (<code>1</code>) and shown onscreen
(<code>2</code>): <code>Misc</code> <span class="math inline">→</span>
<code>Debug</code> <span class="math inline">→</span>
<code>Target</code> <span class="math inline">=</span>
<code>3</code>.</p></li>
<li><p>Logged messages from at least <code>DEBUG_ERROR</code>
(<code>0x80000000</code>), <code>DEBUG_WARN</code>
(<code>0x00000002</code>), and <code>DEBUG_INFO</code>
(<code>0x00000040</code>) levels are visible onscreen: <code>Misc</code>
<span class="math inline">→</span> <code>Debug</code> <span
class="math inline">→</span> <code>DisplayLevel</code> <span
class="math inline">=</span> <code>0x80000042</code>.</p></li>
<li><p>Critical error messages, such as <code>DEBUG_ERROR</code>, stop
booting: <code>Misc</code> <span class="math inline">→</span>
<code>Security</code> <span class="math inline">→</span>
<code>HaltLevel</code> <span class="math inline">=</span>
<code>0x80000000</code>.</p></li>
<li><p>Watch Dog is disabled to prevent automatic reboot:
<code>Misc</code> <span class="math inline">→</span> <code>Debug</code>
<span class="math inline">→</span> <code>DisableWatchDog</code> <span
class="math inline">=</span> <code>true</code>.</p></li>
<li><p>Boot Picker (entry selector) is enabled: <code>Misc</code> <span
class="math inline">→</span> <code>Boot</code> <span
class="math inline">→</span> <code>ShowPicker</code> <span
class="math inline">=</span> <code>true</code>.</p></li>
</ul>
<p>If there is no obvious error, check the available workarounds in the
<code>Quirks</code> sections one by one. For early boot troubleshooting,
for instance, when OpenCore menu does not appear, using
<code>UEFI Shell</code> (bundled with OpenCore) may help to see early
debug messages.</p></li>
<li><p><strong>How do I debug macOS boot failures?</strong></p>
<ul>
<li><p>Refer to <code>boot-args</code> values such as
<code>debug=0x100</code>, <code>keepsyms=1</code>, <code>-v</code>, and
similar.</p></li>
<li><p>Do not forget about <code>AppleDebug</code> and
<code>ApplePanic</code> properties.</p></li>
<li><p>For macOS to correctly recognise and set up serial ports, the
<code>CustomPciSerialDevice</code> quirk may be enabled when a PCI
serial port card is installed.</p></li>
<li><p>Take care of <code>Booter</code>, <code>Kernel</code>, and
<code>UEFI</code> quirks.</p></li>
<li><p>Consider using serial port to inspect early kernel boot failures.
For this <code>debug=0x108</code>, <code>serial=5</code>, and
<code>msgbuf=1048576</code> boot arguments are needed. Refer to the
patches in Sample.plist when dying before serial init.</p></li>
<li><p>Always read the logs carefully.</p></li>
</ul></li>
<li><p><strong>How do I customise boot entries?</strong></p>
<p>OpenCore follows standard Apple Bless model and extracts the entry
name from <code>.contentDetails</code> and
<code>.disk_label.contentDetails</code> files in the booter directory if
present. These files contain an ASCII string with an entry title, which
may then be customised by the user.</p></li>
<li><p><strong>How do I choose the default boot entry?</strong></p>
<p>OpenCore uses the primary UEFI boot option to select the default
entry. This choice can be altered from UEFI Setup, with the macOS <a
href="https://support.apple.com/HT202796">Startup Disk</a> preference,
or the Windows <a
href="https://support.apple.com/guide/bootcamp-control-panel/start-up-your-mac-in-windows-or-macos-bcmp29b8ac66/mac">Boot Camp</a>
Control Panel. Since choosing OpenCore’s <code>BOOTx64.EFI</code> as a
primary boot option limits this functionality in addition to several
types of firmware deleting incompatible boot options, potentially
including those created by macOS, users are strongly encouraged to use
the <code>RequestBootVarRouting</code> quirk, which will preserve the
selection made in the operating system within the OpenCore variable
space. Note, that <code>RequestBootVarRouting</code> requires a separate
driver for functioning.</p></li>
<li><p><span id="reinstallmacos" data-label="reinstallmacos"></span>
<strong>What is the simplest way to install macOS?</strong></p>
<p>Copy online recovery image (<code>*.dmg</code> and
<code>*.chunklist</code> files) to <code>com.apple.recovery.boot</code>
directory on a FAT32 partition with OpenCore. Load the OpenCore picker
and choose the entry, it will have a <code>(dmg)</code> suffix. Custom
name may be created by providing <code>.contentDetails</code> file.</p>
<p>To download recovery online <a
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Utilities/macrecovery/macrecovery.py">macrecovery.py</a>
can be used.</p>
<p>For offline installation refer to <a
href="https://support.apple.com/HT201372">How to create a bootable
installer for macOS</a> article. Apart from App Store and
<code>softwareupdate</code> utility there also are <a
href="https://github.com/corpnewt/gibMacOS">third-party utilities</a> to
download an offline image.</p></li>
<li><p><strong>Why do online recovery images (<code>*.dmg</code>) fail
to load?</strong></p>
<p>This may be caused by missing HFS+ driver, as all presently known
recovery volumes have HFS+ filesystem.</p></li>
<li><p><strong>Can I use this on Apple hardware or virtual
machines?</strong></p>
<p>Yes. Virtual machines and most relatively modern Mac models, as far
back as the <code>MacPro3,1</code>, are fully supported. While specific
detail relevant to Mac hardware is often limited, some ongoing
instructions can be found on <a
href="https://forums.macrumors.com/threads/2207814">MacRumors.com</a>.</p></li>
<li><p><strong>Why must Find&amp;Replace patches be equal in
size?</strong></p>
<p>For machine code (x86 code) it is not possible to do differently
sized replacements due to <a
href="https://en.wikipedia.org/w/index.php?title=Relative_addressing">relative
addressing</a>. For ACPI code this is risky, and is technically
equivalent to ACPI table replacement, thus not implemented. More
detailed explanation can be found on <a
href="https://applelife.ru/posts/819790">AppleLife.ru</a> or in the ACPI
section of this document.</p></li>
<li><p><strong>How can I decide which <code>Booter</code> quirks to
use?</strong></p>
<p>These quirks originate from <code>AptioMemoryFix</code> driver but
provide a wider set of changes specific to modern systems. Note, that
<code>OpenRuntime</code> driver is required for most configurations. To
get a configuration similar to <code>AptioMemoryFix</code> the following
set of quirks should be enabled:</p>
<ul>
<li><p><code>ProvideConsoleGop</code> (UEFI quirk)</p></li>
<li><p><code>AvoidRuntimeDefrag</code></p></li>
<li><p><code>DiscardHibernateMap</code></p></li>
<li><p><code>EnableSafeModeSlide</code></p></li>
<li><p><code>EnableWriteUnprotector</code></p></li>
<li><p><code>ForceExitBootServices</code></p></li>
<li><p><code>ProtectMemoryRegions</code></p></li>
<li><p><code>ProvideCustomSlide</code></p></li>
<li><p><code>RebuildAppleMemoryMap</code></p></li>
<li><p><code>SetupVirtualMap</code></p></li>
</ul>
<p>However, as of today, such set is strongly discouraged as some of
these quirks are not necessary to be enabled or need additional quirks.
For example, <code>DevirtualiseMmio</code> and
<code>ProtectUefiServices</code> are often required, while
<code>DiscardHibernateMap</code> and <code>ForceExitBootServices</code>
are rarely necessary.</p>
<p>Unfortunately for some quirks such as
<code>RebuildAppleMemoryMap</code>, <code>EnableWriteUnprotector</code>,
<code>ProtectMemoryRegions</code>, <code>SetupVirtualMap</code>, and
<code>SyncRuntimePermissions</code> there is no definite approach even
on similar systems, so trying all their combinations may be required for
optimal setup. Refer to individual quirk descriptions in this document
for details.</p></li>
</ol>
</body>
</html>
